!function(e){function t(e){var t;return f?t=999*Math.random():(u||(u=i()),t=u),Math.floor(t%e)}function i(){var e=o(m);return e||(e=999*Math.random(),n(m,e,30)),e}function n(e,t,i){if(i){var n=new Date;n.setTime(n.getTime()+24*i*60*60*1e3);var o="; expires="+n.toGMTString()}else var o="";document.cookie=e+"="+t+o+"; path=/"}function o(e){for(var t=e+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var o=i[n];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}function r(e){if(h.alternative){var t=h.alternative;"string"==typeof t?e.text(t):"function"==typeof t&&t(e)}}function s(e,t,i,n){var o=n.scope||3;window._gaq.push(["_setCustomVar",e,t,i,o])}function a(e,t,i){var n=i["event-label"]||void 0,o=i["event-value"]||void 0,r=["event-noninteraction"]||!0;window._gaq.push(["_trackEvent",e,t,n,o,r])}function l(e){if("undefined"!=typeof window.console&&"string"==typeof e)return window.console.log(e)}function c(e){if("undefined"!=typeof window._gaq){var t="",i=e.slot;t=0!==p?h.value||"alternative"+p:e["default-value"]||"default",f?l(i?d+" : "+t+" (custom var "+i+")":d+" : "+t+" (event)"):i?s(i,d,t,e):a(d,t,e)}}var u,d,h,p,f,g=/#!dev/,m="_easyab_seed";e.fn.easyab=function(i){return i&&"object"==typeof i&&navigator.cookieEnabled?(d=i.name,d&&i.alternatives&&(f=g.test(window.location),p=t(i.alternatives.length+1),0!==p&&(h=i.alternatives[p-1]),c(i)),this.each(function(){var t=e(this);0!==p&&r(t)})):this}}(window.jQuery||window.Zepto),function(){function e(e){function t(t,i,n,o,r,s){for(;r>=0&&r<s;r+=e){var a=o?o[r]:r;n=i(n,t[a],a,t)}return n}return function(i,n,o,r){n=y(n,r,4);var s=!S(i)&&v.keys(i),a=(s||i).length,l=e>0?0:a-1;return arguments.length<3&&(o=i[s?s[l]:l],l+=e),t(i,n,o,s,l,a)}}function t(e){return function(t,i,n){i=w(i,n);for(var o=M(t),r=e>0?0:o-1;r>=0&&r<o;r+=e)if(i(t[r],r,t))return r;return-1}}function i(e,t,i){return function(n,o,r){var s=0,a=M(n);if("number"==typeof r)e>0?s=r>=0?r:Math.max(r+a,s):a=r>=0?Math.min(r+1,a):r+a+1;else if(i&&r&&a)return r=i(n,o),n[r]===o?r:-1;if(o!==o)return r=t(u.call(n,s,a),v.isNaN),r>=0?r+s:-1;for(r=e>0?s:a-1;r>=0&&r<a;r+=e)if(n[r]===o)return r;return-1}}function n(e,t){var i=F.length,n=e.constructor,o=v.isFunction(n)&&n.prototype||a,r="constructor";for(v.has(e,r)&&!v.contains(t,r)&&t.push(r);i--;)r=F[i],r in e&&e[r]!==o[r]&&!v.contains(t,r)&&t.push(r)}var o=this,r=o._,s=Array.prototype,a=Object.prototype,l=Function.prototype,c=s.push,u=s.slice,d=a.toString,h=a.hasOwnProperty,p=Array.isArray,f=Object.keys,g=l.bind,m=Object.create,_=function(){},v=function(e){return e instanceof v?e:this instanceof v?void(this._wrapped=e):new v(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=v),exports._=v):o._=v,v.VERSION="1.8.3";var y=function(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,o){return e.call(t,i,n,o)};case 4:return function(i,n,o,r){return e.call(t,i,n,o,r)}}return function(){return e.apply(t,arguments)}},w=function(e,t,i){return null==e?v.identity:v.isFunction(e)?y(e,t,i):v.isObject(e)?v.matcher(e):v.property(e)};v.iteratee=function(e,t){return w(e,t,1/0)};var b=function(e,t){return function(i){var n=arguments.length;if(n<2||null==i)return i;for(var o=1;o<n;o++)for(var r=arguments[o],s=e(r),a=s.length,l=0;l<a;l++){var c=s[l];t&&void 0!==i[c]||(i[c]=r[c])}return i}},x=function(e){if(!v.isObject(e))return{};if(m)return m(e);_.prototype=e;var t=new _;return _.prototype=null,t},k=function(e){return function(t){return null==t?void 0:t[e]}},C=Math.pow(2,53)-1,M=k("length"),S=function(e){var t=M(e);return"number"==typeof t&&t>=0&&t<=C};v.each=v.forEach=function(e,t,i){t=y(t,i);var n,o;if(S(e))for(n=0,o=e.length;n<o;n++)t(e[n],n,e);else{var r=v.keys(e);for(n=0,o=r.length;n<o;n++)t(e[r[n]],r[n],e)}return e},v.map=v.collect=function(e,t,i){t=w(t,i);for(var n=!S(e)&&v.keys(e),o=(n||e).length,r=Array(o),s=0;s<o;s++){var a=n?n[s]:s;r[s]=t(e[a],a,e)}return r},v.reduce=v.foldl=v.inject=e(1),v.reduceRight=v.foldr=e(-1),v.find=v.detect=function(e,t,i){var n;if(n=S(e)?v.findIndex(e,t,i):v.findKey(e,t,i),void 0!==n&&n!==-1)return e[n]},v.filter=v.select=function(e,t,i){var n=[];return t=w(t,i),v.each(e,function(e,i,o){t(e,i,o)&&n.push(e)}),n},v.reject=function(e,t,i){return v.filter(e,v.negate(w(t)),i)},v.every=v.all=function(e,t,i){t=w(t,i);for(var n=!S(e)&&v.keys(e),o=(n||e).length,r=0;r<o;r++){var s=n?n[r]:r;if(!t(e[s],s,e))return!1}return!0},v.some=v.any=function(e,t,i){t=w(t,i);for(var n=!S(e)&&v.keys(e),o=(n||e).length,r=0;r<o;r++){var s=n?n[r]:r;if(t(e[s],s,e))return!0}return!1},v.contains=v.includes=v.include=function(e,t,i,n){return S(e)||(e=v.values(e)),("number"!=typeof i||n)&&(i=0),v.indexOf(e,t,i)>=0},v.invoke=function(e,t){var i=u.call(arguments,2),n=v.isFunction(t);return v.map(e,function(e){var o=n?t:e[t];return null==o?o:o.apply(e,i)})},v.pluck=function(e,t){return v.map(e,v.property(t))},v.where=function(e,t){return v.filter(e,v.matcher(t))},v.findWhere=function(e,t){return v.find(e,v.matcher(t))},v.max=function(e,t,i){var n,o,r=-(1/0),s=-(1/0);if(null==t&&null!=e){e=S(e)?e:v.values(e);for(var a=0,l=e.length;a<l;a++)n=e[a],n>r&&(r=n)}else t=w(t,i),v.each(e,function(e,i,n){o=t(e,i,n),(o>s||o===-(1/0)&&r===-(1/0))&&(r=e,s=o)});return r},v.min=function(e,t,i){var n,o,r=1/0,s=1/0;if(null==t&&null!=e){e=S(e)?e:v.values(e);for(var a=0,l=e.length;a<l;a++)n=e[a],n<r&&(r=n)}else t=w(t,i),v.each(e,function(e,i,n){o=t(e,i,n),(o<s||o===1/0&&r===1/0)&&(r=e,s=o)});return r},v.shuffle=function(e){for(var t,i=S(e)?e:v.values(e),n=i.length,o=Array(n),r=0;r<n;r++)t=v.random(0,r),t!==r&&(o[r]=o[t]),o[t]=i[r];return o},v.sample=function(e,t,i){return null==t||i?(S(e)||(e=v.values(e)),e[v.random(e.length-1)]):v.shuffle(e).slice(0,Math.max(0,t))},v.sortBy=function(e,t,i){return t=w(t,i),v.pluck(v.map(e,function(e,i,n){return{value:e,index:i,criteria:t(e,i,n)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return e.index-t.index}),"value")};var P=function(e){return function(t,i,n){var o={};return i=w(i,n),v.each(t,function(n,r){var s=i(n,r,t);e(o,n,s)}),o}};v.groupBy=P(function(e,t,i){v.has(e,i)?e[i].push(t):e[i]=[t]}),v.indexBy=P(function(e,t,i){e[i]=t}),v.countBy=P(function(e,t,i){v.has(e,i)?e[i]++:e[i]=1}),v.toArray=function(e){return e?v.isArray(e)?u.call(e):S(e)?v.map(e,v.identity):v.values(e):[]},v.size=function(e){return null==e?0:S(e)?e.length:v.keys(e).length},v.partition=function(e,t,i){t=w(t,i);var n=[],o=[];return v.each(e,function(e,i,r){(t(e,i,r)?n:o).push(e)}),[n,o]},v.first=v.head=v.take=function(e,t,i){if(null!=e)return null==t||i?e[0]:v.initial(e,e.length-t)},v.initial=function(e,t,i){return u.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))},v.last=function(e,t,i){if(null!=e)return null==t||i?e[e.length-1]:v.rest(e,Math.max(0,e.length-t))},v.rest=v.tail=v.drop=function(e,t,i){return u.call(e,null==t||i?1:t)},v.compact=function(e){return v.filter(e,v.identity)};var T=function(e,t,i,n){for(var o=[],r=0,s=n||0,a=M(e);s<a;s++){var l=e[s];if(S(l)&&(v.isArray(l)||v.isArguments(l))){t||(l=T(l,t,i));var c=0,u=l.length;for(o.length+=u;c<u;)o[r++]=l[c++]}else i||(o[r++]=l)}return o};v.flatten=function(e,t){return T(e,t,!1)},v.without=function(e){return v.difference(e,u.call(arguments,1))},v.uniq=v.unique=function(e,t,i,n){v.isBoolean(t)||(n=i,i=t,t=!1),null!=i&&(i=w(i,n));for(var o=[],r=[],s=0,a=M(e);s<a;s++){var l=e[s],c=i?i(l,s,e):l;t?(s&&r===c||o.push(l),r=c):i?v.contains(r,c)||(r.push(c),o.push(l)):v.contains(o,l)||o.push(l)}return o},v.union=function(){return v.uniq(T(arguments,!0,!0))},v.intersection=function(e){for(var t=[],i=arguments.length,n=0,o=M(e);n<o;n++){var r=e[n];if(!v.contains(t,r)){for(var s=1;s<i&&v.contains(arguments[s],r);s++);s===i&&t.push(r)}}return t},v.difference=function(e){var t=T(arguments,!0,!0,1);return v.filter(e,function(e){return!v.contains(t,e)})},v.zip=function(){return v.unzip(arguments)},v.unzip=function(e){for(var t=e&&v.max(e,M).length||0,i=Array(t),n=0;n<t;n++)i[n]=v.pluck(e,n);return i},v.object=function(e,t){for(var i={},n=0,o=M(e);n<o;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},v.findIndex=t(1),v.findLastIndex=t(-1),v.sortedIndex=function(e,t,i,n){i=w(i,n,1);for(var o=i(t),r=0,s=M(e);r<s;){var a=Math.floor((r+s)/2);i(e[a])<o?r=a+1:s=a}return r},v.indexOf=i(1,v.findIndex,v.sortedIndex),v.lastIndexOf=i(-1,v.findLastIndex),v.range=function(e,t,i){null==t&&(t=e||0,e=0),i=i||1;for(var n=Math.max(Math.ceil((t-e)/i),0),o=Array(n),r=0;r<n;r++,e+=i)o[r]=e;return o};var I=function(e,t,i,n,o){if(!(n instanceof t))return e.apply(i,o);var r=x(e.prototype),s=e.apply(r,o);return v.isObject(s)?s:r};v.bind=function(e,t){if(g&&e.bind===g)return g.apply(e,u.call(arguments,1));if(!v.isFunction(e))throw new TypeError("Bind must be called on a function");var i=u.call(arguments,2),n=function(){return I(e,n,t,this,i.concat(u.call(arguments)))};return n},v.partial=function(e){var t=u.call(arguments,1),i=function(){for(var n=0,o=t.length,r=Array(o),s=0;s<o;s++)r[s]=t[s]===v?arguments[n++]:t[s];for(;n<arguments.length;)r.push(arguments[n++]);return I(e,i,this,this,r)};return i},v.bindAll=function(e){var t,i,n=arguments.length;if(n<=1)throw new Error("bindAll must be passed function names");for(t=1;t<n;t++)i=arguments[t],e[i]=v.bind(e[i],e);return e},v.memoize=function(e,t){var i=function(n){var o=i.cache,r=""+(t?t.apply(this,arguments):n);return v.has(o,r)||(o[r]=e.apply(this,arguments)),o[r]};return i.cache={},i},v.delay=function(e,t){var i=u.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},v.defer=v.partial(v.delay,v,1),v.throttle=function(e,t,i){var n,o,r,s=null,a=0;i||(i={});var l=function(){a=i.leading===!1?0:v.now(),s=null,r=e.apply(n,o),s||(n=o=null)};return function(){var c=v.now();a||i.leading!==!1||(a=c);var u=t-(c-a);return n=this,o=arguments,u<=0||u>t?(s&&(clearTimeout(s),s=null),a=c,r=e.apply(n,o),s||(n=o=null)):s||i.trailing===!1||(s=setTimeout(l,u)),r}},v.debounce=function(e,t,i){var n,o,r,s,a,l=function(){var c=v.now()-s;c<t&&c>=0?n=setTimeout(l,t-c):(n=null,i||(a=e.apply(r,o),n||(r=o=null)))};return function(){r=this,o=arguments,s=v.now();var c=i&&!n;return n||(n=setTimeout(l,t)),c&&(a=e.apply(r,o),r=o=null),a}},v.wrap=function(e,t){return v.partial(t,e)},v.negate=function(e){return function(){return!e.apply(this,arguments)}},v.compose=function(){var e=arguments,t=e.length-1;return function(){for(var i=t,n=e[t].apply(this,arguments);i--;)n=e[i].call(this,n);return n}},v.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},v.before=function(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=null),i}},v.once=v.partial(v.before,2);var O=!{toString:null}.propertyIsEnumerable("toString"),F=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];v.keys=function(e){if(!v.isObject(e))return[];if(f)return f(e);var t=[];for(var i in e)v.has(e,i)&&t.push(i);return O&&n(e,t),t},v.allKeys=function(e){if(!v.isObject(e))return[];var t=[];for(var i in e)t.push(i);return O&&n(e,t),t},v.values=function(e){for(var t=v.keys(e),i=t.length,n=Array(i),o=0;o<i;o++)n[o]=e[t[o]];return n},v.mapObject=function(e,t,i){t=w(t,i);for(var n,o=v.keys(e),r=o.length,s={},a=0;a<r;a++)n=o[a],s[n]=t(e[n],n,e);return s},v.pairs=function(e){for(var t=v.keys(e),i=t.length,n=Array(i),o=0;o<i;o++)n[o]=[t[o],e[t[o]]];return n},v.invert=function(e){for(var t={},i=v.keys(e),n=0,o=i.length;n<o;n++)t[e[i[n]]]=i[n];return t},v.functions=v.methods=function(e){var t=[];for(var i in e)v.isFunction(e[i])&&t.push(i);return t.sort()},v.extend=b(v.allKeys),v.extendOwn=v.assign=b(v.keys),v.findKey=function(e,t,i){t=w(t,i);for(var n,o=v.keys(e),r=0,s=o.length;r<s;r++)if(n=o[r],t(e[n],n,e))return n},v.pick=function(e,t,i){var n,o,r={},s=e;if(null==s)return r;v.isFunction(t)?(o=v.allKeys(s),n=y(t,i)):(o=T(arguments,!1,!1,1),n=function(e,t,i){return t in i},s=Object(s));for(var a=0,l=o.length;a<l;a++){var c=o[a],u=s[c];n(u,c,s)&&(r[c]=u)}return r},v.omit=function(e,t,i){if(v.isFunction(t))t=v.negate(t);else{var n=v.map(T(arguments,!1,!1,1),String);t=function(e,t){return!v.contains(n,t)}}return v.pick(e,t,i)},v.defaults=b(v.allKeys,!0),v.create=function(e,t){var i=x(e);return t&&v.extendOwn(i,t),i},v.clone=function(e){return v.isObject(e)?v.isArray(e)?e.slice():v.extend({},e):e},v.tap=function(e,t){return t(e),e},v.isMatch=function(e,t){var i=v.keys(t),n=i.length;if(null==e)return!n;for(var o=Object(e),r=0;r<n;r++){var s=i[r];if(t[s]!==o[s]||!(s in o))return!1}return!0};var E=function(e,t,i,n){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof v&&(e=e._wrapped),t instanceof v&&(t=t._wrapped);var o=d.call(e);if(o!==d.call(t))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var r="[object Array]"===o;if(!r){if("object"!=typeof e||"object"!=typeof t)return!1;var s=e.constructor,a=t.constructor;if(s!==a&&!(v.isFunction(s)&&s instanceof s&&v.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}i=i||[],n=n||[];for(var l=i.length;l--;)if(i[l]===e)return n[l]===t;if(i.push(e),n.push(t),r){if(l=e.length,l!==t.length)return!1;for(;l--;)if(!E(e[l],t[l],i,n))return!1}else{var c,u=v.keys(e);if(l=u.length,v.keys(t).length!==l)return!1;for(;l--;)if(c=u[l],!v.has(t,c)||!E(e[c],t[c],i,n))return!1}return i.pop(),n.pop(),!0};v.isEqual=function(e,t){return E(e,t)},v.isEmpty=function(e){return null==e||(S(e)&&(v.isArray(e)||v.isString(e)||v.isArguments(e))?0===e.length:0===v.keys(e).length)},v.isElement=function(e){return!(!e||1!==e.nodeType)},v.isArray=p||function(e){return"[object Array]"===d.call(e)},v.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},v.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){v["is"+e]=function(t){return d.call(t)==="[object "+e+"]"}}),v.isArguments(arguments)||(v.isArguments=function(e){return v.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(v.isFunction=function(e){return"function"==typeof e||!1}),v.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},v.isNaN=function(e){return v.isNumber(e)&&e!==+e},v.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===d.call(e)},v.isNull=function(e){return null===e},v.isUndefined=function(e){return void 0===e},v.has=function(e,t){return null!=e&&h.call(e,t)},v.noConflict=function(){return o._=r,this},v.identity=function(e){return e},v.constant=function(e){return function(){return e}},v.noop=function(){},v.property=k,v.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},v.matcher=v.matches=function(e){return e=v.extendOwn({},e),function(t){return v.isMatch(t,e)}},v.times=function(e,t,i){var n=Array(Math.max(0,e));t=y(t,i,1);for(var o=0;o<e;o++)n[o]=t(o);return n},v.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},v.now=Date.now||function(){return(new Date).getTime()};var A={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},V=v.invert(A),R=function(e){var t=function(t){return e[t]},i="(?:"+v.keys(e).join("|")+")",n=RegExp(i),o=RegExp(i,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(o,t):e}};v.escape=R(A),v.unescape=R(V),v.result=function(e,t,i){var n=null==e?void 0:e[t];return void 0===n&&(n=i),v.isFunction(n)?n.call(e):n};var D=0;v.uniqueId=function(e){var t=++D+"";return e?e+t:t},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\u2028|\u2029/g,U=function(e){return"\\"+z[e]};v.template=function(e,t,i){!t&&i&&(t=i),t=v.defaults({},t,v.templateSettings);var n=RegExp([(t.escape||L).source,(t.interpolate||L).source,(t.evaluate||L).source].join("|")+"|$","g"),o=0,r="__p+='";e.replace(n,function(t,i,n,s,a){return r+=e.slice(o,a).replace(B,U),o=a+t.length,i?r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?r+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),t}),r+="';\n",t.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(t.variable||"obj","_",r)}catch(e){throw e.source=r,e}var a=function(e){return s.call(this,e,v)},l=t.variable||"obj";return a.source="function("+l+"){\n"+r+"}",a},v.chain=function(e){var t=v(e);return t._chain=!0,t};var N=function(e,t){return e._chain?v(t).chain():t};v.mixin=function(e){v.each(v.functions(e),function(t){var i=v[t]=e[t];v.prototype[t]=function(){var e=[this._wrapped];return c.apply(e,arguments),N(this,i.apply(v,e))}})},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=s[e];v.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!==e&&"splice"!==e||0!==i.length||delete i[0],N(this,i)}}),v.each(["concat","join","slice"],function(e){var t=s[e];v.prototype[e]=function(){return N(this,t.apply(this._wrapped,arguments))}}),v.prototype.value=function(){return this._wrapped},v.prototype.valueOf=v.prototype.toJSON=v.prototype.value,v.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return v})}.call(this),function(e){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(i,n,o){t.Backbone=e(t,o,i,n)});else if("undefined"!=typeof exports){var i,n=require("underscore");try{i=require("jquery")}catch(e){}e(t,exports,n,i)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(function(e,t,i,n){var o=e.Backbone,r=Array.prototype.slice;t.VERSION="1.3.3",t.$=n,t.noConflict=function(){return e.Backbone=o,this},t.emulateHTTP=!1,t.emulateJSON=!1;var s=function(e,t,n){switch(e){case 1:return function(){return i[t](this[n])};case 2:return function(e){return i[t](this[n],e)};case 3:return function(e,o){return i[t](this[n],l(e,this),o)};case 4:return function(e,o,r){return i[t](this[n],l(e,this),o,r)};default:return function(){var e=r.call(arguments);return e.unshift(this[n]),i[t].apply(i,e)}}},a=function(e,t,n){i.each(t,function(t,o){i[o]&&(e.prototype[o]=s(t,o,n))})},l=function(e,t){return i.isFunction(e)?e:i.isObject(e)&&!t._isModel(e)?c(e):i.isString(e)?function(t){return t.get(e)}:e},c=function(e){var t=i.matches(e);return function(e){return t(e.attributes)}},u=t.Events={},d=/\s+/,h=function(e,t,n,o,r){var s,a=0;if(n&&"object"==typeof n){void 0!==o&&"context"in r&&void 0===r.context&&(r.context=o);for(s=i.keys(n);a<s.length;a++)t=h(e,t,s[a],n[s[a]],r)}else if(n&&d.test(n))for(s=n.split(d);a<s.length;a++)t=e(t,s[a],o,r);else t=e(t,n,o,r);return t};u.on=function(e,t,i){return p(this,e,t,i)};var p=function(e,t,i,n,o){if(e._events=h(f,e._events||{},t,i,{context:n,ctx:e,listening:o}),o){var r=e._listeners||(e._listeners={});r[o.id]=o}return e};u.listenTo=function(e,t,n){if(!e)return this;var o=e._listenId||(e._listenId=i.uniqueId("l")),r=this._listeningTo||(this._listeningTo={}),s=r[o];if(!s){var a=this._listenId||(this._listenId=i.uniqueId("l"));s=r[o]={obj:e,objId:o,id:a,listeningTo:r,count:0}}return p(e,t,n,this,s),this};var f=function(e,t,i,n){if(i){var o=e[t]||(e[t]=[]),r=n.context,s=n.ctx,a=n.listening;a&&a.count++,o.push({callback:i,context:r,ctx:r||s,listening:a})}return e};u.off=function(e,t,i){return this._events?(this._events=h(g,this._events,e,t,{context:i,listeners:this._listeners}),this):this},u.stopListening=function(e,t,n){var o=this._listeningTo;if(!o)return this;for(var r=e?[e._listenId]:i.keys(o),s=0;s<r.length;s++){var a=o[r[s]];if(!a)break;a.obj.off(t,n,this)}return this};var g=function(e,t,n,o){if(e){var r,s=0,a=o.context,l=o.listeners;if(t||n||a){for(var c=t?[t]:i.keys(e);s<c.length;s++){t=c[s];var u=e[t];if(!u)break;for(var d=[],h=0;h<u.length;h++){var p=u[h];n&&n!==p.callback&&n!==p.callback._callback||a&&a!==p.context?d.push(p):(r=p.listening,r&&0===--r.count&&(delete l[r.id],delete r.listeningTo[r.objId]))}d.length?e[t]=d:delete e[t]}return e}for(var f=i.keys(l);s<f.length;s++)r=l[f[s]],delete l[r.id],delete r.listeningTo[r.objId]}};u.once=function(e,t,n){var o=h(m,{},e,t,i.bind(this.off,this));return"string"==typeof e&&null==n&&(t=void 0),this.on(o,t,n)},u.listenToOnce=function(e,t,n){var o=h(m,{},t,n,i.bind(this.stopListening,this,e));return this.listenTo(e,o)};var m=function(e,t,n,o){if(n){var r=e[t]=i.once(function(){o(t,r),n.apply(this,arguments)});r._callback=n}return e};u.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),i=Array(t),n=0;n<t;n++)i[n]=arguments[n+1];return h(_,this._events,e,void 0,i),this};var _=function(e,t,i,n){if(e){var o=e[t],r=e.all;o&&r&&(r=r.slice()),o&&v(o,n),r&&v(r,[t].concat(n))}return e},v=function(e,t){var i,n=-1,o=e.length,r=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++n<o;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=e[n]).callback.call(i.ctx,r);return;case 2:for(;++n<o;)(i=e[n]).callback.call(i.ctx,r,s);return;case 3:for(;++n<o;)(i=e[n]).callback.call(i.ctx,r,s,a);return;default:for(;++n<o;)(i=e[n]).callback.apply(i.ctx,t);return}};u.bind=u.on,u.unbind=u.off,i.extend(t,u);var y=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{});var o=i.result(this,"defaults");n=i.defaults(i.extend({},o,n),o),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(y.prototype,u,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!i.iteratee(e,this)(this.attributes)},set:function(e,t,n){if(null==e)return this;var o;if("object"==typeof e?(o=e,n=t):(o={})[e]=t,n||(n={}),!this._validate(o,n))return!1;var r=n.unset,s=n.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={});var c=this.attributes,u=this.changed,d=this._previousAttributes;for(var h in o)t=o[h],i.isEqual(c[h],t)||a.push(h),i.isEqual(d[h],t)?delete u[h]:u[h]=t,r?delete c[h]:c[h]=t;if(this.idAttribute in o&&(this.id=this.get(this.idAttribute)),!s){a.length&&(this._pending=n);for(var p=0;p<a.length;p++)this.trigger("change:"+a[p],this,c[a[p]],n)}if(l)return this;if(!s)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&i.clone(this.changed);var t=this._changing?this._previousAttributes:this.attributes,n={};for(var o in e){var r=e[o];i.isEqual(t[o],r)||(n[o]=r)}return!!i.size(n)&&n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=i.extend({parse:!0},e);var t=this,n=e.success;return e.success=function(i){var o=e.parse?t.parse(i,e):i;return!!t.set(o,e)&&(n&&n.call(e.context,t,i,e),void t.trigger("sync",t,i,e))},N(this,e),this.sync("read",this,e)},save:function(e,t,n){var o;null==e||"object"==typeof e?(o=e,n=t):(o={})[e]=t,n=i.extend({validate:!0,parse:!0},n);var r=n.wait;if(o&&!r){if(!this.set(o,n))return!1}else if(!this._validate(o,n))return!1;var s=this,a=n.success,l=this.attributes;n.success=function(e){s.attributes=l;var t=n.parse?s.parse(e,n):e;return r&&(t=i.extend({},o,t)),!(t&&!s.set(t,n))&&(a&&a.call(n.context,s,e,n),void s.trigger("sync",s,e,n))},N(this,n),o&&r&&(this.attributes=i.extend({},l,o));var c=this.isNew()?"create":n.patch?"patch":"update";"patch"!==c||n.attrs||(n.attrs=o);var u=this.sync(c,this,n);return this.attributes=l,u},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,o=e.wait,r=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(i){o&&r(),n&&n.call(e.context,t,i,e),t.isNew()||t.trigger("sync",t,i,e)};var s=!1;return this.isNew()?i.defer(e.success):(N(this,e),s=this.sync("delete",this,e)),o||r(),s},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||U();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1)}});var w={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};a(y,w,"attributes");var b=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},x={add:!0,remove:!0,merge:!0},k={add:!0,remove:!1},C=function(e,t,i){i=Math.min(Math.max(i,0),e.length);var n,o=Array(e.length-i),r=t.length;for(n=0;n<o.length;n++)o[n]=e[n+i];for(n=0;n<r;n++)e[n+i]=t[n];for(n=0;n<o.length;n++)e[n+r+i]=o[n]};i.extend(b.prototype,u,{model:y,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,k))},remove:function(e,t){t=i.extend({},t);var n=!i.isArray(e);e=n?[e]:e.slice();var o=this._removeModels(e,t);return!t.silent&&o.length&&(t.changes={added:[],merged:[],removed:o},this.trigger("update",this,t)),n?o[0]:o},set:function(e,t){if(null!=e){t=i.extend({},x,t),t.parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);var n=!i.isArray(e);e=n?[e]:e.slice();var o=t.at;null!=o&&(o=+o),o>this.length&&(o=this.length),o<0&&(o+=this.length+1);var r,s,a=[],l=[],c=[],u=[],d={},h=t.add,p=t.merge,f=t.remove,g=!1,m=this.comparator&&null==o&&t.sort!==!1,_=i.isString(this.comparator)?this.comparator:null;for(s=0;s<e.length;s++){r=e[s];var v=this.get(r);if(v){if(p&&r!==v){var y=this._isModel(r)?r.attributes:r;t.parse&&(y=v.parse(y,t)),v.set(y,t),c.push(v),m&&!g&&(g=v.hasChanged(_))}d[v.cid]||(d[v.cid]=!0,a.push(v)),e[s]=v}else h&&(r=e[s]=this._prepareModel(r,t),r&&(l.push(r),this._addReference(r,t),d[r.cid]=!0,a.push(r)))}if(f){for(s=0;s<this.length;s++)r=this.models[s],d[r.cid]||u.push(r);u.length&&this._removeModels(u,t)}var w=!1,b=!m&&h&&f;if(a.length&&b?(w=this.length!==a.length||i.some(this.models,function(e,t){return e!==a[t]}),this.models.length=0,C(this.models,a,0),this.length=this.models.length):l.length&&(m&&(g=!0),C(this.models,l,null==o?this.length:o),this.length=this.models.length),g&&this.sort({silent:!0}),!t.silent){for(s=0;s<l.length;s++)null!=o&&(t.index=o+s),r=l[s],r.trigger("add",r,this,t);(g||w)&&this.trigger("sort",this,t),(l.length||u.length||c.length)&&(t.changes={added:l,removed:u,merged:c},this.trigger("update",this,t))}return n?e[0]:e}},reset:function(e,t){t=t?i.clone(t):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return r.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[this.modelId(e.attributes||e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var n=t.length;return i.isFunction(t)&&(t=i.bind(t,this)),1===n||i.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){e=i.extend({parse:!0},e);var t=e.success,n=this;return e.success=function(i){var o=e.reset?"reset":"set";n[o](i,e),t&&t.call(e.context,n,i,e),n.trigger("sync",n,i,e)},N(this,e),this.sync("read",this,e)},create:function(e,t){t=t?i.clone(t):{};var n=t.wait;if(e=this._prepareModel(e,t),!e)return!1;n||this.add(e,t);var o=this,r=t.success;return t.success=function(e,t,i){n&&o.add(e,i),r&&r.call(i.context,e,t,i)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?i.clone(t):{},t.collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_removeModels:function(e,t){for(var i=[],n=0;n<e.length;n++){var o=this.get(e[n]);if(o){var r=this.indexOf(o);this.models.splice(r,1),this.length--,delete this._byId[o.cid];var s=this.modelId(o.attributes);null!=s&&delete this._byId[s],t.silent||(t.index=r,o.trigger("remove",o,this,t)),i.push(o),this._removeReference(o,t)}}return i},_isModel:function(e){return e instanceof y},_addReference:function(e){this._byId[e.cid]=e;var t=this.modelId(e.attributes);null!=t&&(this._byId[t]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e){delete this._byId[e.cid];var t=this.modelId(e.attributes);null!=t&&delete this._byId[t],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){if(t){if(("add"===e||"remove"===e)&&i!==this)return;if("destroy"===e&&this.remove(t,n),"change"===e){var o=this.modelId(t.previousAttributes()),r=this.modelId(t.attributes);o!==r&&(null!=o&&delete this._byId[o],null!=r&&(this._byId[r]=t))}}this.trigger.apply(this,arguments)}});var M={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3};a(b,M,"models");var S=t.View=function(e){this.cid=i.uniqueId("view"),i.extend(this,i.pick(e,T)),this._ensureElement(),this.initialize.apply(this,arguments)},P=/^(\S+)\s*(.*)$/,T=["model","collection","el","id","attributes","className","tagName","events"];i.extend(S.prototype,u,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=i.result(this,"events")),!e)return this;this.undelegateEvents();for(var t in e){var n=e[t];if(i.isFunction(n)||(n=this[n]),n){var o=t.match(P);this.delegate(o[1],o[2],i.bind(n,this))}}return this},delegate:function(e,t,i){return this.$el.on(e+".delegateEvents"+this.cid,t,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),
this},undelegate:function(e,t,i){return this.$el.off(e+".delegateEvents"+this.cid,t,i),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,n,o){var r=I[e];i.defaults(o||(o={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:r,dataType:"json"};if(o.url||(s.url=i.result(n,"url")||U()),null!=o.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(o.attrs||n.toJSON(o))),o.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),o.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",o.emulateJSON&&(s.data._method=r);var a=o.beforeSend;o.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",r),a)return a.apply(this,arguments)}}"GET"===s.type||o.emulateJSON||(s.processData=!1);var l=o.error;o.error=function(e,t,i){o.textStatus=t,o.errorThrown=i,l&&l.call(o.context,e,t,i)};var c=o.xhr=t.ajax(i.extend(s,o));return n.trigger("request",n,c,o),c};var I={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var O=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},F=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,A=/\*\w+/g,V=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(O.prototype,u,{initialize:function(){},route:function(e,n,o){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(o=n,n=""),o||(o=this[n]);var r=this;return t.history.route(e,function(i){var s=r._extractParameters(e,i);r.execute(o,s,n)!==!1&&(r.trigger.apply(r,["route:"+n].concat(s)),r.trigger("route",n,s),t.history.trigger("route",r,n,s))}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(V,"\\$&").replace(F,"(?:$1)?").replace(E,function(e,t){return t?e:"([^/?]+)"}).replace(A,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return i.map(n,function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}});var R=t.History=function(){this.handlers=[],this.checkUrl=i.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},D=/^[#\/]|\s+$/g,L=/^\/+|\/+$/g,z=/#.*$/;R.started=!1,i.extend(R.prototype,u,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(D,"")},start:function(e){if(R.started)throw new Error("Backbone.history has already been started");if(R.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(L,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,o=n.insertBefore(this.iframe,n.firstChild).contentWindow;o.document.open(),o.document.close(),o.location.hash="#"+this.fragment}var r=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};if(this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),R.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e!==this.fragment&&(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),i.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(e,t){if(!R.started)return!1;t&&t!==!0||(t={trigger:!!t}),e=this.getFragment(e||"");var i=this.root;""!==e&&"?"!==e.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+e;if(e=this.decodeFragment(e.replace(z,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var o=this.iframe.contentWindow;t.replace||(o.document.open(),o.document.close()),this._updateHash(o.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new R;var B=function(e,t){var n,o=this;return n=e&&i.has(e,"constructor")?e.constructor:function(){return o.apply(this,arguments)},i.extend(n,o,t),n.prototype=i.create(o.prototype,e),n.prototype.constructor=n,n.__super__=o.prototype,n};y.extend=b.extend=O.extend=S.extend=R.extend=B;var U=function(){throw new Error('A "url" property or function must be specified')},N=function(e,t){var i=t.error;t.error=function(n){i&&i.call(t.context,e,n,t),e.trigger("error",e,n,t)}};return t}),function(){var e,t,i,n,o,r,s=[].slice;i=function(e){var t,n;return!_.isObject(e)||_.isFunction(e)?e:e instanceof Backbone.Collection||e instanceof Backbone.Model?e:_.isDate(e)?new Date(e.getTime()):_.isRegExp(e)?new RegExp(e.source,e.toString().replace(/.*\//,"")):(n=_.isArray(e||_.isArguments(e)),t=function(e,t,o){return n?e.push(i(t)):e[o]=i(t),e},_.reduce(e,t,n?[]:{}))},r=function(e){return null!=e&&((e.prototype==={}.prototype||e.prototype===Object.prototype)&&_.isObject(e)&&!_.isArray(e)&&!_.isFunction(e)&&!_.isDate(e)&&!_.isRegExp(e)&&!_.isArguments(e))},t=function(e){return _.filter(_.keys(e),function(t){return r(e[t])})},e=function(e){return _.filter(_.keys(e),function(t){return _.isArray(e[t])})},o=function(i,n,r){var s,a,l,c,u,d,h,p,f,g;if(null==r&&(r=20),r<=0)return console.warn("_.deepExtend(): Maximum depth of recursion hit."),_.extend(i,n);for(d=_.intersection(t(i),t(n)),a=function(e){return n[e]=o(i[e],n[e],r-1)},h=0,f=d.length;h<f;h++)u=d[h],a(u);for(c=_.intersection(e(i),e(n)),s=function(e){return n[e]=_.union(i[e],n[e])},p=0,g=c.length;p<g;p++)l=c[p],s(l);return _.extend(i,n)},n=function(){var e,t,n,r;if(n=2<=arguments.length?s.call(arguments,0,r=arguments.length-1):(r=0,[]),t=arguments[r++],_.isNumber(t)||(n.push(t),t=20),n.length<=1)return n[0];if(t<=0)return _.extend.apply(this,n);for(e=n.shift();n.length>0;)e=o(e,i(n.shift()),t);return e},_.mixin({deepClone:i,isBasicObject:r,basicObjects:t,arrays:e,deepExtend:n})}.call(this),function(e){"function"==typeof define&&define.amd?define(["underscore","backbone"],e):e(_,Backbone)}(function(e,t){function i(t){var n={},o=s.keyPathSeparator;for(var r in t){var a=t[r];if(a&&a.constructor===Object&&!e.isEmpty(a)){var l=i(a);for(var c in l){var u=l[c];n[r+o+c]=u}}else n[r]=a}return n}function n(t,i,n){for(var o=s.keyPathSeparator,r=i.split(o),a=t,l=0,c=r.length;l<c;l++){if(n&&!e.has(a,r[l]))return!1;if(a=a[r[l]],null==a&&l<c-1&&(a={}),"undefined"==typeof a)return!!n||a}return!!n||a}function o(t,i,n,o){o=o||{};for(var r=s.keyPathSeparator,a=i.split(r),l=t,c=0,u=a.length;c<u&&void 0!==l;c++){var d=a[c];c===u-1?o.unset?delete l[d]:l[d]=n:("undefined"!=typeof l[d]&&e.isObject(l[d])||(l[d]={}),l=l[d])}}function r(e,t){o(e,t,null,{unset:!0})}var s=t.Model.extend({constructor:function(t,i){var n,o=t||{};this.cid=e.uniqueId("c"),this.attributes={},i&&i.collection&&(this.collection=i.collection),i&&i.parse&&(o=this.parse(o,i)||{}),(n=e.result(this,"defaults"))&&(o=e.deepExtend({},n,o)),this.set(o,i),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(){return e.deepClone(this.attributes)},get:function(e){return n(this.attributes,e)},set:function(t,a,l){var c,u,d,h,p,f,g,m;if(null==t)return this;if("object"==typeof t?(u=t,l=a||{}):(u={})[t]=a,l||(l={}),!this._validate(u,l))return!1;d=l.unset,p=l.silent,h=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=e.deepClone(this.attributes),this.changed={}),m=this.attributes,g=this._previousAttributes,this.idAttribute in u&&(this.id=u[this.idAttribute]),u=i(u);for(c in u)a=u[c],e.isEqual(n(m,c),a)||h.push(c),e.isEqual(n(g,c),a)?r(this.changed,c):o(this.changed,c,a),d?r(m,c):o(m,c,a);if(!p){h.length&&(this._pending=!0);for(var _=s.keyPathSeparator,v=0,y=h.length;v<y;v++){var t=h[v];this.trigger("change:"+t,this,n(m,t),l);for(var w=t.split(_),b=w.length-1;b>0;b--){var x=e.first(w,b).join(_),k=x+_+"*";this.trigger("change:"+k,this,n(m,x),l)}}}if(f)return this;if(!p)for(;this._pending;)this._pending=!1,this.trigger("change",this,l);return this._pending=!1,this._changing=!1,this},clear:function(t){var n={},o=i(this.attributes);for(var r in o)n[r]=void 0;return this.set(n,e.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!e.isEmpty(this.changed):void 0!==n(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&i(this.changed);var n=this._changing?this._previousAttributes:this.attributes;t=i(t),n=i(n);var o,r=!1;for(var s in t)e.isEqual(n[s],o=t[s])||((r||(r={}))[s]=o);return r},previous:function(e){return null!=e&&this._previousAttributes?n(this._previousAttributes,e):null},previousAttributes:function(){return e.deepClone(this._previousAttributes)}});return s.keyPathSeparator=".",t.DeepModel=s,"undefined"!=typeof module&&(module.exports=s),t}),function(e){var t;if("function"==typeof define&&define.amd)define(["jquery"],e);else if("object"==typeof exports){try{t=require("jquery")}catch(e){}module.exports=e(t)}else window.Cookies=e(window.jQuery)}(function(e){function t(e){return c.raw?e:encodeURIComponent(e)}function i(e){return c.raw?e:decodeURIComponent(e)}function n(e){return t(c.json?JSON.stringify(e):String(e))}function o(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(l," ")),c.json?JSON.parse(e):e}catch(e){}}function r(e,t){var i=c.raw?e:o(e);return a(t)?t(i):i}function s(){for(var e,t,i=0,n={};i<arguments.length;i++){t=arguments[i];for(e in t)n[e]=t[e]}return n}function a(e){return"[object Function]"===Object.prototype.toString.call(e)}var l=/\+/g,c=function(e,o,l){if(arguments.length>1&&!a(o)){if(l=s(c.defaults,l),"number"==typeof l.expires){var u=l.expires,d=l.expires=new Date;d.setMilliseconds(d.getMilliseconds()+864e5*u)}return document.cookie=[t(e),"=",n(o),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}for(var h=e?void 0:{},p=document.cookie?document.cookie.split("; "):[],f=0,g=p.length;f<g;f++){var m=p[f].split("="),_=i(m.shift()),v=m.join("=");if(e===_){h=r(v,o);break}e||void 0===(v=r(v))||(h[_]=v)}return h};return c.get=c.set=c,c.defaults={},c.remove=function(e,t){return c(e,"",s(t,{expires:-1})),!c(e)},e&&(e.cookie=c,e.removeCookie=c.remove),c}),Backbone.Paginator=function(e,t,i){"use strict";var n=t.map(e.VERSION.split("."),function(e){return parseInt(e,10)}),o={};o.version="0.8.1",o.clientPager=e.Collection.extend({useDiacriticsPlugin:!0,useLevenshteinPlugin:!0,sortColumn:"",sortDirection:"desc",lastSortColumn:"",fieldFilterRules:[],lastFieldFilterRules:[],filterFields:"",filterExpression:"",lastFilterExpression:"",defaults_ui:{firstPage:0,currentPage:1,perPage:5,totalPages:10,pagesInRange:4},initialize:function(){this.on("add",this.addModel,this),this.on("remove",this.removeModel,this),this.setDefaults()},setDefaults:function(){var e=t.defaults(this.paginator_ui,this.defaults_ui);t.defaults(this,e)},addModel:function(e){this.origModels.push(e)},removeModel:function(e){var i=t.indexOf(this.origModels,e);this.origModels.splice(i,1)},sync:function(o,r,s){var a=this;this.setDefaults();var l={};t.each(t.result(a,"server_api"),function(e,i){t.isFunction(e)&&(e=t.bind(e,a),e=e()),l[i]=e});var c=t.clone(a.paginator_core);t.each(c,function(e,i){t.isFunction(e)&&(e=t.bind(e,a),e=e()),c[i]=e}),c=t.defaults(c,{timeout:25e3,cache:!1,type:"GET",dataType:"jsonp"}),c=t.extend(c,{data:decodeURIComponent(i.param(l)),processData:!1,url:t.result(c,"url")},s);var u=!(0===n[0]&&9===n[1]&&10===n[2]),d=c.success;c.success=function(e,t,i){d&&(u?d(e,t,i):d(r,e,c)),r&&r.trigger&&r.trigger("sync",r,e,c)};var h=c.error;c.error=function(e){h&&h(r,e,c),r&&r.trigger&&r.trigger("error",r,e,c)};var p=c.xhr=e.ajax(c);return r&&r.trigger&&r.trigger("request",r,p,c),p},nextPage:function(e){this.currentPage<this.information.totalPages&&(this.currentPage=++this.currentPage,this.pager(e))},previousPage:function(e){this.currentPage>1&&(this.currentPage=--this.currentPage,this.pager(e))},goTo:function(e,t){void 0!==e&&(this.currentPage=parseInt(e,10),this.pager(t))},howManyPer:function(e){if(void 0!==e){var t=this.perPage;this.perPage=parseInt(e,10),this.currentPage=Math.ceil((t*(this.currentPage-1)+1)/e),this.pager()}},setSort:function(e,t){void 0!==e&&void 0!==t&&(this.lastSortColumn=this.sortColumn,this.sortColumn=e,this.sortDirection=t,this.pager(),this.info())},setFieldFilter:function(e){t.isEmpty(e)?(this.lastFieldFilterRules=this.fieldFilterRules,this.fieldFilterRules="",this.pager(),this.info()):(this.lastFieldFilterRules=this.fieldFilterRules,this.fieldFilterRules=e,this.pager(),this.info())},doFakeFieldFilter:function(e){if(!t.isEmpty(e)){var i=this.origModels;return void 0===i&&(i=this.models),i=this._fieldFilter(i,e),""!==this.filterExpression&&(i=this._filter(i,this.filterFields,this.filterExpression)),i.length}},setFilter:function(e,t){void 0!==e&&void 0!==t&&(this.filterFields=e,this.lastFilterExpression=this.filterExpression,this.filterExpression=t,this.pager(),this.info())},doFakeFilter:function(e,i){if(void 0!==e&&void 0!==i){var n=this.origModels;return void 0===n&&(n=this.models),t.isEmpty(this.fieldFilterRules)||(n=this._fieldFilter(n,this.fieldFilterRules)),n=this._filter(n,e,i),n.length}},pager:function(e){var i=this,n=this.perPage,o=(i.currentPage-1)*n,r=o+n;void 0===i.origModels&&(i.origModels=i.models),i.models=i.origModels.slice(),""!==this.sortColumn&&(i.models=i._sort(i.models,this.sortColumn,this.sortDirection)),t.isEmpty(this.fieldFilterRules)||(i.models=i._fieldFilter(i.models,this.fieldFilterRules)),""!==this.filterExpression&&(i.models=i._filter(i.models,this.filterFields,this.filterExpression)),this.lastSortColumn===this.sortColumn&&this.lastFilterExpression===this.filterExpression&&t.isEqual(this.fieldFilterRules,this.lastFieldFilterRules)||(o=0,r=o+n,i.currentPage=1,this.lastSortColumn=this.sortColumn,this.lastFieldFilterRules=this.fieldFilterRules,this.lastFilterExpression=this.filterExpression),i.sortedAndFilteredModels=i.models.slice(),i.info(),i.reset(i.models.slice(o,r)),t.result(e,"success")},_sort:function(e,i,n){return e=e.sort(function(e,o){var r=e.get(i),s=o.get(i);if(t.isUndefined(r)||t.isUndefined(s)||null===r||null===s)return 0;if(r=r.toString().toLowerCase(),s=s.toString().toLowerCase(),"desc"===n)if(!r.match(/[^\-\d\.]/)&&r.match(/-?[\d\.]+/)&&!s.match(/[^\-\d\.]/)&&s.match(/-?[\d\.]+/)){if(r-0<s-0)return 1;if(r-0>s-0)return-1}else{if(r<s)return 1;if(r>s)return-1}else if(!r.match(/[^\-\d\.]/)&&r.match(/-?[\d\.]+/)&&!s.match(/[^\-\d\.]/)&&s.match(/-?[\d\.]+/)){if(r-0<s-0)return-1;if(r-0>s-0)return 1}else{if(r<s)return-1;if(r>s)return 1}if(e.cid&&o.cid){var a=e.cid,l=o.cid;if(a<l)return-1;if(a>l)return 1}return 0})},_fieldFilter:function(e,i){if(t.isEmpty(i))return e;var n=[];return t.each(e,function(e){var o=!0;t.each(i,function(i){if(!o)return!1;if(o=!1,"function"===i.type){var n=t.wrap(i.value,function(t){return t(e.get(i.field))});n()&&(o=!0)}else"required"===i.type?t.isEmpty(e.get(i.field).toString())||(o=!0):"min"===i.type?!t.isNaN(Number(e.get(i.field)))&&!t.isNaN(Number(i.value))&&Number(e.get(i.field))>=Number(i.value)&&(o=!0):"max"===i.type?!t.isNaN(Number(e.get(i.field)))&&!t.isNaN(Number(i.value))&&Number(e.get(i.field))<=Number(i.value)&&(o=!0):"range"===i.type?!t.isNaN(Number(e.get(i.field)))&&t.isObject(i.value)&&!t.isNaN(Number(i.value.min))&&!t.isNaN(Number(i.value.max))&&Number(e.get(i.field))>=Number(i.value.min)&&Number(e.get(i.field))<=Number(i.value.max)&&(o=!0):"minLength"===i.type?e.get(i.field).toString().length>=i.value&&(o=!0):"maxLength"===i.type?e.get(i.field).toString().length<=i.value&&(o=!0):"rangeLength"===i.type?t.isObject(i.value)&&!t.isNaN(Number(i.value.min))&&!t.isNaN(Number(i.value.max))&&e.get(i.field).toString().length>=i.value.min&&e.get(i.field).toString().length<=i.value.max&&(o=!0):"oneOf"===i.type?t.isArray(i.value)&&t.include(i.value,e.get(i.field))&&(o=!0):"equalTo"===i.type?i.value===e.get(i.field)&&(o=!0):"containsAllOf"===i.type?t.isArray(i.value)&&t.isArray(e.get(i.field))&&t.intersection(i.value,e.get(i.field)).length===i.value.length&&(o=!0):"pattern"===i.type?e.get(i.field).toString().match(i.value)&&(o=!0):o=!1}),o&&n.push(e)}),n},_filter:function(i,n,o){var r=this,s={};if(t.isString(n)?s[n]={cmp_method:"regexp"}:t.isArray(n)?t.each(n,function(e){s[e]={cmp_method:"regexp"}}):t.each(n,function(e,i){s[i]=t.defaults(e,{cmp_method:"regexp"})}),n=s,t.has(e.Paginator,"removeDiacritics")&&r.useDiacriticsPlugin&&(o=e.Paginator.removeDiacritics(o)),""===o||!t.isString(o))return i;var a=t.map(o.match(/\w+/gi),function(e){return e.toLowerCase()}),l="("+t.uniq(a).join("|")+")",c=new RegExp(l,"igm"),u=[];return t.each(i,function(i){var s=[];t.each(n,function(n,l){var u=i.get(l);if(u){var d=[];if(u=t.has(e.Paginator,"removeDiacritics")&&r.useDiacriticsPlugin?e.Paginator.removeDiacritics(u.toString()):u.toString(),"levenshtein"===n.cmp_method&&t.has(e.Paginator,"levenshtein")&&r.useLevenshteinPlugin){var h=e.Paginator.levenshtein(u,o);t.defaults(n,{max_distance:0}),h<=n.max_distance&&(d=t.uniq(a))}else d=u.match(c);d=t.map(d,function(e){return e.toString().toLowerCase()}),t.each(d,function(e){s.push(e)})}}),s=t.uniq(t.without(s,"")),t.isEmpty(t.difference(a,s))&&u.push(i)}),u},info:function(){var e=this,t={},i=e.sortedAndFilteredModels?e.sortedAndFilteredModels.length:e.length,n=Math.ceil(i/e.perPage);return t={totalUnfilteredRecords:e.origModels.length,totalRecords:i,currentPage:e.currentPage,perPage:this.perPage,totalPages:n,lastPage:n,previous:!1,next:!1,startRecord:0===i?0:(e.currentPage-1)*this.perPage+1,endRecord:Math.min(i,e.currentPage*this.perPage)},e.currentPage>1&&(t.previous=e.currentPage-1),e.currentPage<t.totalPages&&(t.next=e.currentPage+1),t.pageSet=e.setPagination(t),e.information=t,t},setPagination:function(e){var t=[],i=0,n=0,o=2*this.pagesInRange,r=Math.ceil(e.totalRecords/e.perPage);if(r>1)if(r<=1+o)for(i=1,n=r;i<=n;i++)t.push(i);else if(e.currentPage<=this.pagesInRange+1)for(i=1,n=2+o;i<n;i++)t.push(i);else if(r-this.pagesInRange>e.currentPage&&e.currentPage>this.pagesInRange)for(i=e.currentPage-this.pagesInRange;i<=e.currentPage+this.pagesInRange;i++)t.push(i);else for(i=r-o;i<=r;i++)t.push(i);return t},bootstrap:function(e){return t.extend(this,e),this.goTo(1),this.info(),this}}),o.clientPager.prototype.prevPage=o.clientPager.prototype.previousPage;var r=function(){var e=new i.Deferred;return e.reject(),e.promise()};return o.requestPager=e.Collection.extend({sync:function(o,r,s){var a=this;a.setDefaults();var l={};t.each(t.result(a,"server_api"),function(e,i){t.isFunction(e)&&(e=t.bind(e,a),e=e()),l[i]=e});var c=t.clone(a.paginator_core);t.each(c,function(e,i){t.isFunction(e)&&(e=t.bind(e,a),e=e()),c[i]=e}),c=t.defaults(c,{timeout:25e3,cache:!1,type:"GET",dataType:"jsonp"}),s.data?s.data=decodeURIComponent(i.param(t.extend(l,s.data))):s.data=decodeURIComponent(i.param(l)),c=t.extend(c,{data:decodeURIComponent(i.param(l)),processData:!1,url:t.result(c,"url")},s);var u=!(0===n[0]&&9===n[1]&&10===n[2]),d=c.success;c.success=function(e,t,i){d&&(u?d(e,t,i):d(r,e,c)),n[0]<1&&r&&r.trigger&&r.trigger("sync",r,e,c)};var h=c.error;c.error=function(e){h&&h(e),r&&r.trigger&&r.trigger("error",r,e,c)};var p=c.xhr=e.ajax(c);return r&&r.trigger&&r.trigger("request",r,p,c),p},setDefaults:function(){var e=this;t.defaults(e.paginator_ui,{firstPage:0,currentPage:1,perPage:5,totalPages:10,pagesInRange:4}),t.each(e.paginator_ui,function(i,n){t.isUndefined(e[n])&&(e[n]=e.paginator_ui[n])})},requestNextPage:function(e){return e=e||{},void 0!==this.currentPage?(e.remove=e.remove||!1,this.currentPage+=1,this.pager(e)):r()},requestPreviousPage:function(e){return void 0!==this.currentPage?(this.currentPage-=1,this.pager(e)):r()},updateOrder:function(e,t){return void 0!==e?(this.sortField=e,this.pager(t)):r()},goTo:function(e,t){return void 0!==e?(this.currentPage=parseInt(e,10),this.pager(t)):r()},howManyPer:function(e,t){return void 0!==e?(this.currentPage=this.firstPage,this.perPage=e,this.pager(t)):r()},info:function(){var e={totalRecords:this.totalRecords||0,currentPage:this.currentPage,firstPage:this.firstPage,totalPages:Math.ceil(this.totalRecords/this.perPage),lastPage:this.totalPages,perPage:this.perPage,previous:!1,next:!1};return this.currentPage>1&&(e.previous=this.currentPage-1),this.currentPage<e.totalPages&&(e.next=this.currentPage+1),e.hasNext=e.next,e.hasPrevious=e.next,e.pageSet=this.setPagination(e),this.information=e,e},setPagination:function(e){var t=[],i=0,n=0,o=2*this.pagesInRange,r=Math.ceil(e.totalRecords/e.perPage);if(r>1)if(r<=1+o)for(i=1,n=r;i<=n;i++)t.push(i);else if(e.currentPage<=this.pagesInRange+1)for(i=1,n=2+o;i<n;i++)t.push(i);else if(r-this.pagesInRange>e.currentPage&&e.currentPage>this.pagesInRange)for(i=e.currentPage-this.pagesInRange;i<=e.currentPage+this.pagesInRange;i++)t.push(i);else for(i=r-o;i<=r;i++)t.push(i);return t},pager:function(e){return t.isObject(e)||(e={}),this.fetch(e)},url:function(){return void 0!==this.paginator_core&&void 0!==this.paginator_core.url?this.paginator_core.url:null},bootstrap:function(e){return t.extend(this,e),this.setDefaults(),this.info(),this}}),o.requestPager.prototype.nextPage=o.requestPager.prototype.requestNextPage,o.requestPager.prototype.prevPage=o.requestPager.prototype.requestPreviousPage,o}(Backbone,_,jQuery),function(e,t){if("function"==typeof define&&define.amd)define(["backbone","underscore"],function(i,n){return e.Marionette=e.Mn=t(e,i,n)});else if("undefined"!=typeof exports){var i=require("backbone"),n=require("underscore");module.exports=t(e,i,n)}else e.Marionette=e.Mn=t(e,e.Backbone,e._)}(this,function(e,t,i){"use strict";!function(e,t){var i=e.ChildViewContainer;return e.ChildViewContainer=function(e,t){var i=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(i.prototype,{add:function(e,t){var i=e.cid;return this._views[i]=e,e.model&&(this._indexByModel[e.model.cid]=i),t&&(this._indexByCustom[t]=i),this._updateLength(),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var i=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){if(e===i)return delete this._indexByCustom[t],!0},this),delete this._views[i],this._updateLength(),this},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,i){t.each(this._views,function(n){t.isFunction(n[e])&&n[e].apply(n,i||[])})},_updateLength:function(){this.length=t.size(this._views)}});var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return t.each(n,function(e){i.prototype[e]=function(){var i=t.values(this._views),n=[i].concat(t.toArray(arguments));return t[e].apply(t,n)}}),i}(e,t),e.ChildViewContainer.VERSION="0.1.11",e.ChildViewContainer.noConflict=function(){return e.ChildViewContainer=i,this},e.ChildViewContainer}(t,i),function(e,t){var i=e.Wreqr,n=e.Wreqr={};return e.Wreqr.VERSION="1.3.6",e.Wreqr.noConflict=function(){return e.Wreqr=i,this},n.Handlers=function(e,t){var i=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return i.extend=e.Model.extend,t.extend(i.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,i){var n=null;t.isObject(e)&&!t.isFunction(e)&&(n=e.context,e=e.callback),this.setHandler(i,e,n)},this)},setHandler:function(e,t,i){var n={callback:t,context:i};this._wreqrHandlers[e]=n,this.trigger("handler:add",e,t,i)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(t)return function(){return t.callback.apply(t.context,arguments)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),i}(e,t),n.CommandStorage=function(){var i=function(e){this.options=e,this._commands={},t.isFunction(this.initialize)&&this.initialize(e)};return t.extend(i.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var i=this.getCommands(e);i.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),i}(),n.Commands=function(e,t){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this),e.Handlers.prototype.constructor.apply(this,arguments)},execute:function(e){e=arguments[0];var i=t.rest(arguments);this.hasHandler(e)?this.getHandler(e).apply(this,i):this.storage.addCommand(e,i)},_executeCommands:function(e,i,n){var o=this.storage.getCommands(e);t.each(o.instances,function(e){i.apply(n,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var i,n=e.storageType||this.storageType;i=t.isFunction(n)?new n:n,this.storage=i}})}(n,t),n.RequestResponse=function(e,t){return e.Handlers.extend({request:function(e){if(this.hasHandler(e))return this.getHandler(e).apply(this,t.rest(arguments))}})}(n,t),n.EventAggregator=function(e,t){var i=function(){};return i.extend=e.Model.extend,t.extend(i.prototype,e.Events),i}(e,t),n.Channel=function(){var i=function(t){this.vent=new e.Wreqr.EventAggregator,this.reqres=new e.Wreqr.RequestResponse,this.commands=new e.Wreqr.Commands,this.channelName=t};return t.extend(i.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(e,t){return this._connect("vent",e,t),this},connectCommands:function(e,t){return this._connect("commands",e,t),this},connectRequests:function(e,t){return this._connect("reqres",e,t),this},_connect:function(e,i,n){if(i){n=n||this;var o="vent"===e?"on":"setHandler";t.each(i,function(i,r){this[e][o](r,t.bind(i,n))},this)}}}),i}(n),n.radio=function(e,t){var i=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};t.extend(i.prototype,{channel:function(e){if(!e)throw new Error("Channel must receive a name");return this._getChannel(e)},_getChannel:function(t){var i=this._channels[t];return i||(i=new e.Channel(t),this._channels[t]=i),i},_proxyMethods:function(){t.each(["vent","commands","reqres"],function(e){t.each(n[e],function(t){this[e][t]=o(this,e,t)},this)},this)}});var n={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},o=function(e,i,n){return function(o){var r=e._getChannel(o)[i];return r[n].apply(r,t.rest(arguments))}};return new i}(n,t),e.Wreqr}(t,i);var n=e.Marionette,o=e.Mn,r=t.Marionette={};r.VERSION="2.4.7",r.noConflict=function(){return e.Marionette=n,e.Mn=o,this},t.Marionette=r,r.Deferred=t.$.Deferred,r.extend=t.Model.extend,r.isNodeAttached=function(e){return t.$.contains(document.documentElement,e)},r.mergeOptions=function(e,t){e&&i.extend(this,i.pick(e,t))},r.getOption=function(e,t){if(e&&t)return e.options&&void 0!==e.options[t]?e.options[t]:e[t]},r.proxyGetOption=function(e){return r.getOption(this,e)},r._getValue=function(e,t,n){return i.isFunction(e)&&(e=n?e.apply(t,n):e.call(t)),e},r.normalizeMethods=function(e){return i.reduce(e,function(e,t,n){return i.isFunction(t)||(t=this[t]),t&&(e[n]=t),e},{},this)},r.normalizeUIString=function(e,t){return e.replace(/@ui\.[a-zA-Z-_$0-9]*/g,function(e){return t[e.slice(4)]})},r.normalizeUIKeys=function(e,t){return i.reduce(e,function(e,i,n){var o=r.normalizeUIString(n,t);return e[o]=i,e},{})},r.normalizeUIValues=function(e,t,n){return i.each(e,function(o,s){i.isString(o)?e[s]=r.normalizeUIString(o,t):i.isObject(o)&&i.isArray(n)&&(i.extend(o,r.normalizeUIValues(i.pick(o,n),t)),i.each(n,function(e){var n=o[e];i.isString(n)&&(o[e]=r.normalizeUIString(n,t))}))}),e},r.actAsCollection=function(e,t){var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];i.each(n,function(n){e[n]=function(){var e=i.values(i.result(this,t)),o=[e].concat(i.toArray(arguments));return i[n].apply(i,o)}})};var s=r.deprecate=function(e,t){i.isObject(e)&&(e=e.prev+" is going to be removed in the future. Please use "+e.next+" instead."+(e.url?" See: "+e.url:"")),void 0!==t&&t||s._cache[e]||(s._warn("Deprecation warning: "+e),s._cache[e]=!0)};s._console="undefined"!=typeof console?console:{},s._warn=function(){var e=s._console.warn||s._console.log||function(){};return e.apply(s._console,arguments)},s._cache={},r._triggerMethod=function(){function e(e,t,i){return i.toUpperCase()}var t=/(^|:)(\w)/gi;return function(n,o,r){var s=arguments.length<3;s&&(r=o,o=r[0]);var a,l="on"+o.replace(t,e),c=n[l];return i.isFunction(c)&&(a=c.apply(n,s?i.rest(r):r)),i.isFunction(n.trigger)&&(s+r.length>1?n.trigger.apply(n,s?r:[o].concat(i.drop(r,0))):n.trigger(o)),a}}(),r.triggerMethod=function(){return r._triggerMethod(this,arguments)},r.triggerMethodOn=function(e){var t=i.isFunction(e.triggerMethod)?e.triggerMethod:r.triggerMethod;return t.apply(e,i.rest(arguments))},r.MonitorDOMRefresh=function(e){function t(){e._isShown=!0,n()}function i(){e._isRendered=!0,n()}function n(){e._isShown&&e._isRendered&&r.isNodeAttached(e.el)&&r.triggerMethodOn(e,"dom:refresh",e);
}e._isDomRefreshMonitored||(e._isDomRefreshMonitored=!0,e.on({show:t,render:i}))},function(e){function t(t,n,o,r){var s=r.split(/\s+/);i.each(s,function(i){var r=t[i];if(!r)throw new e.Error('Method "'+i+'" was configured as an event handler, but does not exist.');t.listenTo(n,o,r)})}function n(e,t,i,n){e.listenTo(t,i,n)}function o(e,t,n,o){var r=o.split(/\s+/);i.each(r,function(i){var o=e[i];e.stopListening(t,n,o)})}function r(e,t,i,n){e.stopListening(t,i,n)}function s(t,n,o,r,s){if(n&&o){if(!i.isObject(o))throw new e.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});o=e._getValue(o,t),i.each(o,function(e,o){i.isFunction(e)?r(t,n,o,e):s(t,n,o,e)})}}e.bindEntityEvents=function(e,i,o){s(e,i,o,n,t)},e.unbindEntityEvents=function(e,t,i){s(e,t,i,r,o)},e.proxyBindEntityEvents=function(t,i){return e.bindEntityEvents(this,t,i)},e.proxyUnbindEntityEvents=function(t,i){return e.unbindEntityEvents(this,t,i)}}(r);var a=["description","fileName","lineNumber","name","message","number"];return r.Error=r.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+r.VERSION+"/",constructor:function(e,t){i.isObject(e)?(t=e,e=t.message):t||(t={});var n=Error.call(this,e);i.extend(this,i.pick(n,a),i.pick(t,a)),this.captureStackTrace(),t.url&&(this.url=this.urlRoot+t.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,r.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),r.Error.extend=r.extend,r.Callbacks=function(){this._deferred=r.Deferred(),this._callbacks=[]},i.extend(r.Callbacks.prototype,{add:function(e,t){var n=i.result(this._deferred,"promise");this._callbacks.push({cb:e,ctx:t}),n.then(function(i){t&&(i.context=t),e.call(i.context,i.options)})},run:function(e,t){this._deferred.resolve({options:e,context:t})},reset:function(){var e=this._callbacks;this._deferred=r.Deferred(),this._callbacks=[],i.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),r.Controller=function(e){this.options=e||{},i.isFunction(this.initialize)&&this.initialize(this.options)},r.Controller.extend=r.extend,i.extend(r.Controller.prototype,t.Events,{destroy:function(){return r._triggerMethod(this,"before:destroy",arguments),r._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:r.triggerMethod,mergeOptions:r.mergeOptions,getOption:r.proxyGetOption}),r.Object=function(e){this.options=i.extend({},i.result(this,"options"),e),this.initialize.apply(this,arguments)},r.Object.extend=r.extend,i.extend(r.Object.prototype,t.Events,{initialize:function(){},destroy:function(e){return e=e||{},this.triggerMethod("before:destroy",e),this.triggerMethod("destroy",e),this.stopListening(),this},triggerMethod:r.triggerMethod,mergeOptions:r.mergeOptions,getOption:r.proxyGetOption,bindEntityEvents:r.proxyBindEntityEvents,unbindEntityEvents:r.proxyUnbindEntityEvents}),r.Region=r.Object.extend({constructor:function(e){if(this.options=e||{},this.el=this.getOption("el"),this.el=this.el instanceof t.$?this.el[0]:this.el,!this.el)throw new r.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),r.Object.call(this,e)},show:function(e,t){if(this._ensureElement()){this._ensureViewIsIntact(e),r.MonitorDOMRefresh(e);var n=t||{},o=e!==this.currentView,s=!!n.preventDestroy,a=!!n.forceShow,l=!!this.currentView,c=o&&!s,u=o||a;if(l&&this.triggerMethod("before:swapOut",this.currentView,this,t),this.currentView&&o&&delete this.currentView._parent,c?this.empty():l&&u&&this.currentView.off("destroy",this.empty,this),u){e.once("destroy",this.empty,this),e._parent=this,this._renderView(e),l&&this.triggerMethod("before:swap",e,this,t),this.triggerMethod("before:show",e,this,t),r.triggerMethodOn(e,"before:show",e,this,t),l&&this.triggerMethod("swapOut",this.currentView,this,t);var d=r.isNodeAttached(this.el),h=[],p=i.extend({triggerBeforeAttach:this.triggerBeforeAttach,triggerAttach:this.triggerAttach},n);return d&&p.triggerBeforeAttach&&(h=this._displayedViews(e),this._triggerAttach(h,"before:")),this.attachHtml(e),this.currentView=e,d&&p.triggerAttach&&(h=this._displayedViews(e),this._triggerAttach(h)),l&&this.triggerMethod("swap",e,this,t),this.triggerMethod("show",e,this,t),r.triggerMethodOn(e,"show",e,this,t),this}return this}},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(e,t){var n=(t||"")+"attach";i.each(e,function(e){r.triggerMethodOn(e,n,e,this)},this)},_displayedViews:function(e){return i.union([e],i.result(e,"_getNestedViews")||[])},_renderView:function(e){e.supportsRenderLifecycle||r.triggerMethodOn(e,"before:render",e),e.render(),e.supportsRenderLifecycle||r.triggerMethodOn(e,"render",e)},_ensureElement:function(){if(i.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){if(this.getOption("allowMissingEl"))return!1;throw new r.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(e){if(!e)throw new r.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(e.isDestroyed)throw new r.Error({name:"ViewDestroyedError",message:'View (cid: "'+e.cid+'") has already been destroyed and cannot be used.'})},getEl:function(e){return t.$(e,r._getValue(this.options.parentEl,this))},attachHtml:function(e){this.$el.contents().detach(),this.el.appendChild(e.el)},empty:function(e){var t=this.currentView,i=e||{},n=!!i.preventDestroy;return t?(t.off("destroy",this.empty,this),this.triggerMethod("before:empty",t),n||this._destroyView(),this.triggerMethod("empty",t),delete this.currentView,n&&this.$el.contents().detach(),this):this},_destroyView:function(){var e=this.currentView;e.isDestroyed||(e.supportsDestroyLifecycle||r.triggerMethodOn(e,"before:destroy",e),e.destroy?e.destroy():(e.remove(),e.isDestroyed=!0),e.supportsDestroyLifecycle||r.triggerMethodOn(e,"destroy",e))},attachView:function(e){return this.currentView&&delete this.currentView._parent,e._parent=this,this.currentView=e,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this}},{buildRegion:function(e,t){if(i.isString(e))return this._buildRegionFromSelector(e,t);if(e.selector||e.el||e.regionClass)return this._buildRegionFromObject(e,t);if(i.isFunction(e))return this._buildRegionFromRegionClass(e);throw new r.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(e,t){return new t({el:e})},_buildRegionFromObject:function(e,t){var n=e.regionClass||t,o=i.omit(e,"selector","regionClass");return e.selector&&!o.el&&(o.el=e.selector),new n(o)},_buildRegionFromRegionClass:function(e){return new e}}),r.RegionManager=r.Controller.extend({constructor:function(e){this._regions={},this.length=0,r.Controller.call(this,e),this.addRegions(this.getOption("regions"))},addRegions:function(e,t){return e=r._getValue(e,this,arguments),i.reduce(e,function(e,n,o){return i.isString(n)&&(n={selector:n}),n.selector&&(n=i.defaults({},n,t)),e[o]=this.addRegion(o,n),e},{},this)},addRegion:function(e,t){var i;return i=t instanceof r.Region?t:r.Region.buildRegion(t,r.Region),this.triggerMethod("before:add:region",e,i),i._parent=this,this._store(e,i),this.triggerMethod("add:region",e,i),i},get:function(e){return this._regions[e]},getRegions:function(){return i.clone(this._regions)},removeRegion:function(e){var t=this._regions[e];return this._remove(e,t),t},removeRegions:function(){var e=this.getRegions();return i.each(this._regions,function(e,t){this._remove(t,e)},this),e},emptyRegions:function(){var e=this.getRegions();return i.invoke(e,"empty"),e},destroy:function(){return this.removeRegions(),r.Controller.prototype.destroy.apply(this,arguments)},_store:function(e,t){this._regions[e]||this.length++,this._regions[e]=t},_remove:function(e,t){this.triggerMethod("before:remove:region",e,t),t.empty(),t.stopListening(),delete t._parent,delete this._regions[e],this.length--,this.triggerMethod("remove:region",e,t)}}),r.actAsCollection(r.RegionManager.prototype,"_regions"),r.TemplateCache=function(e){this.templateId=e},i.extend(r.TemplateCache,{templateCaches:{},get:function(e,t){var i=this.templateCaches[e];return i||(i=new r.TemplateCache(e),this.templateCaches[e]=i),i.load(t)},clear:function(){var e,t=i.toArray(arguments),n=t.length;if(n>0)for(e=0;e<n;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),i.extend(r.TemplateCache.prototype,{load:function(e){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId,e);return this.compiledTemplate=this.compileTemplate(t,e),this.compiledTemplate},loadTemplate:function(e){var i=t.$(e);if(!i.length)throw new r.Error({name:"NoTemplateError",message:'Could not find template: "'+e+'"'});return i.html()},compileTemplate:function(e,t){return i.template(e,t)}}),r.Renderer={render:function(e,t){if(!e)throw new r.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var n=i.isFunction(e)?e:r.TemplateCache.get(e);return n(t)}},r.View=t.View.extend({isDestroyed:!1,supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,constructor:function(e){this.render=i.bind(this.render,this),e=r._getValue(e,this),this.options=i.extend({},i.result(this,"options"),e),this._behaviors=r.Behaviors(this),t.View.call(this,this.options),r.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(e){return e.toJSON.apply(e,i.rest(arguments))},mixinTemplateHelpers:function(e){e=e||{};var t=this.getOption("templateHelpers");return t=r._getValue(t,this),i.extend(e,t)},normalizeUIKeys:function(e){var t=i.result(this,"_uiBindings");return r.normalizeUIKeys(e,t||i.result(this,"ui"))},normalizeUIValues:function(e,t){var n=i.result(this,"ui"),o=i.result(this,"_uiBindings");return r.normalizeUIValues(e,o||n,t)},configureTriggers:function(){if(this.triggers){var e=this.normalizeUIKeys(i.result(this,"triggers"));return i.reduce(e,function(e,t,i){return e[i]=this._buildViewTrigger(t),e},{},this)}},delegateEvents:function(e){return this._delegateDOMEvents(e),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,function(e){e.bindEntityEvents(this.model,e.getOption("modelEvents")),e.bindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(e){var n=r._getValue(e||this.events,this);n=this.normalizeUIKeys(n),i.isUndefined(e)&&(this.events=n);var o={},s=i.result(this,"behaviorEvents")||{},a=this.configureTriggers(),l=i.result(this,"behaviorTriggers")||{};i.extend(o,s,n,a,l),t.View.prototype.delegateEvents.call(this,o)},undelegateEvents:function(){return t.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,function(e){e.unbindEntityEvents(this.model,e.getOption("modelEvents")),e.unbindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new r.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var e=i.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(e)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(e)),this.unbindUIElements(),this.isRendered=!1,this.remove(),i.invoke(this._behaviors,"destroy",e),this},bindUIElements:function(){this._bindUIElements(),i.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var e=i.result(this,"_uiBindings");this.ui={},i.each(e,function(e,t){this.ui[t]=this.$(e)},this)}},unbindUIElements:function(){this._unbindUIElements(),i.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(i.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(e){var t=i.defaults({},e,{preventDefault:!0,stopPropagation:!0}),n=i.isObject(e)?t.event:e;return function(e){e&&(e.preventDefault&&t.preventDefault&&e.preventDefault(),e.stopPropagation&&t.stopPropagation&&e.stopPropagation());var i={view:this,model:this.model,collection:this.collection};this.triggerMethod(n,i)}},setElement:function(){var e=t.View.prototype.setElement.apply(this,arguments);return i.invoke(this._behaviors,"proxyViewProperties",this),e},triggerMethod:function(){var e=r._triggerMethod(this,arguments);return this._triggerEventOnBehaviors(arguments),this._triggerEventOnParentLayout(arguments[0],i.rest(arguments)),e},_triggerEventOnBehaviors:function(e){for(var t=r._triggerMethod,i=this._behaviors,n=0,o=i&&i.length;n<o;n++)t(i[n],e)},_triggerEventOnParentLayout:function(e,t){var n=this._parentLayoutView();if(n){var o=r.getOption(n,"childViewEventPrefix"),s=o+":"+e,a=[this].concat(t);r._triggerMethod(n,s,a);var l=r.getOption(n,"childEvents");l=r._getValue(l,n);var c=n.normalizeMethods(l);c&&i.isFunction(c[e])&&c[e].apply(n,a)}},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var e=this._getImmediateChildren();return e.length?i.reduce(e,function(e,t){return t._getNestedViews?e.concat(t._getNestedViews()):e},e):e},_parentLayoutView:function(){for(var e=this._parent;e;){if(e instanceof r.LayoutView)return e;e=e._parent}},normalizeMethods:r.normalizeMethods,mergeOptions:r.mergeOptions,getOption:r.proxyGetOption,bindEntityEvents:r.proxyBindEntityEvents,unbindEntityEvents:r.proxyUnbindEntityEvents}),r.ItemView=r.View.extend({constructor:function(){r.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var e=[this.model||this.collection];return arguments.length&&e.push.apply(e,arguments),this.model?this.serializeModel.apply(this,e):{items:this.serializeCollection.apply(this,e)}},serializeCollection:function(e){return e.toJSON.apply(e,i.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.isRendered=!0,this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var e=this.getTemplate();if(e!==!1){if(!e)throw new r.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var t=this.mixinTemplateHelpers(this.serializeData()),i=r.Renderer.render(e,t,this);return this.attachElContent(i),this}},attachElContent:function(e){return this.$el.html(e),this}}),r.CollectionView=r.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(){this.once("render",this._initialEvents),this._initChildViewStorage(),r.View.apply(this,arguments),this.on({"before:show":this._onBeforeShowCalled,show:this._onShowCalled,"before:attach":this._onBeforeAttachCalled,attach:this._onAttachCalled}),this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){var e,t=this._isShown&&r.isNodeAttached(this.el);this.isBuffering=!1,this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"before:show"),t&&this._triggerBeforeAttach&&(e=this._getNestedViews(),this._triggerMethodMany(e,this,"before:attach")),this.attachBuffer(this,this._createBuffer()),t&&this._triggerAttach&&(e=this._getNestedViews(),this._triggerMethodMany(e,this,"attach")),this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"show"),this.initRenderBuffer()},_triggerMethodMany:function(e,t,n){var o=i.drop(arguments,3);i.each(e,function(e){r.triggerMethodOn.apply(e,[e,n,e,t].concat(o))})},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(e,t,n){var o=void 0!==n.at&&(n.index||t.indexOf(e));if((this.getOption("filter")||o===!1)&&(o=i.indexOf(this._filteredSortedModels(o),e)),this._shouldAddChild(e,o)){this.destroyEmptyView();var r=this.getChildView(e);this.addChild(e,r,o)}},_onCollectionRemove:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},_onBeforeShowCalled:function(){this._triggerBeforeAttach=this._triggerAttach=!1,this.children.each(function(e){r.triggerMethodOn(e,"before:show",e)})},_onShowCalled:function(){this.children.each(function(e){r.triggerMethodOn(e,"show",e)})},_onBeforeAttachCalled:function(){this._triggerBeforeAttach=!0},_onAttachCalled:function(){this._triggerAttach=!0},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.isRendered=!0,this.triggerMethod("render",this),this},reorder:function(){var e=this.children,t=this._filteredSortedModels();if(!t.length&&this._showingEmptyView)return this;var n=i.some(t,function(t){return!e.findByModel(t)});if(n)this.render();else{var o=i.map(t,function(t,i){var n=e.findByModel(t);return n._index=i,n.el}),r=e.filter(function(e){return!i.contains(o,e.el)});this.triggerMethod("before:reorder"),this._appendReorderedChildren(o),i.each(r,this.removeChildView,this),this.checkEmpty(),this.triggerMethod("reorder")}},resortView:function(){r.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var e=this._filteredSortedModels(),t=i.find(e,function(e,t){var i=this.children.findByModel(e);return!i||i._index!==t},this);t&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(e){this.$el.append(e)},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren({checkEmpty:!1}),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.getOption("filter")&&this.showEmptyView())},showCollection:function(){var e,t=this._filteredSortedModels();i.each(t,function(t,i){e=this.getChildView(t),this.addChild(t,e,i)},this)},_filteredSortedModels:function(e){var t=this.getViewComparator(),n=this.collection.models;if(e=Math.min(Math.max(e,0),n.length-1),t){var o;e&&(o=n[e],n=n.slice(0,e).concat(n.slice(e+1))),n=this._sortModelsBy(n,t),o&&n.splice(e,0,o)}return this.getOption("filter")&&(n=i.filter(n,function(e,t){return this._shouldAddChild(e,t)},this)),n},_sortModelsBy:function(e,t){return"string"==typeof t?i.sortBy(e,function(e){return e.get(t)},this):1===t.length?i.sortBy(e,t,this):e.sort(i.bind(t,this))},showEmptyView:function(){var e=this.getEmptyView();if(e&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var i=new t.Model;this.addEmptyView(i,e),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(e,t){var n,o=this._isShown&&!this.isBuffering&&r.isNodeAttached(this.el),s=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");i.isFunction(s)&&(s=s.call(this,e,this._emptyViewIndex));var a=this.buildChildView(e,t,s);a._parent=this,this.proxyChildEvents(a),a.once("render",function(){this._isShown&&r.triggerMethodOn(a,"before:show",a),o&&this._triggerBeforeAttach&&(n=this._getViewAndNested(a),this._triggerMethodMany(n,this,"before:attach"))},this),this.children.add(a),this.renderChildView(a,this._emptyViewIndex),o&&this._triggerAttach&&(n=this._getViewAndNested(a),this._triggerMethodMany(n,this,"attach")),this._isShown&&r.triggerMethodOn(a,"show",a)},getChildView:function(){var e=this.getOption("childView");if(!e)throw new r.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return e},addChild:function(e,t,i){var n=this.getOption("childViewOptions");n=r._getValue(n,this,[e,i]);var o=this.buildChildView(e,t,n);return this._updateIndices(o,!0,i),this.triggerMethod("before:add:child",o),this._addChildView(o,i),this.triggerMethod("add:child",o),o._parent=this,o},_updateIndices:function(e,t,i){this.getOption("sort")&&(t&&(e._index=i),this.children.each(function(i){i._index>=e._index&&(i._index+=t?1:-1)}))},_addChildView:function(e,t){var i,n=this._isShown&&!this.isBuffering&&r.isNodeAttached(this.el);this.proxyChildEvents(e),e.once("render",function(){this._isShown&&!this.isBuffering&&r.triggerMethodOn(e,"before:show",e),n&&this._triggerBeforeAttach&&(i=this._getViewAndNested(e),this._triggerMethodMany(i,this,"before:attach"))},this),this.children.add(e),this.renderChildView(e,t),n&&this._triggerAttach&&(i=this._getViewAndNested(e),this._triggerMethodMany(i,this,"attach")),this._isShown&&!this.isBuffering&&r.triggerMethodOn(e,"show",e)},renderChildView:function(e,t){return e.supportsRenderLifecycle||r.triggerMethodOn(e,"before:render",e),e.render(),e.supportsRenderLifecycle||r.triggerMethodOn(e,"render",e),this.attachHtml(this,e,t),e},buildChildView:function(e,t,n){var o=i.extend({model:e},n),s=new t(o);return r.MonitorDOMRefresh(s),s},removeChildView:function(e){return e?(this.triggerMethod("before:remove:child",e),e.supportsDestroyLifecycle||r.triggerMethodOn(e,"before:destroy",e),e.destroy?e.destroy():e.remove(),e.supportsDestroyLifecycle||r.triggerMethodOn(e,"destroy",e),delete e._parent,this.stopListening(e),this.children.remove(e),this.triggerMethod("remove:child",e),this._updateIndices(e,!1),e):e},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(e,t){e.$el.append(t)},_createBuffer:function(){var e=document.createDocumentFragment();return i.each(this._bufferedChildren,function(t){e.appendChild(t.el)}),e},attachHtml:function(e,t,i){e.isBuffering?e._bufferedChildren.splice(i,0,t):e._insertBefore(t,i)||e._insertAfter(t)},_insertBefore:function(e,t){var i,n=this.getOption("sort")&&t<this.children.length-1;return n&&(i=this.children.find(function(e){return e._index===t+1})),!!i&&(i.$el.before(e.el),!0)},_insertAfter:function(e){this.$el.append(e.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},destroy:function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy:collection"),this.destroyChildren({checkEmpty:!1}),this.triggerMethod("destroy:collection"),r.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(e){var t=e||{},n=!0,o=this.children.map(i.identity);return i.isUndefined(t.checkEmpty)||(n=t.checkEmpty),this.children.each(this.removeChildView,this),n&&this.checkEmpty(),o},_shouldAddChild:function(e,t){var n=this.getOption("filter");return!i.isFunction(n)||n.call(this,e,t,this.collection)},proxyChildEvents:function(e){var t=this.getOption("childViewEventPrefix");this.listenTo(e,"all",function(){var n=i.toArray(arguments),o=n[0],r=this.normalizeMethods(i.result(this,"childEvents"));n[0]=t+":"+o,n.splice(1,0,e),"undefined"!=typeof r&&i.isFunction(r[o])&&r[o].apply(this,n.slice(1)),this.triggerMethod.apply(this,n)})},_getImmediateChildren:function(){return i.values(this.children._views)},_getViewAndNested:function(e){return[e].concat(i.result(e,"_getNestedViews")||[])},getViewComparator:function(){return this.getOption("viewComparator")}}),r.CompositeView=r.CollectionView.extend({constructor:function(){r.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(){var e=this.getOption("childView")||this.constructor;return e},serializeData:function(){var e={};return this.model&&(e=i.partial(this.serializeModel,this.model).apply(this,arguments)),e},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this._isRendering=!1,this.isRendered=!0,this.triggerMethod("render",this),this},_renderChildren:function(){(this.isRendered||this._isRendering)&&r.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e),this.triggerMethod("before:render:template");var t=this.getTemplate(),i=r.Renderer.render(t,e,this);this.attachElContent(i),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(e){return this.$el.html(e),this},attachBuffer:function(e,t){var i=this.getChildViewContainer(e);i.append(t)},_insertAfter:function(e){var t=this.getChildViewContainer(this,e);t.append(e.el)},_appendReorderedChildren:function(e){var t=this.getChildViewContainer(this);t.append(e)},getChildViewContainer:function(e){if(e.$childViewContainer)return e.$childViewContainer;var t,i=r.getOption(e,"childViewContainer");if(i){var n=r._getValue(i,e);if(t="@"===n.charAt(0)&&e.ui?e.ui[n.substr(4)]:e.$(n),t.length<=0)throw new r.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+e.childViewContainer})}else t=e.$el;return e.$childViewContainer=t,t},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}}),r.LayoutView=r.ItemView.extend({regionClass:r.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),r.ItemView.call(this,e)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),r.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.getOption("destroyImmediate")===!0&&this.$el.remove(),this.regionManager.destroy(),r.ItemView.prototype.destroy.apply(this,arguments))},showChildView:function(e){var t=this.getRegion(e);return t.show.apply(t,i.rest(arguments))},getChildView:function(e){return this.getRegion(e).currentView},addRegion:function(e,t){var i={};return i[e]=t,this._buildRegions(i)[e]},addRegions:function(e){return this.regions=i.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},getRegion:function(e){return this.regionManager.get(e)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(e){var t={regionClass:this.getOption("regionClass"),parentEl:i.partial(i.result,this,"el")};return this.regionManager.addRegions(e,t)},_initializeRegions:function(e){var t;this._initRegionManager(),t=r._getValue(this.regions,this,[e])||{};var n=this.getOption.call(e,"regions");n=r._getValue(n,this,[e]),i.extend(t,n),t=this.normalizeUIValues(t,["selector","el"]),this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new r.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",function(e){this.triggerMethod("before:add:region",e)}),this.listenTo(this.regionManager,"add:region",function(e,t){this[e]=t,this.triggerMethod("add:region",e,t)}),this.listenTo(this.regionManager,"before:remove:region",function(e){this.triggerMethod("before:remove:region",e)}),this.listenTo(this.regionManager,"remove:region",function(e,t){delete this[e],this.triggerMethod("remove:region",e,t)})},_getImmediateChildren:function(){return i.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),r.Behavior=r.Object.extend({constructor:function(e,t){this.view=t,this.defaults=i.result(this,"defaults")||{},this.options=i.extend({},this.defaults,e),this.ui=i.extend({},i.result(t,"ui"),i.result(this,"ui")),r.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(e){this.$el=e.$el,this.el=e.el}}),r.Behaviors=function(e,t){function i(e,n){return t.isObject(e.behaviors)?(n=i.parseBehaviors(e,n||t.result(e,"behaviors")),i.wrap(e,n,t.keys(s)),n):{}}function n(e,t){this._view=e,this._behaviors=t,this._triggers={}}function o(e){return e._uiBindings||e.ui}var r=/^(\S+)\s*(.*)$/,s={behaviorTriggers:function(e,t){var i=new n(this,t);return i.buildBehaviorTriggers()},behaviorEvents:function(i,n){var s={};return t.each(n,function(i,n){var a={},l=t.clone(t.result(i,"events"))||{};l=e.normalizeUIKeys(l,o(i));var c=0;t.each(l,function(e,o){var s=o.match(r),l=s[1]+"."+[this.cid,n,c++," "].join(""),u=s[2],d=l+u,h=t.isFunction(e)?e:i[e];h&&(a[d]=t.bind(h,i))},this),s=t.extend(s,a)},this),s}};return t.extend(i,{behaviorsLookup:function(){throw new e.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(t,n){return t.behaviorClass?t.behaviorClass:e._getValue(i.behaviorsLookup,this,[t,n])[n]},parseBehaviors:function(e,n){return t.chain(n).map(function(n,o){var r=i.getBehaviorClass(n,o),s=new r(n,e),a=i.parseBehaviors(e,t.result(s,"behaviors"));return[s].concat(a)}).flatten().value()},wrap:function(e,i,n){t.each(n,function(n){e[n]=t.partial(s[n],e[n],i)})}}),t.extend(n.prototype,{buildBehaviorTriggers:function(){return t.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(i,n){var r=t.clone(t.result(i,"triggers"))||{};r=e.normalizeUIKeys(r,o(i)),t.each(r,t.bind(this._setHandlerForBehavior,this,i,n))},_setHandlerForBehavior:function(e,t,i,n){var o=n.replace(/^\S+/,function(e){return e+".behaviortriggers"+t});this._triggers[o]=this._view._buildViewTrigger(i)}}),i}(r,i),r.AppRouter=t.Router.extend({constructor:function(e){this.options=e||{},t.Router.apply(this,arguments);var i=this.getOption("appRoutes"),n=this._getController();this.processAppRoutes(n,i),this.on("route",this._processOnRoute,this)},appRoute:function(e,t){var i=this._getController();this._addAppRoute(i,e,t)},_processOnRoute:function(e,t){if(i.isFunction(this.onRoute)){var n=i.invert(this.getOption("appRoutes"))[e];this.onRoute(e,n,t)}},processAppRoutes:function(e,t){if(t){var n=i.keys(t).reverse();i.each(n,function(i){this._addAppRoute(e,i,t[i])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(e,t,n){var o=e[n];if(!o)throw new r.Error('Method "'+n+'" was not found on the controller');this.route(t,n,i.bind(o,e))},mergeOptions:r.mergeOptions,getOption:r.proxyGetOption,triggerMethod:r.triggerMethod,bindEntityEvents:r.proxyBindEntityEvents,unbindEntityEvents:r.proxyUnbindEntityEvents}),r.Application=r.Object.extend({constructor:function(e){this._initializeRegions(e),this._initCallbacks=new r.Callbacks,this.submodules={},i.extend(this,e),this._initChannel(),r.Object.apply(this,arguments)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("before:start",e),this._initCallbacks.run(e,this),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(e){return this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},getRegions:function(){return this._regionManager.getRegions()},module:function(e,t){var n=r.Module.getClass(t),o=i.toArray(arguments);return o.unshift(this),n.create.apply(n,o)},getRegionManager:function(){return new r.RegionManager},_initializeRegions:function(e){var t=i.isFunction(this.regions)?this.regions(e):this.regions||{};this._initRegionManager();var n=r.getOption(e,"regions");return i.isFunction(n)&&(n=n.call(this,e)),i.extend(t,n),this.addRegions(t),this},_initRegionManager:function(){
this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",function(){r._triggerMethod(this,"before:add:region",arguments)}),this.listenTo(this._regionManager,"add:region",function(e,t){this[e]=t,r._triggerMethod(this,"add:region",arguments)}),this.listenTo(this._regionManager,"before:remove:region",function(){r._triggerMethod(this,"before:remove:region",arguments)}),this.listenTo(this._regionManager,"remove:region",function(e){delete this[e],r._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=i.result(this,"channelName")||"global",this.channel=i.result(this,"channel")||t.Wreqr.radio.channel(this.channelName),this.vent=i.result(this,"vent")||this.channel.vent,this.commands=i.result(this,"commands")||this.channel.commands,this.reqres=i.result(this,"reqres")||this.channel.reqres}}),r.Module=function(e,t,n){this.moduleName=e,this.options=i.extend({},this.options,n),this.initialize=n.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,i.isFunction(this.initialize)&&this.initialize(e,t,this.options)},r.Module.extend=r.extend,i.extend(r.Module.prototype,t.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){this._isInitialized||(i.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),i.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,n){if(e){var o=i.flatten([this,this.app,t,r,t.$,i,n]);e.apply(this,o)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new r.Callbacks,this._finalizerCallbacks=new r.Callbacks},triggerMethod:r.triggerMethod}),i.extend(r.Module,{create:function(e,t,n){var o=e,r=i.drop(arguments,3);t=t.split(".");var s=t.length,a=[];return a[s-1]=n,i.each(t,function(t,i){var s=o;o=this._getModule(s,t,e,n),this._addModuleDefinition(s,o,a[i],r)},this),o},_getModule:function(e,t,n,o){var r=i.extend({},o),s=this.getClass(o),a=e[t];return a||(a=new s(t,n,r),e[t]=a,e.submodules[t]=a),a},getClass:function(e){var t=r.Module;return e?e.prototype instanceof t?e:e.moduleClass||t:t},_addModuleDefinition:function(e,t,i,n){var o=this._getDefine(i),r=this._getStartWithParent(i,t);o&&t.addDefinition(o,n),this._addStartWithParent(e,t,r)},_getStartWithParent:function(e,t){var n;return i.isFunction(e)&&e.prototype instanceof r.Module?(n=t.constructor.prototype.startWithParent,!!i.isUndefined(n)||n):!i.isObject(e)||(n=e.startWithParent,!!i.isUndefined(n)||n)},_getDefine:function(e){return!i.isFunction(e)||e.prototype instanceof r.Module?i.isObject(e)?e.define:null:e},_addStartWithParent:function(e,t,i){t.startWithParent=t.startWithParent&&i,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}}),r}),function(){"use strict";function e(e,t,i){"addEventListener"in window?e.addEventListener(t,i,!1):"attachEvent"in window&&e.attachEvent("on"+t,i)}function t(e){return Z+"["+ee+"] "+e}function i(e){Q&&"object"==typeof window.console&&console.log(t(e))}function n(e){"object"==typeof window.console&&console.warn(t(e))}function o(){i("Initialising iFrame"),r(),l(),a("background",L),a("padding",U),f(),h(),c(),g(),p(),I("init","Init message from host page")}function r(){function e(e){return"true"===e}var t=G.substr(X).split(":");ee=t[0],z=void 0!==t[1]?Number(t[1]):z,N=void 0!==t[2]?e(t[2]):N,Q=void 0!==t[3]?e(t[3]):Q,K=void 0!==t[4]?Number(t[4]):K,te=void 0!==t[5]?e(t[5]):te,R=void 0!==t[6]?e(t[6]):R,B=t[7],$=void 0!==t[8]?t[8]:$,L=t[9],U=t[10],re=void 0!==t[11]?Number(t[11]):re}function s(e,t){return-1!==t.indexOf("-")&&(n("Negative CSS value ignored for "+e),t=""),t}function a(e,t){void 0!==t&&""!==t&&"null"!==t&&(document.body.style[e]=t,i("Body "+e+' set to "'+t+'"'))}function l(){void 0===B&&(B=z+"px"),s("margin",B),a("margin",B)}function c(){document.documentElement.style.height="",document.body.style.height="",i('HTML & body height set to "auto"')}function u(){e(window,"resize",function(){I("resize","Window resized")})}function d(){e(window,"click",function(){I("click","Window clicked")})}function h(){Y!==$&&($ in ce||(n($+" is not a valid option for heightCalculationMethod."),$="bodyScroll"),i('Height calculation method set to "'+$+'"'))}function p(){!0===R?(u(),d(),v()):i("Auto Resize disabled")}function f(){var e=document.createElement("div");e.style.clear="both",e.style.display="block",document.body.appendChild(e)}function g(){te&&(i("Enable public methods"),window.parentIFrame={close:function(){I("close","parentIFrame.close()",0,0)},getId:function(){return ee},reset:function(){E("parentIFrame.size")},scrollTo:function(e,t){A(t,e,"scrollTo")},scrollToOffset:function(e,t){A(t,e,"scrollToOffset")},sendMessage:function(e,t){A(0,0,"message",JSON.stringify(e),t)},setHeightCalculationMethod:function(e){$=e,h()},setTargetOrigin:function(e){i("Set targetOrigin: "+e),ne=e},size:function(e,t){var i=""+(e?e:"")+(t?","+t:"");O(),I("size","parentIFrame.size("+i+")",e,t)}})}function m(){0!==K&&(i("setInterval: "+K+"ms"),setInterval(function(){I("interval","setInterval: "+K)},Math.abs(K)))}function _(t){function n(t){void 0!==t.height&&void 0!==t.width&&0!==t.height&&0!==t.width||(i("Attach listerner to "+t.src),e(t,"load",function(){I("imageLoad","Image loaded")}))}t.forEach(function(e){if("attributes"===e.type&&"src"===e.attributeName)n(e.target);else if("childList"===e.type){var t=e.target.querySelectorAll("img");Array.prototype.forEach.call(t,function(e){n(e)})}})}function v(){function e(){var e=document.querySelector("body"),n={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},o=new t(function(e){I("mutationObserver","mutationObserver: "+e[0].target+" "+e[0].type),_(e)});i("Enable MutationObserver"),o.observe(e,n)}var t=window.MutationObserver||window.WebKitMutationObserver;t?0>K?m():e():(n("MutationObserver not supported in this browser!"),m())}function y(){function e(e){function t(e){var t=/^\d+(px)?$/i;if(t.test(e))return parseInt(e,D);var n=i.style.left,o=i.runtimeStyle.left;return i.runtimeStyle.left=i.currentStyle.left,i.style.left=e||0,e=i.style.pixelLeft,i.style.left=n,i.runtimeStyle.left=o,e}var i=document.body,n=0;return"defaultView"in document&&"getComputedStyle"in document.defaultView?(n=document.defaultView.getComputedStyle(i,null),n=null!==n?n[e]:0):n=t(i.currentStyle[e]),parseInt(n,D)}return document.body.offsetHeight+e("marginTop")+e("marginBottom")}function w(){return document.body.scrollHeight}function b(){return document.documentElement.offsetHeight}function x(){return document.documentElement.scrollHeight}function k(){for(var e=document.querySelectorAll("body *"),t=e.length,n=0,o=(new Date).getTime(),r=0;r<t;r++)e[r].getBoundingClientRect().bottom>n&&(n=e[r].getBoundingClientRect().bottom);return o=(new Date).getTime()-o,i("Parsed "+t+" HTML elements"),i("LowestElement bottom position calculated in "+o+"ms"),n}function C(){return[y(),w(),b(),x()]}function M(){return Math.max.apply(null,C())}function S(){return Math.min.apply(null,C())}function P(){return Math.max(y(),k())}function T(){return Math.max(document.documentElement.scrollWidth,document.body.scrollWidth)}function I(e,t,n,o){function r(){e in{reset:1,resetPage:1,init:1}||i("Trigger event: "+t)}function s(){j=p,le=f,A(j,le,e)}function a(){return se&&e in q}function l(){function e(e,t){var i=Math.abs(e-t)<=re;return!i}return p=void 0!==n?n:ce[$](),f=void 0!==o?o:T(),e(j,p)||N&&e(le,f)}function c(){return!(e in{init:1,interval:1,size:1})}function u(){return $ in ie}function d(){i("No change in size detected")}function h(){c()&&u()?E(t):e in{interval:1}||(r(),d())}var p,f;a()?i("Trigger event cancelled: "+e):l()?(r(),O(),s()):h()}function O(){se||(se=!0,i("Trigger event lock on")),clearTimeout(ae),ae=setTimeout(function(){se=!1,i("Trigger event lock off"),i("--")},H)}function F(e){j=ce[$](),le=T(),A(j,le,e)}function E(e){var t=$;$=Y,i("Reset trigger event: "+e),O(),F("reset"),$=t}function A(e,t,n,o,r){function s(){void 0===r?r=ne:i("Message targetOrigin: "+r)}function a(){var s=e+":"+t,a=ee+":"+s+":"+n+(void 0!==o?":"+o:"");i("Sending message to host page ("+a+")"),oe.postMessage(Z+a,r)}s(),a()}function V(e){function t(){return Z===(""+e.data).substr(0,X)}function r(){G=e.data,oe=e.source,o(),W=!1,setTimeout(function(){J=!1},H)}function s(){J?i("Page reset ignored by init"):(i("Page size reset by host page"),F("resetPage"))}function a(){return e.data.split("]")[1]}function l(){return"iFrameResize"in window}function c(){return e.data.split(":")[2]in{"true":1,"false":1}}t()&&(W&&c()?r():"reset"===a()?s():e.data===G||l()||n("Unexpected message ("+e.data+")"))}var R=!0,D=10,L="",z=0,B="",U="",N=!1,q={resize:1,click:1},H=128,j=1,W=!0,Y="offset",$=Y,J=!0,G="",K=32,Q=!1,Z="[iFrameSizer]",X=Z.length,ee="",te=!1,ie={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},ne="*",oe=window.parent,re=0,se=!1,ae=null,le=1,ce={offset:y,bodyOffset:y,bodyScroll:w,documentElementOffset:b,scroll:x,documentElementScroll:x,max:M,min:S,grow:M,lowestElement:P};e(window,"message",V)}(),function(){var e={};"undefined"!=typeof exports?e=exports:"function"==typeof define?define(function(){return e}):this.Cocktail=e,e.mixins={},e.mixin=function(t){var i=_.chain(arguments).toArray().rest().flatten().value(),n=t.prototype||t,o={};_(i).each(function(t){_.isString(t)&&(t=e.mixins[t]),_(t).each(function(e,t){if(_.isFunction(e)){if(n[t]===e)return;n[t]&&(o[t]=o[t]||[n[t]],o[t].push(e)),n[t]=e}else _.isArray(e)?n[t]=_.union(e,n[t]||[]):_.isObject(e)?n[t]=_.extend({},e,n[t]||{}):t in n||(n[t]=e)})}),_(o).each(function(e,t){n[t]=function(){var t,i=this,n=arguments;return _(e).each(function(e){var o=_.isFunction(e)?e.apply(i,n):e;t="undefined"==typeof o?t:o}),t}})};var t;e.patch=function(i){t=i.Model.extend;var n=function(i,n){var o=t.call(this,i,n),r=o.prototype.mixins;return r&&o.prototype.hasOwnProperty("mixins")&&e.mixin(o,r),o};_([i.Model,i.Collection,i.Router,i.View]).each(function(t){t.mixin=function(){e.mixin(this,_.toArray(arguments))},t.extend=n})},e.unpatch=function(e){_([e.Model,e.Collection,e.Router,e.View]).each(function(e){e.mixin=void 0,e.extend=t})}}(),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,t,i,n,o){return jQuery.easing[jQuery.easing.def](e,t,i,n,o)},easeInQuad:function(e,t,i,n,o){return n*(t/=o)*t+i},easeOutQuad:function(e,t,i,n,o){return-n*(t/=o)*(t-2)+i},easeInOutQuad:function(e,t,i,n,o){return(t/=o/2)<1?n/2*t*t+i:-n/2*(--t*(t-2)-1)+i},easeInCubic:function(e,t,i,n,o){return n*(t/=o)*t*t+i},easeOutCubic:function(e,t,i,n,o){return n*((t=t/o-1)*t*t+1)+i},easeInOutCubic:function(e,t,i,n,o){return(t/=o/2)<1?n/2*t*t*t+i:n/2*((t-=2)*t*t+2)+i},easeInQuart:function(e,t,i,n,o){return n*(t/=o)*t*t*t+i},easeOutQuart:function(e,t,i,n,o){return-n*((t=t/o-1)*t*t*t-1)+i},easeInOutQuart:function(e,t,i,n,o){return(t/=o/2)<1?n/2*t*t*t*t+i:-n/2*((t-=2)*t*t*t-2)+i},easeInQuint:function(e,t,i,n,o){return n*(t/=o)*t*t*t*t+i},easeOutQuint:function(e,t,i,n,o){return n*((t=t/o-1)*t*t*t*t+1)+i},easeInOutQuint:function(e,t,i,n,o){return(t/=o/2)<1?n/2*t*t*t*t*t+i:n/2*((t-=2)*t*t*t*t+2)+i},easeInSine:function(e,t,i,n,o){return-n*Math.cos(t/o*(Math.PI/2))+n+i},easeOutSine:function(e,t,i,n,o){return n*Math.sin(t/o*(Math.PI/2))+i},easeInOutSine:function(e,t,i,n,o){return-n/2*(Math.cos(Math.PI*t/o)-1)+i},easeInExpo:function(e,t,i,n,o){return 0==t?i:n*Math.pow(2,10*(t/o-1))+i},easeOutExpo:function(e,t,i,n,o){return t==o?i+n:n*(-Math.pow(2,-10*t/o)+1)+i},easeInOutExpo:function(e,t,i,n,o){return 0==t?i:t==o?i+n:(t/=o/2)<1?n/2*Math.pow(2,10*(t-1))+i:n/2*(-Math.pow(2,-10*--t)+2)+i},easeInCirc:function(e,t,i,n,o){return-n*(Math.sqrt(1-(t/=o)*t)-1)+i},easeOutCirc:function(e,t,i,n,o){return n*Math.sqrt(1-(t=t/o-1)*t)+i},easeInOutCirc:function(e,t,i,n,o){return(t/=o/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+i:n/2*(Math.sqrt(1-(t-=2)*t)+1)+i},easeInElastic:function(e,t,i,n,o){var r=1.70158,s=0,a=n;if(0==t)return i;if(1==(t/=o))return i+n;if(s||(s=.3*o),a<Math.abs(n)){a=n;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(n/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*o-r)*(2*Math.PI)/s))+i},easeOutElastic:function(e,t,i,n,o){var r=1.70158,s=0,a=n;if(0==t)return i;if(1==(t/=o))return i+n;if(s||(s=.3*o),a<Math.abs(n)){a=n;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(n/a);return a*Math.pow(2,-10*t)*Math.sin((t*o-r)*(2*Math.PI)/s)+n+i},easeInOutElastic:function(e,t,i,n,o){var r=1.70158,s=0,a=n;if(0==t)return i;if(2==(t/=o/2))return i+n;if(s||(s=o*(.3*1.5)),a<Math.abs(n)){a=n;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(n/a);return t<1?-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*o-r)*(2*Math.PI)/s))+i:a*Math.pow(2,-10*(t-=1))*Math.sin((t*o-r)*(2*Math.PI)/s)*.5+n+i},easeInBack:function(e,t,i,n,o,r){return void 0==r&&(r=1.70158),n*(t/=o)*t*((r+1)*t-r)+i},easeOutBack:function(e,t,i,n,o,r){return void 0==r&&(r=1.70158),n*((t=t/o-1)*t*((r+1)*t+r)+1)+i},easeInOutBack:function(e,t,i,n,o,r){return void 0==r&&(r=1.70158),(t/=o/2)<1?n/2*(t*t*(((r*=1.525)+1)*t-r))+i:n/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+i},easeInBounce:function(e,t,i,n,o){return n-jQuery.easing.easeOutBounce(e,o-t,0,n,o)+i},easeOutBounce:function(e,t,i,n,o){return(t/=o)<1/2.75?n*(7.5625*t*t)+i:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+i:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+i:n*(7.5625*(t-=2.625/2.75)*t+.984375)+i},easeInOutBounce:function(e,t,i,n,o){return t<o/2?.5*jQuery.easing.easeInBounce(e,2*t,0,n,o)+i:.5*jQuery.easing.easeOutBounce(e,2*t-o,0,n,o)+.5*n+i}}),function(e){function t(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function i(e,t){return function(i){return u(e.call(this,i),t)}}function n(e,t){return function(i){return this.lang().ordinal(e.call(this,i),t)}}function o(){}function r(e){x(e),a(this,e)}function s(e){var t=m(e),i=t.year||0,n=t.month||0,o=t.week||0,r=t.day||0,s=t.hour||0,a=t.minute||0,l=t.second||0,c=t.millisecond||0;this._milliseconds=+c+1e3*l+6e4*a+36e5*s,this._days=+r+7*o,this._months=+n+12*i,this._data={},this._bubble()}function a(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function l(e){var t,i={};for(t in e)e.hasOwnProperty(t)&&me.hasOwnProperty(t)&&(i[t]=e[t]);return i}function c(e){return e<0?Math.ceil(e):Math.floor(e)}function u(e,t,i){for(var n=""+Math.abs(e),o=e>=0;n.length<t;)n="0"+n;return(o?i?"+":"":"-")+n}function d(e,t,i,n){var o,r,s=t._milliseconds,a=t._days,l=t._months;s&&e._d.setTime(+e._d+s*i),(a||l)&&(o=e.minute(),r=e.hour()),a&&e.date(e.date()+a*i),l&&e.month(e.month()+l*i),s&&!n&&ne.updateOffset(e),(a||l)&&(e.minute(o),e.hour(r))}function h(e){return"[object Array]"===Object.prototype.toString.call(e)}function p(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function f(e,t,i){var n,o=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),s=0;for(n=0;n<o;n++)(i&&e[n]!==t[n]||!i&&v(e[n])!==v(t[n]))&&s++;return s+r}function g(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=We[e]||Ye[t]||t}return e}function m(e){var t,i,n={};for(i in e)e.hasOwnProperty(i)&&(t=g(i),t&&(n[t]=e[i]));return n}function _(t){var i,n;if(0===t.indexOf("week"))i=7,n="day";else{if(0!==t.indexOf("month"))return;i=12,n="month"}ne[t]=function(o,r){var s,a,l=ne.fn._lang[t],c=[];if("number"==typeof o&&(r=o,o=e),a=function(e){var t=ne().utc().set(n,e);return l.call(ne.fn._lang,t,o||"")},null!=r)return a(r);for(s=0;s<i;s++)c.push(a(s));return c}}function v(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=t>=0?Math.floor(t):Math.ceil(t)),i}function y(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function w(e){return b(e)?366:365}function b(e){return e%4===0&&e%100!==0||e%400===0}function x(e){var t;e._a&&e._pf.overflow===-2&&(t=e._a[ce]<0||e._a[ce]>11?ce:e._a[ue]<1||e._a[ue]>y(e._a[le],e._a[ce])?ue:e._a[de]<0||e._a[de]>23?de:e._a[he]<0||e._a[he]>59?he:e._a[pe]<0||e._a[pe]>59?pe:e._a[fe]<0||e._a[fe]>999?fe:-1,e._pf._overflowDayOfYear&&(t<le||t>ue)&&(t=ue),e._pf.overflow=t)}function k(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function C(e){return e?e.toLowerCase().replace("_","-"):e}function M(e,t){return t._isUTC?ne(e).zone(t._offset||0):ne(e).local()}function S(e,t){return t.abbr=e,ge[e]||(ge[e]=new o),ge[e].set(t),ge[e]}function P(e){delete ge[e]}function T(e){var t,i,n,o,r=0,s=function(e){if(!ge[e]&&_e)try{require("./lang/"+e)}catch(e){}return ge[e]};if(!e)return ne.fn._lang;if(!h(e)){if(i=s(e))return i;e=[e]}for(;r<e.length;){for(o=C(e[r]).split("-"),t=o.length,n=C(e[r+1]),n=n?n.split("-"):null;t>0;){if(i=s(o.slice(0,t).join("-")))return i;if(n&&n.length>=t&&f(o,n,!0)>=t-1)break;t--}r++}return ne.fn._lang}function I(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function O(e){var t,i,n=e.match(be);for(t=0,i=n.length;t<i;t++)Ke[n[t]]?n[t]=Ke[n[t]]:n[t]=I(n[t]);return function(o){var r="";for(t=0;t<i;t++)r+=n[t]instanceof Function?n[t].call(o,e):n[t];return r}}function F(e,t){return e.isValid()?(t=E(t,e.lang()),$e[t]||($e[t]=O(t)),$e[t](e)):e.lang().invalidDate()}function E(e,t){function i(e){return t.longDateFormat(e)||e}var n=5;for(xe.lastIndex=0;n>=0&&xe.test(e);)e=e.replace(xe,i),xe.lastIndex=0,n-=1;return e}function A(e,t){var i,n=t._strict;switch(e){case"DDDD":return Ve;case"YYYY":case"GGGG":case"gggg":return n?Re:Me;case"Y":case"G":case"g":return Le;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return n?De:Se;case"S":if(n)return Ee;case"SS":if(n)return Ae;case"SSS":if(n)return Ve;case"DDD":return Ce;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Te;case"a":case"A":return T(t._l)._meridiemParse;case"X":return Fe;case"Z":case"ZZ":return Ie;case"T":return Oe;case"SSSS":return Pe;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return n?Ae:ke;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return ke;default:return i=new RegExp(N(U(e.replace("\\","")),"i"))}}function V(e){e=e||"";var t=e.match(Ie)||[],i=t[t.length-1]||[],n=(i+"").match(qe)||["-",0,0],o=+(60*n[1])+v(n[2]);return"+"===n[0]?-o:o}function R(e,t,i){var n,o=i._a;switch(e){case"M":case"MM":null!=t&&(o[ce]=v(t)-1);break;case"MMM":case"MMMM":n=T(i._l).monthsParse(t),null!=n?o[ce]=n:i._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(o[ue]=v(t));break;case"DDD":case"DDDD":null!=t&&(i._dayOfYear=v(t));break;case"YY":o[le]=v(t)+(v(t)>68?1900:2e3);break;case"YYYY":case"YYYYY":case"YYYYYY":o[le]=v(t);break;case"a":case"A":i._isPm=T(i._l).isPM(t);break;case"H":case"HH":case"h":case"hh":o[de]=v(t);break;case"m":case"mm":o[he]=v(t);break;case"s":case"ss":o[pe]=v(t);break;case"S":case"SS":case"SSS":case"SSSS":o[fe]=v(1e3*("0."+t));break;case"X":i._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":i._useUTC=!0,i._tzm=V(t);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":e=e.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(i._w=i._w||{},i._w[e]=t)}}function D(e){var t,i,n,o,r,s,a,l,c,u,d=[];if(!e._d){for(n=z(e),e._w&&null==e._a[ue]&&null==e._a[ce]&&(r=function(t){var i=parseInt(t,10);return t?t.length<3?i>68?1900+i:2e3+i:i:null==e._a[le]?ne().weekYear():e._a[le]},s=e._w,null!=s.GG||null!=s.W||null!=s.E?a=Q(r(s.GG),s.W||1,s.E,4,1):(l=T(e._l),c=null!=s.d?$(s.d,l):null!=s.e?parseInt(s.e,10)+l._week.dow:0,u=parseInt(s.w,10)||1,null!=s.d&&c<l._week.dow&&u++,a=Q(r(s.gg),u,c,l._week.doy,l._week.dow)),e._a[le]=a.year,e._dayOfYear=a.dayOfYear),e._dayOfYear&&(o=null==e._a[le]?n[le]:e._a[le],e._dayOfYear>w(o)&&(e._pf._overflowDayOfYear=!0),i=Y(o,0,e._dayOfYear),e._a[ce]=i.getUTCMonth(),e._a[ue]=i.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=d[t]=n[t];for(;t<7;t++)e._a[t]=d[t]=null==e._a[t]?2===t?1:0:e._a[t];d[de]+=v((e._tzm||0)/60),d[he]+=v((e._tzm||0)%60),e._d=(e._useUTC?Y:W).apply(null,d)}}function L(e){var t;e._d||(t=m(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],D(e))}function z(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function B(e){e._a=[],e._pf.empty=!0;var t,i,n,o,r,s=T(e._l),a=""+e._i,l=a.length,c=0;for(n=E(e._f,s).match(be)||[],t=0;t<n.length;t++)o=n[t],i=(a.match(A(o,e))||[])[0],i&&(r=a.substr(0,a.indexOf(i)),r.length>0&&e._pf.unusedInput.push(r),a=a.slice(a.indexOf(i)+i.length),c+=i.length),Ke[o]?(i?e._pf.empty=!1:e._pf.unusedTokens.push(o),R(o,i,e)):e._strict&&!i&&e._pf.unusedTokens.push(o);e._pf.charsLeftOver=l-c,a.length>0&&e._pf.unusedInput.push(a),e._isPm&&e._a[de]<12&&(e._a[de]+=12),e._isPm===!1&&12===e._a[de]&&(e._a[de]=0),D(e),x(e)}function U(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,o){return t||i||n||o})}function N(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function q(e){var i,n,o,r,s;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(NaN));for(r=0;r<e._f.length;r++)s=0,i=a({},e),i._pf=t(),i._f=e._f[r],B(i),k(i)&&(s+=i._pf.charsLeftOver,s+=10*i._pf.unusedTokens.length,i._pf.score=s,(null==o||s<o)&&(o=s,n=i));a(e,n||i)}function H(e){var t,i,n=e._i,o=ze.exec(n);if(o){for(e._pf.iso=!0,t=0,i=Ue.length;t<i;t++)if(Ue[t][1].exec(n)){e._f=Ue[t][0]+(o[6]||" ");break}for(t=0,i=Ne.length;t<i;t++)if(Ne[t][1].exec(n)){e._f+=Ne[t][0];break}n.match(Ie)&&(e._f+="Z"),B(e)}else e._d=new Date(n)}function j(t){var i=t._i,n=ve.exec(i);i===e?t._d=new Date:n?t._d=new Date(+n[1]):"string"==typeof i?H(t):h(i)?(t._a=i.slice(0),D(t)):p(i)?t._d=new Date(+i):"object"==typeof i?L(t):t._d=new Date(i)}function W(e,t,i,n,o,r,s){var a=new Date(e,t,i,n,o,r,s);return e<1970&&a.setFullYear(e),a}function Y(e){var t=new Date(Date.UTC.apply(null,arguments));return e<1970&&t.setUTCFullYear(e),t}function $(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function J(e,t,i,n,o){return o.relativeTime(t||1,!!i,e,n)}function G(e,t,i){var n=ae(Math.abs(e)/1e3),o=ae(n/60),r=ae(o/60),s=ae(r/24),a=ae(s/365),l=n<45&&["s",n]||1===o&&["m"]||o<45&&["mm",o]||1===r&&["h"]||r<22&&["hh",r]||1===s&&["d"]||s<=25&&["dd",s]||s<=45&&["M"]||s<345&&["MM",ae(s/30)]||1===a&&["y"]||["yy",a];return l[2]=t,l[3]=e>0,l[4]=i,J.apply({},l)}function K(e,t,i){var n,o=i-t,r=i-e.day();return r>o&&(r-=7),r<o-7&&(r+=7),n=ne(e).add("d",r),{week:Math.ceil(n.dayOfYear()/7),year:n.year()}}function Q(e,t,i,n,o){var r,s,a=Y(e,0,1).getUTCDay();return i=null!=i?i:o,r=o-a+(a>n?7:0)-(a<o?7:0),s=7*(t-1)+(i-o)+r+1,{year:s>0?e:e-1,dayOfYear:s>0?s:w(e-1)+s}}function Z(e){var t=e._i,i=e._f;return null===t?ne.invalid({nullInput:!0}):("string"==typeof t&&(e._i=t=T().preparse(t)),ne.isMoment(t)?(e=l(t),e._d=new Date(+t._d)):i?h(i)?q(e):B(e):j(e),new r(e))}function X(e,t){ne.fn[e]=ne.fn[e+"s"]=function(e){var i=this._isUTC?"UTC":"";return null!=e?(this._d["set"+i+t](e),ne.updateOffset(this),this):this._d["get"+i+t]()}}function ee(e){ne.duration.fn[e]=function(){return this._data[e]}}function te(e,t){ne.duration.fn["as"+e]=function(){return+this/t}}function ie(e){var t=!1,i=ne;"undefined"==typeof ender&&(e?(se.moment=function(){return!t&&console&&console.warn&&(t=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),i.apply(null,arguments)},a(se.moment,i)):se.moment=ne)}for(var ne,oe,re="2.5.1",se=this,ae=Math.round,le=0,ce=1,ue=2,de=3,he=4,pe=5,fe=6,ge={},me={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},_e="undefined"!=typeof module&&module.exports&&"undefined"!=typeof require,ve=/^\/?Date\((\-?\d+)/i,ye=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,we=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,be=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,xe=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,ke=/\d\d?/,Ce=/\d{1,3}/,Me=/\d{1,4}/,Se=/[+\-]?\d{1,6}/,Pe=/\d+/,Te=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ie=/Z|[\+\-]\d\d:?\d\d/gi,Oe=/T/i,Fe=/[\+\-]?\d+(\.\d{1,3})?/,Ee=/\d/,Ae=/\d\d/,Ve=/\d{3}/,Re=/\d{4}/,De=/[+-]?\d{6}/,Le=/[+-]?\d+/,ze=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Be="YYYY-MM-DDTHH:mm:ssZ",Ue=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],Ne=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],qe=/([\+\-]|\d\d)/gi,He="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),je={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},We={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Ye={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},$e={},Je="DDD w W M D d".split(" "),Ge="M D H h m s w W".split(" "),Ke={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return u(this.year()%100,2)},YYYY:function(){return u(this.year(),4)},YYYYY:function(){return u(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+u(Math.abs(e),6)},gg:function(){return u(this.weekYear()%100,2)},gggg:function(){return u(this.weekYear(),4)},ggggg:function(){return u(this.weekYear(),5)},GG:function(){return u(this.isoWeekYear()%100,2)},GGGG:function(){return u(this.isoWeekYear(),4)},GGGGG:function(){return u(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return v(this.milliseconds()/100)},SS:function(){return u(v(this.milliseconds()/10),2)},SSS:function(){return u(this.milliseconds(),3)},SSSS:function(){return u(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+u(v(e/60),2)+":"+u(v(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+u(v(e/60),2)+u(v(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},Qe=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Je.length;)oe=Je.pop(),Ke[oe+"o"]=n(Ke[oe],oe);for(;Ge.length;)oe=Ge.pop(),Ke[oe+oe]=i(Ke[oe],2);for(Ke.DDDD=i(Ke.DDD,3),a(o.prototype,{set:function(e){var t,i;for(i in e)t=e[i],"function"==typeof t?this[i]=t:this["_"+i]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,i,n;for(this._monthsParse||(this._monthsParse=[]),t=0;t<12;t++)if(this._monthsParse[t]||(i=ne.utc([2e3,t]),n="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[t]=new RegExp(n.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,i,n;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;t<7;t++)if(this._weekdaysParse[t]||(i=ne([2e3,1]).day(t),n="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[t]=new RegExp(n.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var i=this._calendar[e];return"function"==typeof i?i.apply(t):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,i,n){var o=this._relativeTime[i];return"function"==typeof o?o(e,t,i,n):o.replace(/%d/i,e)},pastFuture:function(e,t){var i=this._relativeTime[e>0?"future":"past"];return"function"==typeof i?i(t):i.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return K(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),ne=function(i,n,o,r){var s;return"boolean"==typeof o&&(r=o,o=e),s={},s._isAMomentObject=!0,s._i=i,s._f=n,s._l=o,s._strict=r,s._isUTC=!1,s._pf=t(),Z(s)},ne.utc=function(i,n,o,r){var s;return"boolean"==typeof o&&(r=o,o=e),s={},s._isAMomentObject=!0,s._useUTC=!0,s._isUTC=!0,s._l=o,s._i=i,s._f=n,s._strict=r,s._pf=t(),Z(s).utc()},ne.unix=function(e){return ne(1e3*e)},ne.duration=function(e,t){var i,n,o,r=e,a=null;return ne.isDuration(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(r={},t?r[t]=e:r.milliseconds=e):(a=ye.exec(e))?(i="-"===a[1]?-1:1,r={y:0,d:v(a[ue])*i,h:v(a[de])*i,m:v(a[he])*i,s:v(a[pe])*i,ms:v(a[fe])*i}):(a=we.exec(e))&&(i="-"===a[1]?-1:1,o=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*i},r={y:o(a[2]),M:o(a[3]),d:o(a[4]),h:o(a[5]),m:o(a[6]),s:o(a[7]),w:o(a[8])}),n=new s(r),ne.isDuration(e)&&e.hasOwnProperty("_lang")&&(n._lang=e._lang),n},ne.version=re,ne.defaultFormat=Be,ne.updateOffset=function(){},ne.lang=function(e,t){var i;return e?(t?S(C(e),t):null===t?(P(e),e="en"):ge[e]||T(e),i=ne.duration.fn._lang=ne.fn._lang=T(e),i._abbr):ne.fn._lang._abbr},ne.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),T(e)},ne.isMoment=function(e){return e instanceof r||null!=e&&e.hasOwnProperty("_isAMomentObject")},ne.isDuration=function(e){return e instanceof s},oe=Qe.length-1;oe>=0;--oe)_(Qe[oe]);for(ne.normalizeUnits=function(e){return g(e)},ne.invalid=function(e){var t=ne.utc(NaN);return null!=e?a(t._pf,e):t._pf.userInvalidated=!0,
t},ne.parseZone=function(e){return ne(e).parseZone()},a(ne.fn=r.prototype,{clone:function(){return ne(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=ne(this).utc();return 0<e.year()&&e.year()<=9999?F(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):F(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return k(this)},isDSTShifted:function(){return!!this._a&&(this.isValid()&&f(this._a,(this._isUTC?ne.utc(this._a):ne(this._a)).toArray())>0)},parsingFlags:function(){return a({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=F(this,e||ne.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var i;return i="string"==typeof e?ne.duration(+t,e):ne.duration(e,t),d(this,i,1),this},subtract:function(e,t){var i;return i="string"==typeof e?ne.duration(+t,e):ne.duration(e,t),d(this,i,-1),this},diff:function(e,t,i){var n,o,r=M(e,this),s=6e4*(this.zone()-r.zone());return t=g(t),"year"===t||"month"===t?(n=432e5*(this.daysInMonth()+r.daysInMonth()),o=12*(this.year()-r.year())+(this.month()-r.month()),o+=(this-ne(this).startOf("month")-(r-ne(r).startOf("month")))/n,o-=6e4*(this.zone()-ne(this).startOf("month").zone()-(r.zone()-ne(r).startOf("month").zone()))/n,"year"===t&&(o/=12)):(n=this-r,o="second"===t?n/1e3:"minute"===t?n/6e4:"hour"===t?n/36e5:"day"===t?(n-s)/864e5:"week"===t?(n-s)/6048e5:n),i?o:c(o)},from:function(e,t){return ne.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(ne(),e)},calendar:function(){var e=M(ne(),this).startOf("day"),t=this.diff(e,"days",!0),i=t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(i,this))},isLeapYear:function(){return b(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=$(e,this.lang()),this.add({d:e-t})):t},month:function(e){var t,i=this._isUTC?"UTC":"";return null!=e?"string"==typeof e&&(e=this.lang().monthsParse(e),"number"!=typeof e)?this:(t=this.date(),this.date(1),this._d["set"+i+"Month"](e),this.date(Math.min(t,this.daysInMonth())),ne.updateOffset(this),this):this._d["get"+i+"Month"]()},startOf:function(e){switch(e=g(e)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),this},endOf:function(e){return e=g(e),this.startOf(e).add("isoWeek"===e?"week":e,1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+ne(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+ne(e).startOf(t)},isSame:function(e,t){return t=t||"ms",+this.clone().startOf(t)===+M(e,this).startOf(t)},min:function(e){return e=ne.apply(null,arguments),e<this?this:e},max:function(e){return e=ne.apply(null,arguments),e>this?this:e},zone:function(e){var t=this._offset||0;return null==e?this._isUTC?t:this._d.getTimezoneOffset():("string"==typeof e&&(e=V(e)),Math.abs(e)<16&&(e*=60),this._offset=e,this._isUTC=!0,t!==e&&d(this,ne.duration(t-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?ne(e).zone():0,(this.zone()-e)%60===0},daysInMonth:function(){return y(this.year(),this.month())},dayOfYear:function(e){var t=ae((ne(this).startOf("day")-ne(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(e){var t=K(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=K(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=K(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this.day()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},get:function(e){return e=g(e),this[e]()},set:function(e,t){return e=g(e),"function"==typeof this[e]&&this[e](t),this},lang:function(t){return t===e?this._lang:(this._lang=T(t),this)}}),oe=0;oe<He.length;oe++)X(He[oe].toLowerCase().replace(/s$/,""),He[oe]);X("year","FullYear"),ne.fn.days=ne.fn.day,ne.fn.months=ne.fn.month,ne.fn.weeks=ne.fn.week,ne.fn.isoWeeks=ne.fn.isoWeek,ne.fn.toJSON=ne.fn.toISOString,a(ne.duration.fn=s.prototype,{_bubble:function(){var e,t,i,n,o=this._milliseconds,r=this._days,s=this._months,a=this._data;a.milliseconds=o%1e3,e=c(o/1e3),a.seconds=e%60,t=c(e/60),a.minutes=t%60,i=c(t/60),a.hours=i%24,r+=c(i/24),a.days=r%30,s+=c(r/30),a.months=s%12,n=c(s/12),a.years=n},weeks:function(){return c(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*v(this._months/12)},humanize:function(e){var t=+this,i=G(t,!e,this.lang());return e&&(i=this.lang().pastFuture(t,i)),this.lang().postformat(i)},add:function(e,t){var i=ne.duration(e,t);return this._milliseconds+=i._milliseconds,this._days+=i._days,this._months+=i._months,this._bubble(),this},subtract:function(e,t){var i=ne.duration(e,t);return this._milliseconds-=i._milliseconds,this._days-=i._days,this._months-=i._months,this._bubble(),this},get:function(e){return e=g(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=g(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:ne.fn.lang,toIsoString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),i=Math.abs(this.days()),n=Math.abs(this.hours()),o=Math.abs(this.minutes()),r=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(i?i+"D":"")+(n||o||r?"T":"")+(n?n+"H":"")+(o?o+"M":"")+(r?r+"S":""):"P0D"}});for(oe in je)je.hasOwnProperty(oe)&&(te(oe,je[oe]),ee(oe.toLowerCase()));te("Weeks",6048e5),ne.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},ne.lang("en",{ordinal:function(e){var t=e%10,i=1===v(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}}),_e?(module.exports=ne,ie(!0)):"function"==typeof define&&define.amd?define("moment",function(t,i,n){return n.config&&n.config()&&n.config().noGlobal!==!0&&ie(n.config().noGlobal===e),ne}):ie()}.call(this),function(){var e={prefix:"",format:""},t={serialize:function(e){if(null===e)return"";var t=[];for(prop in e)if(e[prop])if(e[prop]instanceof Array)for(var i=0;i<e[prop].length;i++)key=prop+encodeURIComponent("[]"),t.push(key+"="+encodeURIComponent(e[prop][i].toString()));else t.push(prop+"="+encodeURIComponent(e[prop].toString()));return 0===t.length?"":"?"+t.join("&")},clean_path:function(e){return e.replace(/\/+/g,"/").replace(/[\)\(]/g,"").replace(/\.$/m,"").replace(/\/$/m,"")},extract:function(t,i){var n=void 0;return i.hasOwnProperty(t)?(n=i[t],delete i[t]):e.hasOwnProperty(t)&&(n=e[t]),n},extract_format:function(t){var i=t.hasOwnProperty("format")?t.format:e.format;return delete t.format,i?"."+i:""},extract_anchor:function(e){var t=e.hasOwnProperty("anchor")?e.anchor:null;return delete e.anchor,t?"#"+t:""},extract_options:function(e,t){return t.length>e&&"object"==typeof t[t.length-1]?t.pop():{}},path_identifier:function(e){return e?"object"==typeof e?("function"==typeof e.to_param&&e.to_param()||e.to_param||e.id||e).toString():e.toString():""},build_path:function(e,i,n,o){o=Array.prototype.slice.call(o);var r=t.get_prefix(),s=t.extract_options(e,o);if(o.length>e)throw new Error("Too many parameters provided for path");for(var a=0,l=0,c=0;c<i.length;c++){var u=i[c];if(t.optional_part(u)){var d=n[l];l++;var h=t.extract(d,s);t.specified(h)&&(r+=u,r+=t.path_identifier(h))}else if(r+=u,a<e){a++;var p=o.shift();if(!t.specified(p))throw new Error("Insufficient parameters to build path");r+=t.path_identifier(p)}}var f=t.extract_format(s),g=t.extract_anchor(s);return t.clean_path(r+f+g)+t.serialize(s)},specified:function(e){return!(void 0===e||null===e)},optional_part:function(e){return e.match(/\(/)},get_prefix:function(){var t=e.prefix;return""!==t&&(t=t.match("/$")?t:t+"/"),t}};window.Routes={jammit_path:function(){return t.build_path(2,["/assets/","."],["format"],arguments)},resque_path:function(){return t.build_path(0,["/resque"],[],arguments)},v2_album_scheduled_events_path:function(){return t.build_path(1,["/v2/albums/","/scheduled_events"],["format"],arguments)},csv_import_v2_albums_path:function(){return t.build_path(0,["/v2/albums/csv_import"],["format"],arguments)},v2_albums_path:function(){return t.build_path(0,["/v2/albums"],["format"],arguments)},new_v2_album_path:function(){return t.build_path(0,["/v2/albums/new"],["format"],arguments)},edit_v2_album_path:function(){return t.build_path(1,["/v2/albums/","/edit"],["format"],arguments)},v2_album_path:function(){return t.build_path(1,["/v2/albums/"],["format"],arguments)},v2_scheduled_events_path:function(){return t.build_path(0,["/v2/scheduled_events"],["format"],arguments)},new_v2_scheduled_event_path:function(){return t.build_path(0,["/v2/scheduled_events/new"],["format"],arguments)},edit_v2_scheduled_event_path:function(){return t.build_path(1,["/v2/scheduled_events/","/edit"],["format"],arguments)},v2_scheduled_event_path:function(){return t.build_path(1,["/v2/scheduled_events/"],["format"],arguments)},v2_photos_path:function(){return t.build_path(0,["/v2/photos"],["format"],arguments)},new_v2_photo_path:function(){return t.build_path(0,["/v2/photos/new"],["format"],arguments)},edit_v2_photo_path:function(){return t.build_path(1,["/v2/photos/","/edit"],["format"],arguments)},v2_photo_path:function(){return t.build_path(1,["/v2/photos/"],["format"],arguments)},user_custom_css_presets_path:function(){return t.build_path(0,["/user_custom_css_presets"],["format"],arguments)},new_user_custom_css_preset_path:function(){return t.build_path(0,["/user_custom_css_presets/new"],["format"],arguments)},edit_user_custom_css_preset_path:function(){return t.build_path(1,["/user_custom_css_presets/","/edit"],["format"],arguments)},user_custom_css_preset_path:function(){return t.build_path(1,["/user_custom_css_presets/"],["format"],arguments)},how_page_path:function(){return t.build_path(0,["/how-pixlee-works"],["format"],arguments)},contact_page_path:function(){return t.build_path(0,["/contact-us"],["format"],arguments)},our_customers_page_path:function(){return t.build_path(0,["/our-customers"],["format"],arguments)},get_started_page_path:function(){return t.build_path(0,["/get-started"],["format"],arguments)},logos_page_path:function(){return t.build_path(0,["/logos"],["format"],arguments)},jobs_page_path:function(){return t.build_path(0,["/jobs"],["format"],arguments)},mission_page_path:function(){return t.build_path(0,["/mission"],["format"],arguments)},team_page_path:function(){return t.build_path(0,["/team"],["format"],arguments)},press_page_path:function(){return t.build_path(0,["/press"],["format"],arguments)},upgrade_browser_path:function(){return t.build_path(0,["/upgrade_browser"],["format"],arguments)},product_page_path:function(){return t.build_path(0,["/product"],["format"],arguments)},photorank_page_path:function(){return t.build_path(0,["/photosmeetdata"],["format"],arguments)},usecases_page_path:function(){return t.build_path(0,["/use-cases"],["format"],arguments)},css_generator_path:function(){return t.build_path(0,["/css_generator"],["format"],arguments)},legal_page_path:function(){return t.build_path(0,["/legal"],["format"],arguments)},dmca_page_path:function(){return t.build_path(0,["/dmca"],["format"],arguments)},terms_path:function(){return t.build_path(0,["/terms"],["format"],arguments)},case_study_niners_path:function(){return t.build_path(0,["/case-studies/niners"],["format"],arguments)},case_study_whistler_path:function(){return t.build_path(0,["/case-studies/whistler"],["format"],arguments)},case_study_warriors_path:function(){return t.build_path(0,["/case-studies/warriors"],["format"],arguments)},case_study_sanuk_path:function(){return t.build_path(0,["/case-studies/sanuk"],["format"],arguments)},account_frozen_page_path:function(){return t.build_path(0,["/account_lock"],["format"],arguments)},register_new_user_path:function(){return t.build_path(0,["/register/new_user"],["format"],arguments)},register_all_path:function(){return t.build_path(0,["/register/all"],["format"],arguments)},new_user_path:function(){return t.build_path(0,["/new_user"],["format"],arguments)},pricing_page_path:function(){return t.build_path(0,["/pricing"],["format"],arguments)},signup_path:function(){return t.build_path(0,["/signup"],["format"],arguments)},show_signup_form_path:function(){return t.build_path(0,["/register/form"],["format"],arguments)},register_path:function(){return t.build_path(0,["/register"],["format"],arguments)},new_user_free_path:function(){return t.build_path(0,["/register/enterprise-trial"],["format"],arguments)},invoice_show_path:function(){return t.build_path(1,["/invoices/view/"],["format"],arguments)},billing_create_user_path:function(){return t.build_path(0,["/signup_user"],["format"],arguments)},billing_do_change_card_path:function(){return t.build_path(0,["/account/change_card"],["format"],arguments)},stripe_hook_path:function(){return t.build_path(0,["/billing/webhook"],["format"],arguments)},feedback_add_path:function(){return t.build_path(0,["/feedback"],["format"],arguments)},contact_us_add_path:function(){return t.build_path(0,["/contact"],["format"],arguments)},forgot_password_path:function(){return t.build_path(0,["/reset"],["format"],arguments)},reset_pass_path:function(){return t.build_path(1,["/reset/"],["format"],arguments)},login_path:function(){return t.build_path(0,["/login"],["format"],arguments)},logout_path:function(){return t.build_path(0,["/logout"],["format"],arguments)},user_already_exists_path:function(){return t.build_path(0,["/register/exists"],["format"],arguments)},user_url_available_path:function(){return t.build_path(0,["/register/url_available"],["format"],arguments)},user_settings_path:function(){return t.build_path(0,["/settings"],["format"],arguments)},get_stripe_account_path:function(){return t.build_path(0,["/get_stripe_account"],["format"],arguments)},user_invoices_path:function(){return t.build_path(1,["/users/","/invoices"],["format"],arguments)},new_user_invoice_path:function(){return t.build_path(1,["/users/","/invoices/new"],["format"],arguments)},edit_user_invoice_path:function(){return t.build_path(2,["/users/","/invoices/","/edit"],["format"],arguments)},user_invoice_path:function(){return t.build_path(2,["/users/","/invoices/"],["format"],arguments)},users_path:function(){return t.build_path(0,["/users"],["format"],arguments)},edit_user_path:function(){return t.build_path(1,["/users/","/edit"],["format"],arguments)},user_path:function(){return t.build_path(1,["/users/"],["format"],arguments)},user_session_path:function(){return t.build_path(0,["/user_session"],["format"],arguments)},new_user_session_path:function(){return t.build_path(0,["/user_session/new"],["format"],arguments)},edit_user_session_path:function(){return t.build_path(0,["/user_session/edit"],["format"],arguments)},password_resets_path:function(){return t.build_path(0,["/password_resets"],["format"],arguments)},new_password_reset_path:function(){return t.build_path(0,["/password_resets/new"],["format"],arguments)},edit_password_reset_path:function(){return t.build_path(1,["/password_resets/","/edit"],["format"],arguments)},password_reset_path:function(){return t.build_path(1,["/password_resets/"],["format"],arguments)},billing_do_cancel_subscription_path:function(){return t.build_path(0,["/account/cancel_subscription"],["format"],arguments)},billing_do_change_subscription_path:function(){return t.build_path(0,["/account/change_subscription"],["format"],arguments)},get_photo_messages_path:function(){return t.build_path(1,["/direct_messaging/get_photo_messages/"],["format"],arguments)},send_direct_message_path:function(){return t.build_path(0,["/direct_messaging/send_direct_message"],["format"],arguments)},set_photo_messages_to_read_path:function(){return t.build_path(0,["/direct_messaging/set_photo_messages_to_read"],["format"],arguments)},social_publish_path:function(){return t.build_path(1,["/social/publish/"],["format"],arguments)},auth_facebook_setup_path:function(){return t.build_path(0,["/auth/facebook/setup"],["format"],arguments)},facebook_pages_list_path:function(){return t.build_path(0,["/facebook_pages/list"],["format"],arguments)},open_graph:function(){return t.build_path(0,["/social/open_graph"],["format"],arguments)},tumblr_blogs_list_path:function(){return t.build_path(0,["/tumblr_blogs/list"],["format"],arguments)},facebook_album_publish_path:function(){return t.build_path(1,["/albums/","/publish_to_facebook"],["format"],arguments)},tumblr_publish_path:function(){return t.build_path(1,["/tumblr/publish/"],["format"],arguments)},social_logout_path:function(){return t.build_path(1,["/","/logout"],["format"],arguments)},box_publish_path:function(){return t.build_path(0,["/box/publish"],["format"],arguments)},user_analytics_path:function(){return t.build_path(0,["/analytics"],["format"],arguments)},photo_approve_path:function(){return t.build_path(0,["/photos/approve"],["format"],arguments)},photo_deny_path:function(){return t.build_path(0,["/photos/deny"],["format"],arguments)},photo_approve_all_path:function(){return t.build_path(0,["/photos/approve_visible"],["format"],arguments)},photo_deny_all_path:function(){return t.build_path(0,["/photos/deny_visible"],["format"],arguments)},update_photos_path:function(){return t.build_path(0,["/update_photos"],["format"],arguments)},publish_all_albums_path:function(){return t.build_path(0,["/albums/publish_all"],["format"],arguments)},album_settings_path:function(){return t.build_path(1,["/albums/","/settings"],["format"],arguments)},album_collect_settings_path:function(){return t.build_path(1,["/albums/","/collect"],["format"],arguments)},album_publish_settings_path:function(){return t.build_path(1,["/albums/","/publish"],["format"],arguments)},album_copy_path:function(){return t.build_path(0,["/albums/copy"],["format"],arguments)},dashboard_path:function(){return t.build_path(0,["/dashboard"],["format"],arguments)},notifications_path:function(){return t.build_path(1,["/notifications/"],["format"],arguments)},app_path:function(){return t.build_path(0,["/app"],["format"],arguments)},inbox_albums_path:function(){return t.build_path(0,["/inbox/albums"],["format"],arguments)},photo_thumb_path:function(){return t.build_path(1,["/photos/thumb/"],["format"],arguments)},album_photo_insights_path:function(){return t.build_path(1,["/albums/","/insights"],["format"],arguments)},album_graph_stats_path:function(){return t.build_path(1,["/albums/","/graph"],["format"],arguments)},root_path:function(){return t.build_path(0,["/"],["format"],arguments)},user_super_short_album_add_path:function(){return t.build_path(2,["/","/","/add"],["format"],arguments)},user_albums_path:function(){return t.build_path(1,["/"],["format"],arguments)},albums_create_distill_path:function(){return t.build_path(0,["/albums/create_distill"],["format"],arguments)},create_custom_flag_list_path:function(){return t.build_path(0,["/users/custom_flag_list"],["format"],arguments)},social_share_param:function(){return"/social/share_social_media?"},category_list_path:function(){return t.build_path(1,["/categories/"],["format"],arguments)},rails_info_properties_path:function(){return t.build_path(0,["/rails/info/properties"],["format"],arguments)}},window.Routes.options=e}(),function(e){var t,i;i=e.sync,e.sync=function(e,n,o){var r;return o=o||{},_.defaults(o,{beforeSend:_.bind(t.beforeSend,n),complete:_.bind(t.complete,n)}),r=i(e,n,o),n._fetch||"read"!==e?r:n._fetch=r},t={beforeSend:function(){return this.trigger("sync:start",this)},complete:function(){return this.trigger("sync:stop",this)}}}(Backbone);var __bind=function(e,t){return function(){return e.apply(t,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(e,t){function i(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},log_debug=function(){window.console&&window.console.firebug&&console.log.apply(this,arguments)},__slice=[].slice;Array.prototype.insertAt=function(e,t){return this.splice(e,0,t)},String.prototype.insertAt=function(e,t){return e>0?this.substring(0,e)+t+this.substring(e,this.length):t+this},Date.prototype.addDays=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t},Array.prototype.forEach||(Array.prototype.forEach=function(e){"use strict";if(void 0===this||null===this||"function"!=typeof e)throw new TypeError;for(var t=Object(this),i=t.length>>>0,n=arguments.length>=2?arguments[1]:void 0,o=0;o<i;o++)o in t&&e.call(n,t[o],o,t)}),function(e){if(e.fn.toggleWrapper=function(t,i){var n,o,r;return null==t&&(t={}),null==i&&(i=!0),_.defaults(t,{className:"",backgroundColor:"transparent"!==this.css("backgroundColor")?this.css("backgroundColor"):"white",zIndex:"auto"===this.css("zIndex")?1e3:Number(this.css("zIndex"))}),o=this.offset(),r=this.outerWidth(!1),n=this.outerHeight(!1),i?e("<div>").appendTo("body").addClass(t.className).attr("data-wrapper",!0).css({width:r,height:n,top:o.top,left:o.left,position:"absolute",zIndex:t.zIndex+1}):e("[data-wrapper]").remove()},!e.support.cors&&e.ajaxTransport&&window.XDomainRequest){var t=/^https?:\/\//i,i=/^get|post$/i,n=new RegExp("^"+location.protocol,"i"),o=/text\/html/i,r=/\/json/i,s=/\/xml/i;e.ajaxTransport("* text html xml json",function(a,l){if(a.crossDomain&&a.async&&i.test(a.type)&&t.test(a.url)&&n.test(a.url)){var c=null,u=(l.dataType||"").toLowerCase();return{send:function(t,i){c=new XDomainRequest,/^\d+$/.test(l.timeout)&&(c.timeout=l.timeout),c.ontimeout=function(){i(500,"timeout")},c.onload=function(){var t="Content-Length: "+c.responseText.length+"\r\nContent-Type: "+c.contentType,n={code:200,message:"success"},a={text:c.responseText};try{if("html"===u||o.test(c.contentType))a.html=c.responseText;else if("json"===u||"text"!==u&&r.test(c.contentType))try{a.json=e.parseJSON(c.responseText)}catch(e){n.code=500,n.message="parseerror"}else if("xml"===u||"text"!==u&&s.test(c.contentType)){var l=new ActiveXObject("Microsoft.XMLDOM");l.async=!1;try{l.loadXML(c.responseText)}catch(e){l=void 0}if(!l||!l.documentElement||l.getElementsByTagName("parsererror").length)throw n.code=500,n.message="parseerror","Invalid XML: "+c.responseText;a.xml=l}}catch(e){throw e}finally{i(n.code,n.message,a,t)}},c.onprogress=function(){},c.onerror=function(){i(500,"error",{text:c.responseText})};var n="";l.data&&(n="string"===e.type(l.data)?l.data:e.param(l.data)),c.open(a.type,a.url),c.send(n)},abort:function(){c&&c.abort()}}}})}}($),jQuery.browser={},function(){jQuery.browser.msie=!1,jQuery.browser.version=0,navigator.userAgent.match(/MSIE ([0-9]+)\./)&&(jQuery.browser.msie=!0,jQuery.browser.version=RegExp.$1)}(),_.templateSettings={interpolate:/\[\%\=(.+?)\%\]/gim,evaluate:/\[\%(.+?)\%\]/gim,escape:/\[\%\-(.+?)\%\]/gim},_.mixin({isFalsy:function(e){return 0==e||""==e||null==e||"undefined"==e||void 0==e||NaN==e||"null"==e||"false"==e||0==e||"0"==e},isTruthy:function(e){return!this.isFalsy(e)}}),window.videojs&&(videojs.options.flash.swf="https://assets.pixlee.com/flash/video-js.swf");var Pixlee=function(e,t){function i(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=i.exec(t);return null==n?null:decodeURIComponent(n[1].replace(/\+/g," "))}function n(){$.ajax({url:"/initializeCookie",type:"POST",data:{distinct_user_hash:gon.distinct_user_hash},dataType:"json",success:function(e){gon.pixlee_votes=e.votes,s.execute("vote:loaded");var t={name:"pixlee:vote:loaded",type:"relay",source:"widget",destination:"lightbox",data:{pixlee_votes:e.votes}};window.top.postMessage(JSON.stringify(t),"*")}})}function o(){if(d<u)d+=1,gon.current_album&&gon.current_album.campaign&&setTimeout(function(){_.isFalsy(gon.distinct_user_hash)?("undefined"!=typeof analytics&&analytics.getAnonymousId&&(gon.distinct_user_hash=analytics.getAnonymousId()),o()):n()},100);else{var e={name:"pixlee:log:to:sentry",type:"action",source:"widget",destination:"parent",data:{messageText:"Failed to retrieve DUH",messageExtraFields:{tags:{source:"widgets",analytics:"undefined"!=typeof analytics,getAnonymousId:typeof analytics.getAnonymousId,file:"photos_app_v2.js"}}}};window.parent.postMessage(JSON.stringify(e),"*")}}function r(){window.addEventListener("message",function(e){var t;if(e.data){try{t=JSON.parse(e.data)}catch(e){return}t.name&&"pixlee:css:generated"===t.name&&$.ajax({url:"/generatecss",type:"POST",data:t.data,dataType:"json",success:function(e){$("#dynamicStylesheet").html(e.css),s.execute("stylesheet:generated",e.css,e.params,e.display_options),s.displayOptions.set("standaloneOptions.bannerImage_showHide",t.data.displayOptions.standaloneOptions.bannerImage_showHide),s.displayOptions.set("standaloneOptions.logoImage_showHide",t.data.displayOptions.standaloneOptions.logoImage_showHide),s.displayOptions.set("standaloneOptions.logoImage_input",t.data.displayOptions.standaloneOptions.logoImage_input),s.displayOptions.set("standaloneOptions.bannerImage_input",t.data.displayOptions.standaloneOptions.bannerImage_input),s.displayOptions.set("standaloneOptions.logoImage_backgroundImage",t.data.displayOptions.standaloneOptions.logoImage_backgroundImage),s.displayOptions.set("standaloneOptions.bannerImage_backgroundImage",t.data.displayOptions.standaloneOptions.bannerImage_backgroundImage),s.displayOptions.set("headerOptions.end_tile_upload_button_background_showHide",t.data.displayOptions.headerOptions.end_tile_upload_button_background_showHide)}})}},!1)}var s;s=new t.Application,s.version="v4";var a={name:"pixlee:widget:size:fix",type:"action",source:"widget",destination:"parent",data:{widgetType:gon.type,widgetId:gon.publication_id}};"show_widget"===gon.action&&window.parent.postMessage(JSON.stringify(a),"*");var l={name:"pixlee:experiment:info",type:"action",source:"widget",destination:"parent",data:{experimenting:gon.experimenting}};if(l.data.experimenting&&(l.data.experiment_id=gon.experiment_id,l.data.experiment_group=gon.experiment_group),window.parent.postMessage(JSON.stringify(l),"*"),gon.experimenting&&gon.experiment_group&&"no_widget"===gon.experiment_group){var c={name:"pixlee:hide:widget",type:"action",source:"widget",destination:"parent",data:{}};window.parent.postMessage(JSON.stringify(c),"*")}var u=50,d=0;if(!gon.previewMode&&(i("ab_test",document.location.href)||!_.isFalsy(gon.current_account.extra_fields)&&!_.isFalsy(gon.current_account.extra_fields.AB))){gon.AB="A",$("html").easyab({slot:1,name:"widget",alternatives:[{alternative:function(e){gon.AB="B",e.hide()}}]});var h={name:"pixlee:widget:ab",type:"action",source:"widget",destination:"parent",data:{abTest:!0,bucket:gon.AB}};window.parent.postMessage(JSON.stringify(h),"*")}return s.on("before:start",function(e){if(s.isWidget=!0,s.config=s.request("set:config:photos:app"),s.currentUser=s.request("set:current:user",e.current_account),s.currentAlbum=s.request("set:current:album",e.current_album),s.displayOptions=s.request("set:display:options",e.display_options),s.recipe=s.request("set:recipe",e.recipe),_.isFalsy(s.currentAlbum.get("description"))?_.isFalsy(s.currentAlbum.get("title"))?s.altText="This is a photo gallery":s.altText="This is a photo gallery with the title of: "+decodeURIComponent(s.currentAlbum.get("title")):s.altText="This is a photo gallery with the title of: "+decodeURIComponent(s.currentAlbum.get("description")),gon.previewMode)r();else{var t=function(e){var t;if(e.data){try{t=JSON.parse(e.data)}catch(e){return}if(t&&t.name&&"pixlee:hide:lightbox"===t.name&&!_.isFalsy(window.lastElement)&&window.lastElement.focus(),t&&t.name&&"pixlee:social:login"==t.name&&s.execute("social:login",t.data),t&&t.name&&"pixlee:social:login:loaded"==t.name&&s.execute("social:login:loaded"),t&&t.name&&"pixlee:widget:visible"==t.name&&t.data.src===window.location.href&&setTimeout(function(){s.execute("widget:visible")},500),t&&t["function"]&&"kpiEvent"==t["function"]){var i;t.data&&t.data.event&&(i=t.data.event),s.execute("kpi:event",i)}t.name&&"pixlee:fingerprint"===t.name&&(gon.fingerprint=t.data)}};window.addEventListener("message",t,!1)}s.publication_id=e.widget_id}),o(),s.reqres.setHandler("get:current:user",function(){return s.currentUser}),s.reqres.setHandler("get:current:album",function(){return s.currentAlbum}),s.reqres.setHandler("get:config",function(){return s.config}),s.reqres.setHandler("get:display:options",function(){return s.displayOptions}),s.reqres.setHandler("get:recipe",function(){return s.recipe}),s.reqres.setHandler("get:photo:url",function(e){return Routes.distillery_photo_path(e)}),s.reqres.setHandler("get:location:url",function(){return Routes.distillery_analytics_location_path()}),s.addRegions({widget:"#widget"}),s.reqres.setHandler("default:region",function(){return s.widget}),s.commands.setHandler("register:instance",function(e,t){if("development"===s.config.environment)return s.register(e,t)}),s.reqres.setHandler("concern",function(e){return s.Concerns[e]}),s.commands.setHandler("unregister:instance",function(e,t){if("development"===s.config.environment)return s.unregister(e,t)}),s.commands.setHandlers({"show:uploader:loader":function(){$("#uploader_loader").show()},"hide:uploader:loader":function(){$("#uploader_loader").hide()}}),s}(Backbone,Marionette);Pixlee.module("Concerns",function(e,t,i,n,o){e.HorizontalCollectionView={onShow:function(){gon.isMobileDevice?(this.width=0,o(this.el).parent().css({"overflow-x":"scroll","overflow-y":"hidden","-webkit-overflow-scrolling":"touch"}),o("#hw_container").width(gon.containerWidth)):(this.startSly(),o("#left-nav-arrow").addClass("inactive-arrow")),0===this.collection.length&&o("#widget_header_table,#photowall_description").css("opacity","1")},startSly:function(){this.sly=new Sly(o(this.el).parent(),{horizontal:1,itemNav:"basic",itemSelector:".photo-item-container",speed:300}),this.sly.init(),gon.v2&&(o("body").css({"padding-right":"40px","padding-left":"40px"}),this.setWidgetHeight())},onAddChild:function(e){var t=this;clearTimeout(this.timer),this.firstLoad?(this.$el.unbind(".imagesLoaded"),t.loadSly(e)):(this.timer=setTimeout(function(){t.firstLoad=!0},100),this.$el.imagesLoaded().always(function(){t.loadSly(e)}))},loadSly:function(e){var t=this;if(gon.v2){var i=o(e.$el).find(".photo_block");e.$el.css({opacity:1});var n=o(e.$el).find(".lightboxed, .img_holder"),r=o(e.$el).find("svg, .image_info");i.css({height:t.getPhotoSize(),width:t.getPhotoSize()}),n.css({height:t.getPhotoSize(),width:t.getPhotoSize()}),r.css({width:t.getPhotoSize()})}else e.$el.css({opacity:1,height:"210px",width:"220px","float":"left",display:"block"}),o(e.$el).find(".layer_share").css({height:"210px",width:"200px",top:0}),o(e.$el).find(".vote_button").css({"margin-left":"22px",left:"auto"});gon.isMobileDevice||this.initialized?!gon.isMobileDevice&&this.initialized&&t.sly.reload():(this.initialized=!0,setTimeout(function(){t.sly.reload()},50)),t.trigger("images:loaded"),gon.isMobileDevice&&(this.width+=o(".photo-item-container").outerWidth()+15,o(this.el).width(this.width))},setWidgetHeight:function(){o("#widgets_main_region").removeClass("photowall_widget_medium"),gon.display_options&&"small_photo"===gon.display_options.photoSize?o("#widgets_main_region").addClass("photowall_widget_small"):gon.display_options&&"medium_photo"===gon.display_options.photoSize?o("#widgets_main_region").addClass("photowall_widget_medium"):gon.display_options&&o("#widgets_main_region").addClass("photowall_widget_large")},
getPhotoSize:function(){if(gon.v2){if(gon.display_options&&"small_photo"===gon.display_options.photoSize)return"150px";if(gon.display_options&&"medium_photo"===gon.display_options.photoSize)return"200px";if(gon.display_options)return"260px"}else{if(gon.display_options&&"small_photo"===gon.display_options.photoSize)return"150px";if(gon.display_options&&"medium_photo"===gon.display_options.photoSize)return"200px";if(gon.display_options)return"240px"}},onBeforeAddChild:function(e){this.initLoader||gon.isMobileDevice||this.showLoader(),e.$el.css({opacity:0})},onDestroy:function(){},calcHorizontal:function(){o(".arrows").css({"margin-top":"-"+(parseInt(this.getPhotoSize(),10)+10)+"px",height:parseInt(this.getPhotoSize(),10)+"px"})}}}),Pixlee.module("Concerns",function(e,t,i,n,o,r){e.MasonryCollectionView={onShow:function(){0===this.collection.length&&o("#widget_header_table, #photowall_description").css("opacity","1"),this.counter=0,gon.v2||gon.packery||this.initMasonry(),gon.packery&&this.initPackery()},onRender:function(){gon.v2||gon.packery||this.initMasonry()},initPackery:function(){var e=this.$el;e.packery({itemSelector:".photo-item-container",gutter:10}),this.referenceCollection=t.request("get:photos:widget:photowall"),this.image_count=0,this.moreimages=[],gon.fresh_images=[],this.child_views=[],this.$el.css("width","100%"),this.$el.addClass("mosiac")},changeRandomImage:function(){var e=this;if(0!=gon.fresh_images.length||this.syncing)if(gon.fresh_images.length>0){this.syncing=!1;var t=Math.floor(Math.random()*this.child_views.length);gon.lightBoxOpen||this.child_views[t].changeImage();var e=this;setTimeout(function(){e.changeRandomImage()},5e3)}else setTimeout(function(){e.moreimages.length>0&&(r.each(e.moreimages,function(e){e.attributes&&e.attributes.source_url&&gon.fresh_images.push(e)}),e.moreimages=[]),e.referenceCollection.each(function(e){e.attributes&&e.attributes.source_url&&gon.fresh_images.push(e)}),e.changeRandomImage()},5e3);else this.referenceCollection.reset(),this.referenceCollection.models=[],e.referenceCollection.next?(this.referenceCollection.nextPage(),this.syncing=!0):(gon.currentLength=0,this.referenceCollection.goTo(1),this.syncing=!0),e.changeRandomImage()},onAddChild:function(e){var t=this;if(e.$el.find(".box").css("margin-bottom",o(".gutter").width()),"empty_photowall"!=e.$el.attr("id")){o("#widget_header_table,#photowall_description").css("opacity","1"),"undefined"!=typeof gon.widget&&(t.loaded||t.removeLoader()),e.$el.css({opacity:1});var i=o(e.$el).find(".lightboxed"),n=o(e.$el).find(".photo_block, .img_holder"),r=o(e.$el).find("svg, .image_info");if(!gon.v2||gon.isMobileDevice||gon.packery)if(gon.packery&&!gon.isMobileDevice)if(this.image_count<16){var s=t.randomPhotoSize()+"px";n.css({height:s,width:s}),i.css({height:s,width:s}),r.remove(),e.$el.find(".social_holder, .vote_button").remove(),e.$el.css({height:s,width:s}),this.$el.packery("appended",e.$el),this.$el.find(".img_holder").cycle({speed:500,timeout:0}),this.child_views.push(e),this.image_count++}else{var a=e.model;this.moreimages.push(a),e.model.collection.remove(e.model),this.image_count++,e.remove()}else gon.v2||(o(e.$el).find(".layer_share").css({height:t.getPhotoSize(),width:t.getPhotoSize(),top:0}),o(e.$el).find(".box_bg_image").css({height:t.getPhotoSize(),width:t.getPhotoSize()}),t.$el.masonry("appended",e.$el));else n.css({height:t.getPhotoSize(),width:t.getPhotoSize()}),i.css({height:t.getPhotoSize(),width:t.getPhotoSize()}),r.css({width:t.getPhotoSize()});t.trigger("images:loaded")}else e.$el.css({opacity:1})},onBeforeAddChild:function(e){"undefined"!=typeof gon.widget&&(this.initLoader||this.showLoader()),e.$el.css({opacity:0})},randomPhotoSize:function(){return 0==this.counter?(this.counter++,350):(2==this.counter?this.counter=0:this.counter++,170)},onRemoveChild:function(e){return!gon.packery&&(this.$el.masonry("remove",o(e)),void this.$el.masonry({itemSelector:".box",gutter:o(".gutter").width(),isFitWidth:!0,isAnimatedFromBottom:!0}))},onDestroy:function(){this.destroyMasonry()},destroyMasonry:function(){this.$el.masonry("destroy")},initMasonry:function(){this.$el.masonry(this.getDefaultsMasonryOptions())},getPhotoSize:function(){if(gon.v2){if(gon.display_options&&"small_photo"===gon.display_options.photoSize)return"150px";if(gon.display_options&&"medium_photo"===gon.display_options.photoSize)return"200px";if(gon.display_options)return"260px"}else{if(gon.display_options&&"small_photo"===gon.display_options.photoSize)return"150px";if(gon.display_options&&"medium_photo"===gon.display_options.photoSize)return"200px";if(gon.display_options)return"240px"}},getDefaultsMasonryOptions:function(){var e;e=gon.display_options&&"small_photo"===gon.display_options.photoSize?150:gon.display_options&&"medium_photo"===gon.display_options.photoSize?200:gon.display_options?240:227;var t;return t=gon.isMobileDevice?0:"0",{itemSelector:gon.v2?".photo_block":".box",gutter:o(".gutter").width(),isFitWidth:!0,isAnimatedFromBottom:!0,transitionDuration:t}}}}),Pixlee.module("Concerns",function(e,t,i,n,o,r){var s={submitterAnchorVine:function(){switch(this.submitterType()){case"instagram":return"image"!=this.content_type&&this.content_type?r.isFalsy(this.platform_link)?"<a class='instagram_video' href='http://instagram.com/"+this.submitter().replace("@","")+"' target='_blank'>@"+this.submitter().replace("@","")+"</a>":"<a class='instagram_video' href='"+this.platform_link+"' target='_blank'>@"+this.submitter().replace("@","")+"</a>":r.isFalsy(this.platform_link)?"<a class='instagram' href='http://instagram.com/"+this.submitter().replace("@","")+"' target='_blank'>@"+this.submitter().replace("@","")+"</a>":"<a class='instagram handle' href='"+this.platform_link+"' target='_blank'>@"+this.submitter().replace("@","")+"</a>";default:return"<a class='vine'>"+this.submitter()+"</a>"}return""},setDisplayOptions:function(){this.displayOptions||(this.displayOptions=t.reqres.request("get:display:options").toJSON())},userVotedSet:function(){return this.userVoted},getActionLink:function(){return this.setDisplayOptions(),r.isFalsy(this.richAction)||r.isFalsy(this.richAction.link)?r.isFalsy(this.action_link)?r.isFalsy(gon.current_album.action_link)?r.isFalsy(gon.display_options.customCallToActionLink)?"":gon.display_options.customCallToActionLink:gon.current_album.action_link:this.action_link:this.richAction.link},getVotedText:function(){return r.isFalsy(gon.display_options.customVotedText)?"voted":gon.display_options.customVotedText},getActionText:function(){return this.setDisplayOptions(),r.isFalsy(this.richAction)||r.isFalsy(this.richAction.action_link_text)?r.isFalsy(this.action_link_text)?r.isFalsy(gon.current_album.action_link_text)?r.isFalsy(gon.display_options.customCallToActionText)?"":gon.display_options.customCallToActionText:gon.current_album.action_link_text:this.action_link_text:this.richAction.action_link_text},hasActionLink:function(){if(this.setDisplayOptions(),553==gon.current_account.id)return!1;var e=t.reqres.request("get:current:user");return!!e.canAccess("ecomm")||(!r.isFalsy(this.action_link_title)&&!r.isFalsy(this.action_link_photo)||(!!gon.display_options.customCallToActionPhoto||(!(!this.displayOptions.showCallToAction||r.isFalsy(this.displayOptions.customCallToActionText)||r.isFalsy(this.displayOptions.customCallToActionLink))||(!(r.isFalsy(this.action_link_text)||r.isFalsy(this.action_link)||!gon.display_options.showCallToAction)||(!r.isFalsy(this.action_link)||!r.isFalsy(gon.current_album.action_link))))))},hasIndividualActionLink:function(){return!r.isFalsy(this.action_link_text)&&!r.isFalsy(this.action_link)},submitterType:function(){return r.isFalsy(this.source)?"desktop":this.source},submitterAnchor:function(e){switch(r.isFalsy(e)&&(e=!1),this.submitterType()){case"instagram":return"image"!=this.content_type&&this.content_type?r.isFalsy(this.platform_link)?"<a class='instagram_video handle' href='http://instagram.com/"+this.submitter().replace("@","")+"' target='_blank'>@"+this.submitter().replace("@","")+"</a>":"<a class='instagram_video' href='"+this.platform_link+"' target='_blank'>@"+this.submitter().replace("@","")+"</a>":r.isFalsy(this.platform_link)?"<a class='instagram handle' href='http://instagram.com/"+this.submitter().replace("@","")+"' target='_blank'>@"+this.submitter().replace("@","")+"</a>":"<a class='instagram handle' href='"+this.platform_link+"' target='_blank'>@"+this.submitter().replace("@","")+"</a>";case"twitter":return"image"!=this.content_type&&this.content_type?r.isFalsy(this.platform_link)?"<a class='vine handle' >"+this.submitter()+"</a>":"<a class='vine handle' href='"+this.platform_link+"' target='_blank'>@"+this.submitter().replace("@","")+"</a>":r.isFalsy(this.platform_link)?"<a class='twitter handle' href='http://twitter.com/"+this.submitter().replace("@","")+"' target='_blank'>@"+this.submitter().replace("@","")+"</a>":"<a class='twitter handle' href='"+this.platform_link+"' target='_blank'>@"+this.submitter().replace("@","")+"</a>";case"website":return"<a class='website handle' >"+this.submitter()+"</a>";case"facebook":return"<a class='facebook handle' >"+this.submitter()+"</a>";case"email":return e?"<a class='email handle' ></a>":"<a class='email handle' >"+this.submitter()+"</a>";case"desktop":return"<a class='email handle' >"+this.submitter()+"</a>";default:return"<a class='submitted_by_you handle'>"+this.submitter(e)+"</a>"}return"<a class='website handle' >"+this.submitter()+"</a>"},createdDate:function(){return moment(this.created_at).format("MMMM D, YYYY")},submitter:function(){return null!=this.user_name?t.request("escape:html",this.user_name):null==this.email_address||t.isWidget?(t.isWidget,""):t.request("escape:html",this.email_address)},getTitle:function(){return null!=this.title&&"null"!=this.title?this.title:null!=this.album_title&&"null"!=this.album_title&&""!=this.album_title?this.album_title:null!=this.photo_title&&"null"!=this.photo_title&&""!=this.photo_title?this.photo_title:""},altText:function(){var e="";if(r.isFalsy(this.alt_text))try{r.isFalsy(this.submitter())?(e+="Photo submission ",r.isFalsy(this.submitterType)||(e+="to "+t.request("escape:html",this.submitterType())+" ")):(e+="Photo taken by "+t.request("escape:html",this.submitter())+" ",r.isFalsy(this.submitterType)||(e+="on "+t.request("escape:html",this.submitterType())+" ")),r.isFalsy(this.getTitle())||(e+=" with the caption of: "+t.request("escape:html",this.getTitle())+".")}catch(t){e=""}else e=this.alt_text;return t.request("escape:html",e)},uploaderAdditionalFields:function(){var e=this.uploader_additional_fields,t="";return r.isEmpty(e)||r.each(e,function(e,i){i=i.split(" ")[0],t+='<div class="additional_upload_info '+i+'">'+e+"</div>"}),t},photoURL:function(e){if(null!=this.data_file_name)return this.photoFileURL(e);switch(this.submitterType()){case"instagram":if("image"!=this.content_type&&this.content_type){if("video"==this.content_type)return this.thumbnail_url.replace("http://","https://")}else if(null!=this.source_url)return this.source_url.replace("http://","https://");break;case"facebook":if(null!=this.source_url)return this.source_url.replace("http://","https://");break;case"website":if(null!=this.source_url)return this.source_url.replace("http://","https://");break;case"email":if(null!=this.source_url)return this.source_url.replace("http://","https://");break;case"desktop":if(null!=this.source_url)return this.source_url.replace("http://","https://");break;case"twitter":if("image"!=this.content_type&&this.content_type){if("video"==this.content_type)return this.thumbnail_url.replace("http://","https://")}else if(null!=this.source_url)return this.source_url.replace("http://","https://");break;default:if(null!=this.source_url)return this.source_url.replace("http://","https://")}return""},photoFileURL:function(e){if(this.config&&"development"==this.config.env){var i="pixlee-dev";return"http://s3.amazonaws.com/"+i+"/photos/"+(this.id||this.photo_id)+"/"+e+"/"+t.reqres.request("encode:utf8",this.data_file_name)}var n="https://static.pixlee.com";return n+"/photos/"+(this.id||this.photo_id)+"/"+e+"/"+t.reqres.request("encode:utf8",this.data_file_name)},dedicatedLink:function(){return gon.global.pixleePhotosServer+this.currentUser.id+"/"+this.album_id+"/"+this.album_photo_id},dedicatedPath:function(){return"/"+this.currentUser.id+"/"+this.album_id+"/"+this.album_photo_id},videoURL:function(){return this.source_url.replace("http://","https://")},isVideo:function(){return"video"==this.content_type},shouldShowCaptions:function(){return!0},thumbnail:function(e){return r.isFalsy(e)&&(e="medium"),r.isFalsy(this.data_file_name)?this.medium_url?this.medium_url.replace("http://","https://"):this.thumbnail_url?this.thumbnail_url.replace("http://","https://"):this.source_url?this.source_url.replace("http://","https://"):void 0:this.photoFileURL(e)},isStarred:function(){return"t"==this.is_starred||1==this.is_starred},showDate:function(){return!!gon.display_options.showTimestampsOnPhotowall},getDate:function(){return moment(this.tagged_at).format("MM/DD/YYYY")}};e.PhotoViewHelpers={templateHelpers:s},e.PhotoHelpers=s}),Pixlee.module("Entities",function(e,t,i,n,o,r){e.Collection=i.Collection.extend({sliced:function(e,t){var i=this;return i=r(i.rest(e)),i=r(i.first(t)),i.map(function(e){return e})},decode_utf8:function(e){return t.request("decode:utf8",e)},constructor:function(e,t){t=t||{},t.url&&(this.url=t.url),i.Collection.prototype.constructor.apply(this,arguments)}}),e.ClientPaginatedCollection=i.Paginator.clientPager.extend({paginator_ui:{firstPage:1,currentPage:1,perPage:30,totalPages:10},paginator_core:{type:"GET",dataType:"JSON",cache:!0}}),e.FilterableCollection=e.Collection.extend({clearFilterCriterias:function(){this._currentCriteria=!1,this._originalModels=null},filterBy:function(e,t){var i,n=this;!r.isFalsy(this._currentCriteria)&&r.isFalsy(t)||(this._originalModels=this.models,this._remaining_count=this.remaining_count),e?(i=[],r.each(this._originalModels,function(t){for(var o in e)n.decode_utf8(t.get(o).toLowerCase()).indexOf(e[o].toLowerCase())!=-1&&i.push(t)}),this._currentCriteria=e,this.remaining_count=i.length):(i=this._originalModels,this.clearFilterCriterias(),this.remaining_count=this._remaining_count),this.reset(i),this.trigger("collection:filtered")}}),e.PaginatedCollection=function(e){function i(e,t){t=t||{},this.paginator_core=this.paginator_core||{},this.paginator_ui=this.paginator_ui||{},this.server_api=this.server_api||{},this.sessionId=Math.floor(Date.now()/12e5)+"",r.defaults(this.paginator_core,{type:"GET",dataType:"JSON",url:r.result(t,"url"),cache:!0}),r.defaults(this.paginator_ui,{firstPage:1,currentPage:1,perPage:30,totalPages:10}),gon.isMobileDevice&&(this.paginator_ui.perPage=10),this.album=t.album,this.sort=t.sort,this.filter=t.filter,i.__super__.constructor.call(this,e,t)}return __extends(i,e),i.prototype.decode_utf8=function(e){return t.request("decode:utf8",e)},i}(i.Paginator.requestPager)}),Pixlee.module("Entities",function(e,t,i,n,o,r){var s;e.Model=function(e){function t(e){return this.saveError=__bind(this.saveError,this),this.saveSuccess=__bind(this.saveSuccess,this),e=e||{},r.extend(this,r.pick(e,i)),t.__super__.constructor.apply(this,arguments)}var i=["urlRoot","collection"];return __extends(t,e),t.prototype.destroy=function(e){return e=e||{},r.defaults(e,{wait:!0}),this.set({_destroy:!0},{silent:!0}),t.__super__.destroy.call(this,e)},t.prototype.isDestroyed=function(){return this.get("_destroy")},t.prototype.save=function(e,i,n){null!=e&&"object"!=typeof e||(n=i);var o;return n=n||{},o=this.isNew(),Cocktail.mixin(n,{wait:!0,success:r.bind(this.saveSuccess,this,o,this.collection,n.index),error:r.bind(this.saveError,this)}),this.unset("_errors"),t.__super__.save.call(this,e,i,n)},t.prototype.saveSuccess=function(e,t,i){return e?(t&&t.add(this,{at:i||0}),t&&t.trigger("model:created",this),this.trigger("created",this)):(t&&t.trigger("model:updated",this),this.trigger("updated",this))},t.prototype.saveError=function(e,t){var i;if(500!==t.status&&404!==t.status)return this.set({_errors:null!=(i=o.parseJSON(t.responseText))?i.errors:void 0})},t}(i.Model),e.DeepModel=function(e){function t(e){return this.saveError=__bind(this.saveError,this),this.saveSuccess=__bind(this.saveSuccess,this),e=e||{},r.extend(this,r.pick(e,i)),t.__super__.constructor.apply(this,arguments)}var i=["urlRoot","collection"];return __extends(t,e),t.prototype.destroy=function(e){return e=e||{},r.defaults(e,{wait:!0}),this.set({_destroy:!0},{silent:!0}),t.__super__.destroy.call(this,e)},t.prototype.isDestroyed=function(){return this.get("_destroy")},t.prototype.save=function(e,i,n){null!=e&&"object"!=typeof e||(n=i);var o;return n=n||{},o=this.isNew(),Cocktail.mixin(n,{wait:!0,success:r.bind(this.saveSuccess,this,o,this.collection,n.index),error:r.bind(this.saveError,this)}),this.unset("_errors"),t.__super__.save.call(this,e,i,n)},t.prototype.saveSuccess=function(e,t,i){return e?(t&&t.add(this,{at:i||0}),t&&t.trigger("model:created",this),this.trigger("created",this)):(t&&t.trigger("model:updated",this),this.trigger("updated",this))},t.prototype.saveError=function(e,t){var i;if(500!==t.status&&404!==t.status)return this.set({_errors:null!=(i=o.parseJSON(t.responseText))?i.errors:void 0})},t}(i.DeepModel),s={newModel:function(t){return new e.Model(t)}},t.reqres.setHandler("new:model",function(e){return e=e||{},s.newModel(e)})}),Pixlee.module("Controllers",function(e,t,i,n,o,r){e.Application=function(e){function i(e){null==e&&(e={}),this.region=e.region||t.request("default:region"),this._instance_id=r.uniqueId("controller"),t.execute("register:instance",this,this._instance_id),i.__super__.constructor.apply(this,arguments)}return __extends(i,e),i.prototype.destroy=function(){return t.execute("unregister:instance",this,this._instance_id),i.__super__.destroy.apply(this,arguments)},i.prototype.show=function(e,t){null==t&&(t={}),r.defaults(t,{loading:!1,region:this.region}),this._setMainView(e),this._manageView(e,t)},i.prototype._setMainView=function(e){this._mainView||(this._mainView=e,this.listenTo(e,"destroy",this.destroy))},i.prototype._manageView=function(e,i){i.loading?t.commands.execute("show:loading",e,i):i.region.show(e)},i}(n.Controller)}),Pixlee.module("Utilities",function(e,t,i,n){n.Behaviors.behaviorsLookup=function(){return t.Behaviors}}),Pixlee.module("Utilities",function(e,t,i,n,o,r){t.commands.setHandler("when:fetched",function(e,t){var i;return i=r.chain([e]).flatten().pluck("_fetch").value(),o.when.apply(o,i).done(function(){return t()})})}),Pixlee.module("Utilities",function(e,t,i,n,o,r){var s,a,l=Routes.social_share_param();s={decodeUtf8:function(e){var t=e;try{t=decodeURIComponent(e)}catch(i){try{t=unescape(e)}catch(i){t=e}}return t},murmurhash3_32_gc:function(e,t){var i,n,o,r,s,a,l,c;for(i=3&e.length,n=e.length-i,o=t,s=3432918353,a=461845907,c=0;c<n;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295,l=l<<15|l>>>17,l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295,o^=l,o=o<<13|o>>>19,r=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=(65535&r)+27492+(((r>>>16)+58964&65535)<<16);switch(l=0,i){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:l^=255&e.charCodeAt(c),l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295,l=l<<15|l>>>17,l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295,o^=l}return o^=e.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,o^=o>>>16,o>>>0},encodeUtf8:function(e){var t=e;try{t=encodeURIComponent(e)}catch(i){try{t=escape(e)}catch(i){t=e}}return t},escapeHtml:function(e){var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},n=t.request("decode:utf8",e);return String(n).replace(/[&<>"'\/]/g,function(e){return i[e]})},getEncodeDecodeConverter:function(){var e=function(e,n){return r.isFalsy(n)?"":e===i.ModelBinder.Constants.ModelToView?t.reqres.request("decode:utf8",n):t.reqres.request("encode:utf8",n)};return e},getBooleanToStringConverter:function(){var e=function(e,t){return e===i.ModelBinder.Constants.ModelToView?(t===!1||"false"===t||!r.isFalsy(t))&&t.toString():"true"==t};return e},getDataTypeAnalyticsConverter:function(){var e=function(e,t){return e===i.ModelBinder.Constants.ModelToView?"total"==t?"true":"false":"true"==t?"total":"approved"};return e},getStartDateConverter:function(){var e=function(e,t){return e===i.ModelBinder.Constants.ModelToView?a.formateDate(t):moment(t).startOf("day").utc().unix()};return e},getStartDateAnalyticsConverter:function(){var e=function(e,t){return e===i.ModelBinder.Constants.ModelToView?a.formateDateAnalytics(t):(t=new Date(t.replace(/-/g,"/")),moment(t).startOf("day").utc().unix())};return e},getEndDateConverter:function(){var e=function(e,t){return e===i.ModelBinder.Constants.ModelToView?a.formateDate(t):moment(t).endOf("day").utc().unix()};return e},getEndDateAnalyticsConverter:function(){var e=function(e,t){return e===i.ModelBinder.Constants.ModelToView?a.formateDateAnalytics(t):moment(t).endOf("day").utc().unix()};return e},decodeEncodeUtf8:function(e){return this.encodeUtf8(this.decodeUtf8(e))},compactInt:function(e,t){var i,n,o,r,s,a,l,c,u,d,h,p,f,g,m,_,v,y,w;if(t=t||0,t=Math.max(t,0),a=parseInt(e,10),h=a<0?"-":"",p=Math.abs(a),g=""+p,l=g.length,c=[13,10,7,4],i=["T","B","M","k"],p<1e3)return""+h+g;if(l>c[0]+3)return a.toExponential(t).replace("e+","x10^");for(v=0,y=c.length;v<y;v++)if(w=c[v],l>=w){s=w;break}return n=l-s+1,f=g.split(""),_=f.slice(0,n),r=f.slice(n,n+t+1),m=_.join(""),o=r.join(""),o.length<t&&(o+=""+new Array(t-o.length+1).join("0")),0===t?u=""+h+m+i[c.indexOf(s)]:(d=(+(""+m+"."+o)).toFixed(t),u=""+h+d+i[c.indexOf(s)]),u},insertParam:function(e,t,i){if(e.indexOf(t+"=")>=0){var n=e.substring(0,e.indexOf(t)),o=e.substring(e.indexOf(t)).substring(e.indexOf("=")+1);o=o.indexOf("&")>=0?o.substring(o.indexOf("&")):"",e=n+t+"="+i+o}else e+=e.indexOf("?")<0?"?"+t+"="+i:"&"+t+"="+i;return e},removeParam:function(e,t){var i=String(e),n=new RegExp("\\?"+t+"=[^&]*&?","gi");return i=i.replace(n,"?"),n=new RegExp("\\&"+t+"=[^&]*&?","gi"),i=i.replace(n,"&"),i=i.replace(/(\?|&)$/,""),n=null,i},handlePinterestShare:function(e){var i=s.getTitle(e),n=window.location!=window.parent.location?document.referrer:document.location.href,o=s.insertParam(n,"pixlee_album_photo_id",e.get("album_photo_id"));r.isFalsy(i)?(i=gon.current_album.campaign?"I just voted for my favorite photo!":"Check this photo out!",window.open("https://pinterest.com/pin/create/button/?url="+t.request("encode:utf8",o)+"&media="+t.request("encode:utf8",t.request("get:photo:tumbnail",e))+"&description="+t.request("encode:utf8",i),"_blank","height=450,width=600,toolbar=0,resizable=0")):(i=t.request("decode:utf8",i),window.open("https://pinterest.com/pin/create/button/?url="+t.request("encode:utf8",o)+"&media="+t.request("encode:utf8",t.request("get:photo:tumbnail",e))+"&description="+t.request("encode:utf8",i),"_blank","height=450,width=600,toolbar=0,resizable=0")),s.trackShare(e.get("album_photo_id"),o,"pinterest",void 0,o)},handleTwitterShare:function(e){var i,n=s.getTitle(e),o=window.location!=window.parent.location?document.referrer:document.location.href,a=s.insertParam(o,"pixlee_album_photo_id",e.get("album_photo_id"));n=r.isFalsy(n)?gon.current_album.campaign?"I just voted for my favorite photo! Vote for your fave: ":"Check this photo out! ":t.request("decode:utf8",n),i="facebook"==e.get("source")&&"video"==e.get("content_type")?null:t.request("get:photo:file:url","xl",e);var l={method:"stream.publish",link:a,image:i,name:t.request("decode:utf8",gon.current_album.title),description:t.request("decode:utf8",n),display:"popup",author:e.get("user_name")},c=window.location.protocol+"//"+window.location.host+Routes.open_graph()+"?descr="+t.request("encode:utf8",t.request("encode:utf8",l.description))+"&title="+t.request("encode:utf8",l.name)+"&img="+t.request("encode:utf8",t.request("get:photo:tumbnail",e))+"&bitly_url="+t.request("encode:utf8",shortUrl)+"&type=image&author="+t.request("encode:utf8",l.author),u="https://twitter.com/intent/tweet?url="+t.request("encode:utf8",c);window.open(u,"_blank","height=450,width=600,toolbar=0,resizable=0"),s.trackShare(e.get("album_photo_id"),a,"twitter",void 0,a)},get_short_url:function(e,i){t.request("get:config");o.getJSON("https://api-ssl.bitly.com/v3/shorten?",{format:"json",apiKey:"R_1437b1d85beb4300927d14a747f76eaf",login:"die",longUrl:e},function(e){i(e.data.url)})},handleFacebookShare:function(e){var i=s.getTitle(e),n=window.location!=window.parent.location?document.referrer:document.location.href,o=s.insertParam(n,"pixlee_album_photo_id",e.get("album_photo_id"));r.isFalsy(i)&&(i=gon.current_album.campaign?"I just voted for my favorite photo!":"Chec");var a;a="facebook"==e.get("source")&&"video"==e.get("content_type")?null:t.request("get:photo:file:url","xl",e);var l={method:"stream.publish",link:o,image:a,name:t.request("decode:utf8",gon.current_album.title),description:t.request("decode:utf8",i),display:"popup"},c=window.location.protocol+"//"+window.location.host+Routes.open_graph()+"?descr="+t.request("encode:utf8",t.request("encode:utf8",l.description))+"&title="+t.request("encode:utf8",l.name)+"&img="+t.request("encode:utf8",t.request("get:photo:tumbnail",e))+"&bitly_url="+t.request("encode:utf8",shortUrl)+"&type=image",u="https://www.facebook.com/sharer/sharer.php?u="+t.request("encode:utf8",c);window.open(u,"_blank","height=450,width=600,toolbar=0,resizable=0"),s.trackShare(e.get("album_photo_id"),o,"facebook",void 0,o)},handleTumblrShare:function(e){var i,n=s.getTitle(e),o=e.get("short_share_url"),a=window.location!=window.parent.location?document.referrer:document.location.href,l=s.insertParam(a,"pixlee_album_photo_id",e.get("album_photo_id"));n=r.isFalsy(n)?gon.current_album.campaign?"I just voted for my favorite photo!":"Check this photo out!":t.request("decode:utf8",n),i="https://www.tumblr.com/share/photo?clickthru="+t.request("encode:utf8",o)+"&source="+t.request("encode:utf8",t.request("get:photo:tumbnail",e))+"&caption="+t.request("encode:utf8",n),window.open(i,"_blank","height=450,width=600,toolbar=0,resizable=0"),s.trackShare(e.get("album_photo_id"),l,"tumblr",void 0,o)},handleFacebookShareV2:function(e){var i=s.getTitle(e);r.isFalsy(i)&&(i=gon.current_album.campaign?"I just voted for my favorite photo!":"Check this photo out!");var n=window.location!=window.parent.location?document.referrer:document.location,o=s.insertParam(n,"pixlee_album_photo_id",e.get("album_photo_id")),a=e.attributes.album_photo_id,c=gon.distinct_user_hash,u=null,d=window.location.protocol+"//"+window.location.host,h=l;h=s.insertParam(h,"descr",t.request("encode:utf8",t.request("encode:utf8",i))),h=s.insertParam(h,"title",t.request("encode:utf8",t.request("decode:utf8",gon.current_album.title))),h=s.insertParam(h,"img",t.request("encode:utf8",t.request("get:photo:tumbnail",e))),h=s.insertParam(h,"shareLink",t.request("encode:utf8",o)),h=s.insertParam(h,"album_photo_id",t.request("encode:utf8",a)),h=s.insertParam(h,"fingerprint",t.request("encode:utf8",c)),h=s.insertParam(h,"post_id",t.request("encode:utf8",u)),h=s.insertParam(h,"type","image"),h=s.insertParam(h,"source","facebook");var p=d+h;window.open(p,"_blank","height=450,width=600,toolbar=0,resizable=0")},handleTwitterShareV2:function(e){var i=e.get("user_name"),n=s.getTitle(e);r.isFalsy(n)&&(n=gon.current_album.campaign?"I just voted for my favorite photo!":"Check this photo out!");var o=window.location!=window.parent.location?document.referrer:document.location,a=s.insertParam(o,"pixlee_album_photo_id",e.get("album_photo_id")),c=e.attributes.album_photo_id,u=gon.distinct_user_hash,d=null,h=window.location.protocol+"//"+window.location.host,p=l;p=s.insertParam(p,"descr",t.request("encode:utf8",t.request("encode:utf8",n))),p=s.insertParam(p,"title",t.request("encode:utf8",t.request("decode:utf8",gon.current_album.title))),p=s.insertParam(p,"img",t.request("encode:utf8",t.request("get:photo:tumbnail",e))),p=s.insertParam(p,"shareLink",t.request("encode:utf8",a)),p=s.insertParam(p,"album_photo_id",t.request("encode:utf8",c)),p=s.insertParam(p,"fingerprint",t.request("encode:utf8",u)),p=s.insertParam(p,"post_id",t.request("encode:utf8",d)),p=s.insertParam(p,"type","image"),p=s.insertParam(p,"author",i),p=s.insertParam(p,"source","twitter");var f=h+p;window.open(f,"_blank","height=450,width=600,toolbar=0,resizable=0")},trackShare:function(e,t,i,n,r){clearTimeout(this.shareTimer),this.shareTimer=setTimeout(function(){var s;s="undefined"!=typeof n?n:null,parseInt(e)>0&&o.ajax({url:"/social/share",type:"post",data:{album_photo_id:parseInt(e),fingerprint:gon.distinct_user_hash,link:t,shortlink:r,provider:i,post_id:s},dataType:"json",success:function(e){0!==e.error_code}})},2e3)},getTitle:function(e){return gon.display_options.options&&!gon.display_options.options.showCaptions?"":r.isFalsy(e.attributes.title)?r.isFalsy(e.attributes.album_title)?!r.isFalsy(e.attributes.photo_title)&&e.attributes.photo_title:e.attributes.album_title:e.attributes.title},validateUrl:function(e){return/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},pingUrl:function(e,t,i){i=r.isFalsy(i)?this:i,o.ajax({url:Routes.ping_url_path(),dataType:"json",type:"GET",context:i,data:{url:e},success:t})},getAccountCurrencySymbol:function(){var e=gon.current_user.currency.toLowerCase();switch(e){case"usd":case"cad":case"aud":return"$";case"gbp":return"\xa3";case"eur":return"\u20ac";case"krw":return"\u20a9";default:return""}},hasPixleeAssistant:function(){return o("body").hasClass("hasPixleeAssistant")},createCookie:function(e,t,i){var n=new Date;n.setTime(n.getTime()+24*i*60*60*1e3);var o="; expires="+n.toGMTString();document.cookie=e+"="+t+o+"; path=/; domain="+window.location.host.replace("www","")},readCookie:function(e){for(var t=e+"=",i=document.cookie.split(";"),n=0,o=i.length;n<o;n++){for(var r=i[n];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null},readFromBrowser:function(e){var t,i=!1;try{window.localStorage&&(i=!0)}catch(e){i=!1}if(i)try{t=window.localStorage.getItem(e)}catch(i){t=this.readCookie(e)}else t=this.readCookie(e);return t},storeInBrowser:function(e,t){var i,n=!1;try{window.localStorage&&(n=!0)}catch(e){n=!1}if("undefined"!=typeof t&&null!==t)if("object"==typeof t&&(t=JSON.stringify(t)),n)try{window.localStorage.setItem(e,t)}catch(n){i=this.createCookie(e,t,30)}else this.createCookie(e,t,30);if("undefined"==typeof t){if(n)try{i=window.localStorage.getItem(e)}catch(t){i=this.readCookie(e)}else i=this.readCookie(e);try{i=JSON.parse(i)}catch(e){i=i}return i}if(null===t)if(n)try{window.localStorage.removeItem(e)}catch(t){this.createCookie(e,"",-1)}else this.createCookie(e,"",-1)},getGUID:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},getAnonymousId:function(e){return arguments.length?(this.storeInBrowser("ajs_anonymous_id",e),this):(e=this.readFromBrowser("ajs_anonymous_id"))?e:(e=this.getGUID(),this.storeInBrowser("ajs_anonymous_id",e),this.readFromBrowser("ajs_anonymous_id"))}},a={formateDate:function(e){return this.end_date=moment.utc(1e3*e).local().format("MM/DD/YYYY"),this.end_date},formateDateAnalytics:function(e){return this.end_date=moment.utc(1e3*e).local().format("MM-DD-YYYY"),
this.end_date}},t.reqres.setHandlers({"decode:utf8":function(e){return s.decodeUtf8(e)},"encode:utf8":function(e){return s.encodeUtf8(e)},"escape:html":function(e){return s.escapeHtml(e)},"get:start:date:analytics:converter":function(){return s.getStartDateAnalyticsConverter()},"get:end:date:analytics:converter":function(){return s.getEndDateAnalyticsConverter()},"get:encode:decode:converter":function(){return s.getEncodeDecodeConverter()},"get:data:type:analytics:converter":function(){return s.getDataTypeAnalyticsConverter()},"get:boolean:to:string:converter":function(){return s.getBooleanToStringConverter()},"get:end:date:converter":function(){return s.getEndDateConverter()},"get:start:date:converter":function(){return s.getStartDateConverter()},"has:pixlee:assistant":function(){return s.hasPixleeAssistant()},"decode:encode:utf8":function(e){return s.decodeEncodeUtf8(e)},"compact:int":function(e,t){return s.compactInt(e,t)},murmurhash:function(e,t){return s.murmurhash3_32_gc(e,t)},"validate:url":function(e){return s.validateUrl(e)},"ping:url":function(e,t,i){return s.pingUrl(e,t,i)},"get:account:currency:symbol":function(){return s.getAccountCurrencySymbol()},"get:anonymous:id":function(){return s.getAnonymousId()}}),t.commands.setHandlers({"facebook:share":function(){s.handleFacebookShareV2.apply(this,arguments)},"tumblr:share":function(){s.handleTumblrShare.apply(this,arguments)},"pinterest:share":function(){s.handlePinterestShare.apply(this,arguments)},"twitter:share":function(){s.handleTwitterShareV2.apply(this,arguments)}})}),Pixlee.module("Utilities",function(e,t,i,n,o,r){var s=["beforeIncluded","afterIncluded"],a=function(e){for(var i=this,n=0;n<e.length;n++){var o=t.request("concern",e[n]);null!=o.beforeIncluded&&o.beforeIncluded.call(i.prototype,i,o),Cocktail.mixin(i,r.omit(o,s)),null!=o.afterIncluded&&o.afterIncluded.call(i.prototype,i,o)}},l=[{Marionette:["ItemView","LayoutView","CollectionView","CompositeView","AppRouter"]},{Entities:["Model","DeepModel","Collection","PaginatedCollection","ClientPaginatedCollection"]}];r.each(l,function(e){r.each(e,function(e,i){r.each(e,function(e){var n=window[i]||t[i];n[e].include=a})})})}),Pixlee.module("Utilities",function(e,t,i,n,o,r){r.extend(t,{navigate:function(e,n){return null==n&&(n={}),r.defaults(n,{trigger:!1}),t.execute("GA:Track",e,"primary","navigation.js"),i.history.navigate(e,n)},getCurrentRoute:function(){var e;return e=i.history.fragment,r.isEmpty(e)?null:e},startHistory:function(){if(i.history)return i.history.start()},navigateToExternalUrl:function(e,t){null==t&&(t={}),window.location=e}})}),Pixlee.module("Utilities",function(e,t,i,n,o,r){var s;s={register:function(e,t){var i;return null==(i=this._registry)&&(this._registry={}),this._registry[t]=e},unregister:function(e,t){return delete this._registry[t]},resetRegistry:function(){var e,t,i,n,o;n=this.getRegistrySize(),o=this._registry;for(t in o)e=o[t],e.region.destroy();i="There were "+n+" controllers in the registry, there are now "+this.getRegistrySize(),this.getRegistrySize()>0?console.warn(i,this._registry):console.log(i)},getRegistrySize:function(){return r.size(this._registry)}},t.commands.setHandler("register:instance",function(e,t){if("development"===gon.global.env)return s.register(e,t)}),t.commands.setHandler("unregister:instance",function(e,t){if("development"===gon.global.env)return s.unregister(e,t)}),t.reqres.setHandler("reset:registry",function(){return s.resetRegistry()})}),function(e){_.extend(e.Renderer,{render:function(e,t){if(0!=e){var i;if(i=JST[e],!i)throw"Template "+e+" not found!";return i(t)}}})}(Marionette),Pixlee.module("Utilities",function(e,t,i,n,o,r){var s;if(s={tries:0,queueArray:[],checkQueue:function(){var e=this;if(!this.getDistinctUserHash())return!1;var t=function(t){e.KeenClient||"undefined"==typeof Keen?e.KeenClient.recordEvent(t.event,t.obj):Keen.ready(function(){e.KeenClient=new Keen({projectId:keen_project_id,writeKey:keen_write_key,host:"tinyrick.pixlee.com"}),e.KeenClient.recordEvent(t.event,t.obj)})};r.each(this.queueArray,function(i){i.obj.distinct_user_hash||(i.obj.distinct_user_hash=e.getDistinctUserHash()),i.cookieEvent&&e.sendDataToParent(i.obj,i.cookieEvent),gon.fingerprint&&"none"!==gon.fingerprint&&(i.obj.fingerprint=gon.fingerprint),e.addKeenData(i.obj),t(i)}),this.queueArray=[]},addKeenData:function(e){var t=[];t.push({name:"keen:ip_to_geo",input:{ip:"ip_address"},output:"ip_geo_info"}),e.ip_address=gon.remote_ip,t.push({name:"keen:ua_parser",input:{ua_string:"user_agent"},output:"parsed_user_agent"}),e.user_agent=navigator.userAgent,t.push({name:"keen:url_parser",input:{url:"page_url"},output:"parsed_page_url"}),e.page_url=document.location.href,t.push({name:"keen:referrer_parser",input:{referrer_url:"referrer_url",page_url:"page_url"},output:"referrer_info"}),e.referrer_url=document.referrer,e.page_url=document.location.href,e.keen={addons:t}},queueEvents:function(){var e=this;setTimeout(function(){e.queueArray.length>0&&e.checkQueue(),e.queueEvents()},200)},sendDataToParent:function(e,t){var i={name:t,type:"action",source:"widget",destination:"parent",data:e};try{window.parent.postMessage(JSON.stringify(i),"*")}catch(e){document.referrer.indexOf("converse.com")===-1&&navigator.userAgent.indexOf("Opera")===-1&&console.warn(e)}},OpenedPhotowall:function(e,t){var i=this.defaultProperties();this.photos=e,i.photos=this.convertToStrings(e),i.num_photos=e?e.length:0,t?(i.mosaic=!0,this.widget="Mosaic"):this.widget="Photowall",i.widget=this.widget,gon.widget=this.widget,gon.pixlee_start&&(i.loadTime=this.getPerf()-gon.pixlee_start),this.openedWidget(i,this.widget)},OpenedGrid:function(e){var t=this.defaultProperties();this.photos=e,t.photos=this.convertToStrings(e),t.num_photos=e?e.length:0,this.widget="Grid",t.widget=this.widget,gon.widget=this.widget,gon.pixlee_start&&(t.loadTime=this.getPerf()-gon.pixlee_start),this.openedWidget(t,this.widget)},OpenedTap2Shop:function(e){var t=this.defaultProperties();this.photos=e,this.widget="Tap2Shop",t.photos=this.convertToStrings(e),t.num_photos=e?e.length:0,t.widget=this.widget,gon.widget=this.widget,gon.pixlee_start&&(t.loadTime=this.getPerf()-gon.pixlee_start),this.openedWidget(t,this.widget)},OpenedSingle:function(e){var t=this.defaultProperties();t.photos=String(e),t.num_photos=1,this.widget="Single",t.widget=this.widget,gon.widget=this.widget,gon.pixlee_start&&(t.loadTime=this.getPerf()-gon.pixlee_start),this.openedWidget(t,this.widget)},kpiEvent:function(e){var t=this.defaultProperties();t.widget=this.widget,t.kpiEvent=e;var i={obj:t,event:"KPI Event"};this.queueArray.push(i)},OpenedSlideshow:function(e){var t=this.defaultProperties();t.photos=this.convertToStrings(e),t.num_photos=1,this.widget="Slideshow",t.widget=this.widget,gon.widget=this.widget,gon.pixlee_start&&(t.loadTime=this.getPerf()-gon.pixlee_start),this.openedWidget(t,this.widget)},OpenedHorizontal:function(e,t){var i=this.defaultProperties();i.photos=this.convertToStrings(e),i.num_photos=e?e.length:0,t?(i.coverflow=!0,this.widget="Coverflow"):this.widget="Horizontal",i.widget=this.widget,gon.widget=this.widget,gon.pixlee_start&&(i.loadTime=this.getPerf()-gon.pixlee_start),this.openedWidget(i,this.widget)},OpenedVertical:function(e){var t=this.defaultProperties();t.photos=this.convertToStrings(e),t.num_photos=e?e.length:0,this.widget="Vertical",t.widget=this.widget,gon.widget=this.widget,gon.pixlee_start&&(t.loadTime=this.getPerf()-gon.pixlee_start),this.openedWidget(t,this.widget)},getPerf:function(){return"undefined"!=typeof performance&&"undefined"!=typeof performance.now&&"undefined"!=typeof gon?performance.now():"undefined"!=typeof Date&&"undefined"!=typeof Date.now&&"undefined"!=typeof gon?Date.now():void 0},LoadMore:function(e,t){var i=this.defaultProperties(),n=r.difference(e,this.photos);this.photos=e,i.photos=this.convertToStrings(n),i.num_photos=n?n.length:0,t?(i.mosaic=!0,this.widget="Mosaic"):this.widget="Photowall",i.subcollection="Load More";var o={obj:i,cookieEvent:"pixlee:interacted",event:"Interacted"};this.queueArray.push(o)},ActionLinkClicked:function(e,t){var i=this.defaultProperties();i.album_photo_id=e,i.action_link_url=t,"tap2shop"===gon.type&&(i.tap2shop=!0),i.subcollection="Action Clicked";var n={obj:i,cookieEvent:"pixlee:interacted",event:"Interacted"};this.queueArray.push(n)},OpenedPhoto:function(e,t,i){var n=this.defaultProperties();n.album_photo_id=e,n.currentDistilleryPage=t,n.direct_click=i,"tap2shop"===gon.type&&(n.tap2shop=!0),n.subcollection="Opened Lightbox";var o={obj:n,cookieEvent:"pixlee:opened:photo",event:"Interacted"};this.queueArray.push(o)},PhotoAdded:function(e){var t=this.defaultProperties();t.photo_id=e;var i={obj:t,event:"Photo Added"};this.queueArray.push(i)},NavLeft:function(e){var t=this.defaultProperties();t.widget_config=this.defaultWidgetConfig(),t.photos=this.convertToStrings(e),t.widget=this.widget},NavRight:function(e){var t=this.defaultProperties();t.widget_config=this.defaultWidgetConfig(),t.photos=this.convertToStrings(e),t.num_photos=e?e.length:0,t.widget=this.widget,t.subcollection="Nav Right";var i={obj:t,cookieEvent:"pixlee:interacted",event:"Interacted"};this.queueArray.push(i)},FilteredBy:function(e,t){var i=this.defaultProperties();i.widget=this.widget,i.filterBy=e,i.platform=t;var n={obj:i,event:"Filtered By"};this.queueArray.push(n)},PhotoShared:function(e,t){var i=this.defaultProperties();i.widget=this.widget,i.album_photo_id=e,i.platform=t,i.subcollection="Photo Shared";var n={obj:i,event:"Interacted"};this.queueArray.push(n)},StandaloneClickThrough:function(e){var t=this.defaultProperties();t.widget=this.widget,t.type=e,t.brand_url=gon.display_options.standaloneOptions.brandURL,t.is_mobile=gon.isMobile||!1,t.is_tablet=gon.isTablet||!1;var i={obj:t,event:"Click Through"};this.queueArray.push(i)},WidgetVisible:function(){var e=this.defaultProperties();e.widget_config=this.defaultWidgetConfig();var t={obj:e,event:"Widget Visible"};this.queueArray.push(t)},defaultProperties:function(){var e=gon.current_photo?gon.current_photo.album_id:gon.current_album.id,i=gon.current_photo?null:gon.recipe.filter_sort_id||gon.publication_id,n={album_id:e,account_id:gon.current_account.id,publication_id:i,distinct_user_hash:this.getDistinctUserHash(),sortType:gon.sortType,AB:gon.AB,parentURL:this.getParameterByName("parent_url",document.location.href),baseParentURL:this.getParameterByName("parent_url",document.location.href.split(/[?#]/)[0]),displayed:this.isDisplayed(),widget_version:t.version,business_name:gon.current_account.business_name,account_type:gon.current_account.account_type};return gon.current_album&&(n.album_type=gon.current_album.album_type),gon.widget_id&&(n.widget_id=parseInt(gon.widget_id)),gon.widget_id_param&&(n.widget_id_param=parseInt(gon.widget_id_param)),gon.widget_type?n.widget_type=gon.widget_type:n.widget_type="simple",gon.fingerprint&&(n.fingerprint=gon.fingerprint),gon.experiment_id&&gon.experiment_group&&(n.experiment_id=gon.experiment_id,n.experiment_group=gon.experiment_group),n},defaultWidgetConfig:function(){var e,t,i=o("#upload_now"),n=gon.display_options,r=n.headerOptions,s=n.interactiveWidgetOptions,a=gon.recipe?this.extractActiveFilters(gon.recipe.filters):null,l=!!i&&"none"!==i.css("display");e=n.is_datc?"DATC":n.showCallToAction?"CTA":"default",s&&(t={categories:s.categories,location:s.location,personalized:s.personalized,months:s.seasons,search:s.search,sort:s.sort,sortPopular:s.sortPopular,sortPrice:s.sortPrice,sortRecent:s.sortRecent,widgetType:s.widgetType,interactiveWidgetType:s.interactiveWidgetType,numOfCategories:s.selectedCategories?s.selectedCategories.length:0,selectedCategories:s.selectedCategories});var c={interactiveWidgetOptions:t||!1,interactive_social_hub:n.is_interactive||!1,interactive_social_hub_type:!!s&&s.interactiveWidgetType,header_layout:!!r&&r.layout,uploader:l,uploader_button_style:!!r&&r.button,lightbox:e,theme:n.css_preset_filename||n.css_preset_filename_v2||"",mobile_optimization:n.showViewport||!1,load_priority:n.speedOptimization||!1,album_filters:a,end_tile_uploader:n.headerOptions.end_tile_upload_button_background_showHide||!1};return c},defaultUserInfo:function(){return{isMobile:gon.is_mobile||!1}},extractActiveFilters:function(e){var t={};return r.each(e,function(e,i){var n=!1;if(Array.isArray(e))n=e.length>0;else if("object"==typeof e){var o=0;r.each(e,function(e){o+=e.length?e.length:0}),n=o>0}else n=!r.isFalsy(e);n&&(t[i]=e)}),t},getDistinctUserHash:function(){if("undefined"!=typeof analytics&&analytics.getAnonymousId)return analytics.getAnonymousId();var e={name:"pixlee:log:to:sentry",type:"action",source:"widget",destination:"parent",data:{messageText:"Failed to retrieve DUH",messageExtraFields:{tags:{source:"widgets",analytics:"undefined"!=typeof analytics,getAnonymousId:typeof analytics.getAnonymousId,file:"analytics_events.js"}}}};window.parent.postMessage(JSON.stringify(e),"*")},isDisplayed:function(){return this.getParameterByName("displayed")&&"none"==this.getParameterByName("displayed")?"none":"block"},getTime:function(){return Date.now()},convertToStrings:function(e){return e=r.map(e,function(e){return e+""}),e.join(",")},getCurrentItemIds:function(e,t){var i=[];e.firstItem,e.lastItem;return t.each(function(e){e.get("album_photo_id")&&i.push(e.get("album_photo_id"))}),i=i.slice(e.firstItem,e.lastItem+1)},getParameterByName:function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=i.exec(t);return null==n?null:decodeURIComponent(n[1].replace(/\+/g," "))},openedWidget:function(e,t){var i=this;e.widget=t,e.widget_config=this.defaultWidgetConfig();var n={obj:e,event:"Opened Widget",cookieEvent:"pixlee:create:cookie"};i.queueArray.push(n)},clickUploader:function(e,t){var i=this.defaultProperties();i.widget=this.widget,i.user_info=this.defaultUserInfo(),i.user_info.name=t.name,i.user_info.user_handle=t.user_handle,i.user_info.email=t.email,i.step=e,i.channel=t.channel,i.number_of_media=t.number_of_media,i.header_options=t.header_options,i.widget_type=t.widget_type,r.isFalsy(t.nav_to)||(i.nav_to=t.nav_to),r.isFalsy(t.nav_from)||(i.nav_from=t.nav_from);var n={obj:i,event:"Click Uploader",cookieEvent:"pixlee:interacted"};this.queueArray.push(n)},interactiveWidgetAnalytics:function(e,t,i){var n=this.defaultProperties(),o={obj:r.extend(n,t),event:e};if(r.isFalsy(i)||(o.cookieEvent=i),"Click Interactive Bar"===e||"Apply Interactive Bar"===e){n.subcollection=e;var s={obj:r.extend(n,t),event:"Interacted"};this.queueArray.push(s)}else this.queueArray.push(o)}},r.isFalsy(gon.previewMode)){window.addEventListener("message",function(e){var t;if(e.data){try{t=JSON.parse(e.data)}catch(e){return}t.name&&"pixlee:fingerprint"===t.name&&(gon.fingerprint=t.data,s.queueEvents())}}.bind(this));var a={name:"pixlee:get:fingerprint:from:parent",type:"action",destination:"all",source:"",data:{}};window.parent.postMessage(JSON.stringify(a),"*")}t.commands.setHandlers({"widget:visible":function(){s.WidgetVisible()},"opened:single":function(e){s.OpenedSingle(e)},"opened:photowall":function(e,t){s.OpenedPhotowall(e,t)},"opened:grid":function(e){s.OpenedGrid(e)},"opened:tap2shop":function(e){s.OpenedTap2Shop(e)},"opened:horizontal":function(e,t,i){var n=r.isEmpty(e)?[]:s.getCurrentItemIds(e,t);s.OpenedHorizontal(n,i)},"opened:slideshow":function(e,t){var i=s.getCurrentItemIds(e,t);s.OpenedSlideshow(i)},"opened:vertical":function(e,t){var i=r.isEmpty(e)?[]:s.getCurrentItemIds(e,t);s.OpenedVertical(i)},"load:more":function(e){s.LoadMore(e)},"action:clicked":function(e,t){s.ActionLinkClicked(e,t)},"opened:photo":function(e,t,i){s.OpenedPhoto(e,t,i)},"nav:left":function(e,t){var i=s.getCurrentItemIds(e,t);s.NavLeft(i)},"nav:right":function(e,t){var i=s.getCurrentItemIds(e,t);s.NavRight(i)},"photo:shared":function(e,t){s.PhotoShared(e,t)},"kpi:event":function(e){s.kpiEvent(e)},"photo:added":function(e){s.PhotoAdded(e)},"filtered:by":function(e,t){s.FilteredBy(e,t)},"standalone:click:through":function(e){s.StandaloneClickThrough(e)},"click:uploader":function(e,t){s.clickUploader(e,t)},"interactive:widget:analytics":function(e,t,i){s.interactiveWidgetAnalytics(e,t,i)}})}),function(){Routes=Routes||{},Routes.backbone={photowall_path:"photowall",horizontal_path:"horizontal"},Routes.returnRoute=function(e){return e.insertAt(0,"#")},Routes.distillery_analytics_album_path=function(e,t){return this.setDefaults(),this.config.distilleryUrl+this.config.distilleryUrlAnalyticsAlbums+"/"+e+"/"+t+"?api_key="+this.currentUser.single_access_token},Routes.distillery_accounts_album_path=function(e,t){return this.setDefaults(),this.config.distilleryUrl+this.config.distilleryUrlAnalyticsAccounts+"/"+e+"/"+t+"?api_key="+this.currentUser.single_access_token},Routes.distillery_analytics_location_path=function(){return this.setDefaults(),this.config.distilleryAnalyticsUrl+"v1/albums/"+this.currentAlbum.id+"/locations?api_key="+this.currentUser.single_access_token},Routes.photos_album_add_path=function(e,t){return this.setDefaults(),this.config.pixleePhotosServer+e+"/"+t+"/add"},Routes.photowall_item_path=function(e){return this.returnRoute(Routes.backbone.photowall_path+"/"+e)},Routes.horizontal_item_path=function(e){return this.returnRoute(Routes.backbone.horizontal_path+"/"+e)},Routes.settings_item_path=function(e){return this.returnRoute(Routes.backbone.settings_path+"/"+e)},Routes.analytics_item_path=function(e){return this.returnRoute(Routes.backbone.analytics_path+"/"+e)},Routes.analytics_item_details_path=function(e,t){return Routes.backbone.analytics_path+"/"+e+"/"+t},Routes.analytics_accounts_details_path=function(e){return Routes.backbone.analytics_path+"/"+e},Routes.albums_item_path=function(e){return this.returnRoute("albums/"+e)},Routes.inbox_item_path=function(e){return this.returnRoute("inbox/"+e)},Routes.album_settings_path=function(e){return this.returnRoute("albums/settings/"+e)},Routes.album_publish_path=function(e){return this.returnRoute("albums/publish/"+e)},Routes.album_collect_path=function(e){return this.returnRoute("albums/collect/"+e)},Routes.distillery_albums_path=function(){return this.setDefaults(),this.config.distilleryUrl+this.config.distilleryUrlMyAlbums+"?api_key="+this.currentUser.single_access_token},Routes.distillery_inbox_path=function(){return this.setDefaults(),this.config.distilleryUrl+this.config.distilleryInboxUrl+"?api_key="+this.currentUser.single_access_token},Routes.distillery_photo_path=function(e){return this.setDefaults(),this.config.distilleryUrl+this.config.distilleryPhotoUrl+"?api_key="+this.currentUser.single_access_token+"&album_photo_id="+e},Routes.distillery_photo_crud_path=function(e){return this.setDefaults(),this.config.distilleryUrl+this.config.distilleryPhotoCrudUrl+"/"+e+"?api_key="+this.currentUser.single_access_token},Routes.distillery_widgets_path=function(){return this.setDefaults(),this.config.distilleryUrl+this.config.distilleryQueryUrl+"?api_key="+this.currentUser.single_access_token+"&updated_at="+this.currentAlbum.filtersort_cache_updated_at},Routes.setDefaults=function(){null==this.config&&(this.config=Pixlee.reqres.request("get:config").toJSON()),Routes.setDefaultUser()},Routes.setDefaultUser=function(){null==this.currentUser&&(this.currentUser=Pixlee.request("get:current:user").toJSON()),null==this.currentAlbum&&(this.currentAlbum=Pixlee.request("get:current:album").toJSON())},Routes.social_login_path=function(e,t,i){return"/auth/"+e+"?widget="+t+"&state="+i},Routes.linkTo=function(e,t,i){return null==i&&(i={}),_.defaults(i,{https:!1,backbone:!1}),i.https&&e.replace("http://").replace("https://"),i.backbone&&(t="#"+t),e+t}}(),Pixlee.module("Utilities",function(e,t,i,n,o,r){var s,a,l,c=this;c.fingerprint="0",s={addKeenData:function(e){var t=[];t.push({name:"keen:ip_to_geo",input:{ip:"ip_address"},output:"ip_geo_info"}),e.ip_address=gon.remote_ip,t.push({name:"keen:ua_parser",input:{ua_string:"user_agent"},output:"parsed_user_agent"}),e.user_agent=navigator.userAgent,t.push({name:"keen:url_parser",input:{url:"page_url"},output:"parsed_page_url"}),e.page_url=document.location.href,t.push({name:"keen:referrer_parser",input:{referrer_url:"referrer_url",page_url:"page_url"},output:"referrer_info"}),e.referrer_url=document.referrer,e.page_url=document.location.href,e.keen={addons:t}},trackAnalytics:function(e,t){var i=this;i.KeenClient||"undefined"==typeof Keen?(i.addKeenData(t),i.KeenClient.recordEvent(e,t)):Keen.ready(function(){i.KeenClient=new Keen({projectId:keen_project_id,writeKey:keen_write_key,host:"tinyrick.pixlee.com"}),i.addKeenData(t),i.KeenClient.recordEvent(e,t)})},facebookLogin:function(e){var t;t=e?a.photos_social_login_path("facebook",!1,c.fingerprint):a.social_login_path("facebook",!1,c.fingerprint),a.popupwindow(t,"Facebook Login",1e3,600)},twitterLogin:function(e){var t;t=e?a.photos_social_login_path("twitter",!1,c.fingerprint):a.social_login_path("twitter",!1,c.fingerprint),a.popupwindow(t,"Twitter Login",1e3,600)},tumblrLogin:function(e){var t;t=e?a.photos_social_login_path("tumblr",!1,c.fingerprint):a.social_login_path("tumblr",!1,c.fingerprint),a.popupwindow(t,"Tumblr Login",1e3,600)},instagramLogin:function(e){var t;t=e?a.photos_social_login_path("instagram",!1,c.fingerprint):a.social_login_path("instagram",!1,c.fingerprint),a.popupwindow(t,"Instagram Login",1e3,600)},facebookLogout:function(e){a.logoutSocial("facebook",e)},twitterLogout:function(e){a.logoutSocial("twitter",e)},tumblrLogout:function(e){a.logoutSocial("tumblr",e)},instagramLogout:function(e){a.logoutSocial("instagram",e)},facebookLoginWidget:function(){var e=Routes.social_login_path("facebook",!0,c.fingerprint);a.popupwindow(e,"Facebook Login",1e3,600)},twitterLoginWidget:function(){var e=Routes.social_login_path("twitter",!0,c.fingerprint);a.popupwindow(e,"Twitter Login",1e3,600)},tumblrLoginWidget:function(){var e=Routes.social_login_path("tumblr",!0,c.fingerprint);a.popupwindow(e,"Tumblr Login",1e3,600)},instagramLoginWidget:function(){var e=Routes.social_login_path("instagram",!0,c.fingerprint);a.popupwindow(e,"Instagram Login",1e3,600)},handlePinterestShare:function(e){var i=a.getTitle(e);i=t.request("decode:utf8",i),a.popupwindow("https://pinterest.com/pin/create/button/?media="+t.request("encode:utf8",t.request("get:photo:tumbnail",e))+"&description="+t.request("encode:utf8",i),"Share on pinterest",750,302),this.trackAnalytics("shared to social platform",{category:"social platforms",moduleName:c.moduleName,url:window.location.href,platform:"pinterest"})},handleTwitterShare:function(e){var i=a.getTitle(e);i=t.request("decode:utf8",i),a.popupwindow("https://twitter.com/intent/tweet?text="+t.request("encode:utf8",i)+" &url="+t.request("encode:utf8",t.request("get:photo:tumbnail",e)),"Share on Twitter",600,255),this.trackAnalytics("shared to social platform",{category:"social platforms",moduleName:c.moduleName,url:window.location.href,platform:"twitter"})},handleFacebookShare:function(e,i){function n(){c.trackAnalytics("shared to social platform",{category:"social platforms",moduleName:c.moduleName,url:window.location.href,platform:"facebook"})}var o=a.getTitle(e),s={method:"feed",picture:t.request("get:photo:tumbnail",e),description:t.request("decode:utf8",o),display:"popup"};r.isFalsy(i)||(s.to=i,s.from=i),FB.ui(s,n)},handleTumblrShare:function(e){var i=a.getTitle(e);i=t.request("decode:utf8",i),a.popupwindow("https://www.tumblr.com/share/photo?source="+t.request("encode:utf8",t.request("get:photo:tumbnail",e))+"&caption="+t.request("encode:utf8",i),"Share on Tumblr",450,428),this.trackAnalytics("shared to social platform",{category:"social platforms",moduleName:c.moduleName,url:window.location.href,platform:"tumblr"})}},a={social_login_path:function(e,i,n){var o=t.reqres.request("get:config").toJSON();return o.pixlee_backend_server+"auth/"+e+"?widget="+i+"&state="+n},photos_social_login_path:function(e,i,n){t.reqres.request("get:config").toJSON();return"/auth/"+e+"?widget="+i+"&state="+n},popupwindow:function(e,t,i,n){var o=void 0!=window.screenLeft?window.screenLeft:screen.left,r=void 0!=window.screenTop?window.screenTop:screen.top,s=screen.width/2-i/2+o,a=screen.height/2-n/2+r,l=window.open(e,t,"scrollbars=yes, width="+i+", height="+n+", top="+a+", left="+s);window.focus&&l.focus()},getTitle:function(e){return r.isFalsy(e.get("title"))?r.isFalsy(e.get("album_title"))?!r.isFalsy(e.get("photo_title"))&&e.attributes.photo_title:e.attributes.album_title:e.attributes.title},getFacebookAlbums:function(e,t,i){var n=[],o=i?"/me/albums?after="+i:"/me/albums";FB.api(o,"get",{access_token:e},function(o){for(var s=25,a={page:1,nextUrl:null,next:!1},l=0;l<o.data.length;l++){var c=o.data[l];c.photo_url="https://graph.facebook.com/"+c.id+"/picture?type=album&access_token="+e,n.push(c)}!r.isEmpty(o.paging)&&!r.isEmpty(o.paging.cursors)&&o.data.length>=s&&(a.next=!0,a.nextUrl=o.paging.cursors.after),r.isFalsy(i)&&(n.push({name:"Tagged Videos",photo_url:""}),n.push({name:"Uploaded Videos",photo_url:""})),t(n,a)})},logoutSocial:function(e,t){o.ajax({url:Routes.social_logout_path(e),dataType:"json",success:function(i){i&&t.success&&s.trackAnalytics("logout social platform",{category:"social platforms",moduleName:c.moduleName,url:window.location.href,platform:e})}})}},t.commands.setHandlers({"facebook:login":function(e){l=e,s.facebookLogin()},"twitter:login":function(e){l=e,s.twitterLogin()},"instagram:login":function(e){l=e,s.instagramLogin()},"tumblr:login":function(e){l=e,s.tumblrLogin()},"facebook:login:photos":function(e){l=e,s.facebookLogin(!0)},"twitter:login:photos":function(e){l=e,s.twitterLogin(!0)},"instagram:login:photos":function(e){l=e,s.instagramLogin(!0)},"tumblr:login:photos":function(e){l=e,s.tumblrLogin(!0)},"facebook:logout":function(e){s.facebookLogout(e)},"twitter:logout":function(e){s.twitterLogout(e)},"instagram:logout":function(e){s.instagramLogout(e)},"tumblr:logout":function(e){s.tumblrLogout(e)},"facebook:login:widget":function(e){l=e,s.facebookLoginWidget()},"twitter:login:widget":function(e){l=e,s.twitterLoginWidget()},"instagram:login:widget":function(e){l=e,s.instagramLoginWidget()},"tumblr:login:widget":function(e){l=e,s.tumblrLoginWidget()},"get:facebook:albums":function(e,t,i){a.getFacebookAlbums(e,t,i)},"social:login:success":function(e){"twitter"==e.source?t.request("get:current:user").set("twitter_status",{is_connected:!0,message:""}):"instagram"==e.source?t.request("get:current:user").set("instagram_status",{is_connected:!0,message:""}):"tumblr"==e.source?t.request("get:current:user").set("isConnectedToTumblr",!0):"facebook"==e.source&&t.request("get:current:user").set("facebook_status",{is_connected:!0,message:""}),t.request("get:current:user").fetch({reset:!0}),s.trackAnalytics("login social platform",{category:"social platforms",moduleName:c.moduleName,url:window.location.href,platform:e.source}),l(e),l=null},"photo:social:login:success":function(e){s.trackAnalytics("login social platform photos",{category:"social platforms",moduleName:c.moduleName,url:window.location.href,platform:e.source}),l(e),l=null},"open:share:pinterest":function(e){s.handlePinterestShare(e)},"open:share:twitter":function(e){s.handleTwitterShare(e)},"open:share:facebook":function(e,t){s.handleFacebookShare(e,t)},"open:share:tumblr":function(e){s.handleTumblrShare(e)}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.AppendUploaderTiles=n.Behavior.extend({events:{"click .uploader_tile":"clickUploaderTile"},collectionEvents:{sync:"onSync"},clickUploaderTile:function(){var e={name:"pixlee:show:uploader",type:"action",source:"widget",destination:"parent",data:{widgetId:window.location.href}};window.parent.postMessage(JSON.stringify(e),"*")},onSync:function(e,i){var n=this,s=gon.type,a=this.view.options.displayOptions.headerOptions,l=a.layout,c=a.end_tile_upload_button_background_showHide,u=1,d=(this.view.options.displayOptions.is_interactive,!r.isFalsy(t.displayOptions.get("hideIfLessThan"))||!r.isFalsy(gon.current_account.extra_fields.hideIfLessThan)),h=o("#frame"),p=o("ul.clearfix"),f=p.children(),g=o(".photo_block:visible"),m=0,_=0,v=0,y={name:"pixlee:widget:num:photos",type:"action",source:"widget",destination:"parent",data:{photoCount:n.view.collection?n.view.collection.length:0}};window.top.postMessage(JSON.stringify(y),"*");var w,b;d&&(b=r.isFalsy(t.displayOptions.get("hideIfLessThan"))?gon.current_account.extra_fields.hideIfLessThan:t.displayOptions.get("hideIfLessThan")),w=void 0!==b?n.view.collection.length>=b:n.view.collection.length,r.indexOf(t.request("get:current:user").get("features"),"remove_powered_by")!==-1||d&&!w||!w&&r.isFalsy(c)||(y={name:"pixlee:generate:attribution:link",type:"action",source:"widget",destination:"parent",data:{src:window.location.href,isStandard:"standard"===gon.current_album.album_type,isHiddenAB:"B"===gon.AB,landingPageURL:gon.current_account.extra_fields.landing_page_url}},window.parent.postMessage(JSON.stringify(y),"*")),g.length&&(m=g.width(),_=g.length*m,v=h.width()-_),"vertical"!==s&&"coverflow"!==s&&"horizontal"!==s||v>m&&(u=r.isFalsy(this.view.options.displayOptions.num_uploader_tiles)?Math.floor(v/m):this.view.options.displayOptions.num_uploader_tiles);var x="tile"===l?f.slice(1):f;if(this.view.collection.length&&x.first().hasClass("uploader_tile")&&o.each(x,function(e,t){return!!o(t).hasClass("uploader_tile")&&void t.remove()}),!r.isFalsy(this.view.options.displayOptions.headerOptions.end_tile_upload_button_background_showHide)&&(i.total>0&&r.isFalsy(i.next)||0===i.total&&1===i.page)){this.view.$el.find(".uploader_tile").remove();for(var k=JST["backbone/apps/common/templates/v2/_end_uploader_tile"](s),C=0;C<u;C++)p.append(k);this.view.sly&&this.view.sly.reload({silentScroll:!0})}if(1===i.page&&r.isFalsy(i.next)&&"photowall"!==s&&"mosaic_v2"!==s&&this.view.onRender(),r.isFalsy(this.view.sly)&&"photowall"!==s&&"mosaic_v2"!==s){var M=o("#frame"),S={horizontal:0,smart:1,activateMiddle:1,itemNav:"centered",activateOn:"click",mouseDragging:0,touchDragging:1,releaseSwing:1,startAt:0,scrollBy:0,speed:300,elasticBounds:1,easing:"easeOutExpo",prevPage:o(".prev"),nextPage:o(".next")};"coverflow"===s?(S.itemNav="forceCentered",S.horizontal=1,S.easing="swing"):"horizontal"===s&&(S.horizontal=1),this.sly=new Sly(M,S).init()}}})}),Pixlee.module("Behaviors",function(e,t,i,n){e.RefreshOnCssGenerated=n.Behavior.extend({onReloadSly:function(){var e=this;setTimeout(function(){e.view.sly.reload()},400)}})}),Pixlee.module("Behaviors",function(e,t,i,n,o){e.FilterPhotos=n.Behavior.extend({initialize:function(){var e=this;Cookies.json=!0;var i=t.widget.currentView.collection;i.once("sync",function(){var t=Cookies.get("pixlee_social_cookie");e.initialUrl=i.url(),t&&t.social_login&&t.social_login.social_id&&e.processCollection(t)}),t.commands.setHandlers({"social:login":function(t){e.processCollection(t)},"social:login:loaded":function(){e.socialLoginLoad()}})},ui:{location_alert_overlay:"#location_alert_content",location_alert_allow:"#location_alert_allow",location_alert_deny:"#location_alert_deny",sign_in:"#sign_in",logged_in_container:"#logged_in_container",search_box:"#search_box",loading_social_auth:"#loading_social_auth",dropdown_list:"#dropdown_list",filter_tile:".filter_tile",log_in_container:"#log_in_container",interaction_toggle:"#interaction_toggle",sort_votes:'[data-attr="sortByVotes"]'},events:{"click #sign_in":function(){this.ui.search_box.val(""),this.ui.loading_social_auth.css("visibility","visible");var e={name:"pixlee:show:social:connect",type:"action",source:"widget",destination:"parent",data:{widgetId:window.parentIFrame.getId()}};return window.parent.postMessage(JSON.stringify(e),"*"),!1},"click .filter_tile":function(e){t.commands.execute("filtered:by",o(e.currentTarget).attr("data-attr")),this.selectAllPhotosFilter(),this.showLoader(),this.ui.dropdown_list.hide();var i;t.widget.currentView.collection;return o(e.target).hasClass("active")?(this.ui.filter_tile.removeClass("active"),i=this.initialUrl+"&filterBy=allPhotos"):(this.ui.filter_tile.removeClass("active"),o(e.currentTarget).addClass("active"),i=this.initialUrl+"&filterBy="+o(e.currentTarget).attr("data-attr")),this.fetchCollection(i),!1},"keyup #search_box":function(e){clearTimeout(this.timer);var i=this;this.timer=setTimeout(function(){t.commands.execute("filtered:by","search");var n,r=o(e.currentTarget).val().trim();i.selectAllPhotosFilter(),o("#widget").find(".clearfix").addClass("loading_content_spinner"),n=r.length>0?i.initialUrl+"&filterBy=caption&caption="+r:i.initialUrl,i.fetchCollection(n),i.ui.filter_tile.removeClass("active")},1e3)},"click #clear_search":function(){return this.ui.search_box.val("").trigger("keyup"),!1},"click .filter_box":function(){return this.ui.search_box.val(""),
!1}},onRender:function(){var e=t.request("get:current:album"),i=e.get("campaign");i!==!0&&this.ui.sort_votes.hide()},fetchCollection:function(e){o(".load_more").hide();var i=t.widget.currentView.collection,n=this;i.paginator_core.url=e,i.url=function(){return e},i.goTo(1,{success:function(){n.hideLoader(),o(".load_more").show()},reset:!0})},socialLoginLoad:function(){this.ui.sign_in.show(),this.ui.loading_social_auth.css("visibility","hidden")},editCollectionUrl:function(e){var i;t.widget.currentView.collection;return i=e.source?this.initialUrl+"&platform="+e.source+"&access_token="+e.access_token+"&access_token_secret="+e.access_token_secret+"&social_id="+e.social_id:this.initialUrl+"&platform=email&email="+e},initCollectionEvents:function(){var e=this,i=t.widget.currentView.collection;e.defaultUrl=i.url(),i.on("sync",function(){e.hideLoader(),i.length>0?(o("#widget").find(".clearfix").removeClass("no_photos_view"),i.next&&o(".load_more").show(),o(".mosaic_frame").length>0&&o(".mosaic_frame").removeClass("no-pad")):(o("#widget").find(".clearfix").empty(),o(".mosaic_frame").length>0&&o(".mosaic_frame").addClass("no-pad"),o("#widget").find(".clearfix").addClass("no_photos_view"))})},signOut:function(){var e=this;this.showLoader(),Cookies.remove("pixlee_social_cookie"),this.ui.log_in_container.show(),this.ui.logged_in_container.hide(),this.hideDropdown(),this.ui.interaction_toggle.off("click");var t="click";"ontouchstart"in window&&(t="touchstart"),this.ui.logged_in_container.find("#dropdown_list").find(".dropdown_list_item").off(t);var i=e.defaultUrl;this.fetchCollection(i),o(".checked").removeClass("checked"),o(".dropdown_list_item").first().addClass("checked")},hideDropdown:function(){this.ui.logged_in_container.find("#dropdown_list").hide()},showLoader:function(){o("#widget").find(".clearfix").removeClass("no_photos_view").addClass("loading_content_spinner")},hideLoader:function(){o("#widget").find(".clearfix").removeClass("loading_content_spinner")},selectAllPhotosFilter:function(){this.ui.interaction_toggle.removeClass().addClass("all_photos"),this.ui.dropdown_list.find(".checked").removeClass("checked"),o('[data-attr="allPhotos"]').addClass("checked")},processCollection:function(e){var i=this;Cookies.set("pixlee_social_cookie",e,{expires:365}),i.initCollectionEvents();var n=t.widget.currentView.collection;if(!e.social_login)return!1;var r=this.editCollectionUrl(e.social_login);n.paginator_core.url=r,"facebook"!=e.platform&&"email"!=e.platform||o('.dropdown_list_item[data-attr="friendsPhotos"]').remove(),this.ModifiedUrl=r,this.ui.log_in_container.hide(),this.ui.logged_in_container.show(),this.ui.interaction_toggle.on("click",function(){i.ui.logged_in_container.find("#dropdown_list").toggle();var e=function(){o("body").click(function(){i.ui.dropdown_list.hide()})};e()});var s="click";"ontouchstart"in window&&(s="touchstart"),this.ui.logged_in_container.find("#dropdown_list").find(".dropdown_list_item").on(s,function(){if(o(this).hasClass("checked"))return!1;if("signOut"==o(this).attr("data-attr"))return i.signOut(),!1;i.ui.logged_in_container.find("#dropdown_list").find(".dropdown_list_item").removeClass("checked"),o("#desktop_tablet_view").find(".active").removeClass("active"),o(this).addClass("checked"),i.ui.interaction_toggle.attr("class",o(this).attr("data-text"));var r;if("nearMe"!=o(this).attr("data-attr")&&(i.currentSelection=o(this).attr("data-text")),"allPhotos"==o(this).attr("data-attr"))r=i.ModifiedUrl+"&filterBy=allPhotos",t.commands.execute("filtered:by","allPhotos"),i.hideDropdown();else if("nearMe"==o(this).attr("data-attr")){i.ui.location_alert_overlay.show();var s=function(e){i.ui.location_alert_allow.click(function(){i.hideDropdown(),i.showLoader(),i.ui.location_alert_overlay.hide(),o(".load_more").hide(),t.commands.execute("filtered:by",o(e).attr("data-attr"),"location"),navigator.geolocation&&(n.reset(),navigator.geolocation.getCurrentPosition(function(t){var n=t.coords.latitude,s=t.coords.longitude;return r=i.ModifiedUrl+"&filterBy="+o(e).attr("data-attr")+"&latitude="+n+"&longitude="+s,i.fetchCollection(r),i.hideDropdown(),!1}))})},a=function(){i.ui.location_alert_deny.click(function(){return i.showLoader(),i.selectAllPhotosFilter(),r=i.ModifiedUrl+"&filterBy=allPhotos",i.fetchCollection(r),i.ui.location_alert_overlay.hide(),i.hideDropdown(),!1})};s(this),a(this)}else if("caption"==o(this).attr("data-attr")){t.commands.execute("filtered:by",o(this).attr("data-attr"),"search");var l="hello";r=i.ModifiedUrl+"&filterBy="+o(this).attr("data-attr")+"&caption="+l,i.hideDropdown()}else t.commands.execute("filtered:by",o(this).attr("data-attr"),e.platform),r=i.ModifiedUrl+"&filterBy="+o(this).attr("data-attr"),i.hideDropdown();return o(".mosaic_frame").length>0&&o("#widget").find(".clearfix").empty(),"nearMe"!=o(this).attr("data-attr")?(i.showLoader(),i.fetchCollection(r),!1):void 0})}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.HideEmptyAlbumWidget=n.Behavior.extend({initialize:function(){r.isFalsy(t.displayOptions.get("hideIfLessThan"))&&r.isFalsy(gon.current_account.extra_fields.hideIfLessThan)||o("html").css("opacity",0)},collectionEvents:{sync:function(){var e=this,i=function(){var t={name:"pixlee:widget:num:photos",type:"action",source:"widget",destination:"parent",data:{photoCount:e.view.collection?e.view.collection.length:0}};window.top.postMessage(JSON.stringify(t),"*")},n=setInterval(function(){if("parentIFrame"in window){if(!e.view.collection.length&&r.isFalsy(t.displayOptions.get("is_interactive")))window.parentIFrame.close();else if(r.isFalsy(t.displayOptions.get("hideIfLessThan"))&&r.isFalsy(gon.current_account.extra_fields.hideIfLessThan))if(e.view.collection.length||!r.isFalsy(gon.previewMode)||e.checkedCollection){if(r.indexOf(t.request("get:current:user").get("features"),"remove_powered_by")===-1){var s={name:"pixlee:generate:attribution:link",type:"action",source:"widget",destination:"parent",data:{src:window.location.href,isStandard:"standard"===gon.current_album.album_type,isHiddenAB:"B"===gon.AB,landingPageURL:gon.current_account.extra_fields.landing_page_url}};window.parent.postMessage(JSON.stringify(s),"*")}}else o(".btn").hide();else{var a=r.isFalsy(t.displayOptions.get("hideIfLessThan"))?gon.current_account.extra_fields.hideIfLessThan:t.displayOptions.get("hideIfLessThan");e.view.collection.length<a&&r.isFalsy(t.displayOptions.get("is_interactive"))?window.parentIFrame.close():o("html").css("opacity",1)}i(),e.checkedCollection=!0,clearInterval(n)}},32)}}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.Lightbox=n.Behavior.extend({ui:{imgHolder:".img_holder",layerVideo:".layer_video"},events:{"click @ui.imgHolder":"openPhotoLightboxDebounced","keyup @ui.imgHolder":"keyboardEvents","click @ui.layerVideo":"openVideoLightboxDebounced"},initialize:function(){this.openPhotoLightboxDebounced=r.debounce(this.openPhotoLightbox,300,!0),this.openVideoLightboxDebounced=r.debounce(this.openVideoLightbox,300,!0)},onShow:function(){"undefined"!=typeof gon.show_lightbox&&r.isFalsy(gon.show_lightbox)&&(this.ui.imgHolder.addClass("noClick"),this.ui.layerVideo.addClass("noClick"))},keyboardEvents:function(e){13===e.keyCode&&this.openPhotoLightbox()},openPhotoLightbox:function(){var e={sortType:gon.sortType,widget:gon.widget,perPage:this.getPageSize()},i={name:"pixlee:open:lightbox",type:"action",source:"widget",destination:"lightbox",data:{modelData:JSON.stringify(this.view.model.collection.toJSONForLightbox()),indexToOpen:this.view.model.collection.indexOf(this.view.model),variables:JSON.stringify(e),current_album:t.request("get:current:album").toJSON(),display_options:t.request("get:display:options").toJSON()}};window.lastElement=this.ui.img_holder,window.parent.postMessage(JSON.stringify(i),"*")},openVideoLightbox:function(e){e.preventDefault();var i={sortType:gon.sortType,widget:gon.widget,perPage:this.getPageSize()},n={name:"pixlee:open:lightbox",type:"action",source:"widget",destination:"lightbox",data:{modelData:JSON.stringify(this.view.model.collection.toJSONForLightbox()),indexToOpen:this.view.model.collection.indexOf(this.view.model),variables:JSON.stringify(i),current_album:t.request("get:current:album").toJSON(),display_options:t.request("get:display:options").toJSON()}};window.parent.postMessage(JSON.stringify(n),"*")},getPageSize:function(){try{return this.view.model.collection.perPage}catch(e){return 0}}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.Reviews=n.Behavior.extend({ui:{imageHolder:".img_holder",accesibilityImage:"img",textReview:".text_review_holder"},onShow:function(){this.reviewOptions=gon.display_options.reviewOptions||{},this.reviewOptions.displayReviews&&this.markAsReview()},reviewReducer:function(e,t){return e+t.num_reviews},hasReviews:function(){var e=this.view.model.get("products");if(e.length){var t=r.pluck(e,"reviews_info"),i=t[0]?t.reduce(this.reviewReducer,0):0;return i>0&&!r.isFalsy(this.ui.textReview.data("review-id"))}},isAdjacent:function(e){var t=this.ui.imageHolder.width(),i=o("#widget").width(),n=Math.floor(i/t);return n===e},convertToReviewTile:function(){var e=this.ui.accesibilityImage.attr("data-prod-image");this.view.$el.addClass("active_review"),this.ui.imageHolder.css("background-image","url("+e+")"),this.ui.accesibilityImage.attr("src",e),this.view.model.set("activeReview",!0)},markAsReview:function(){var e=this.view.model.collection,t=e.reviewSelectionOptions,i=this.reviewOptions.frequency||.35,n=e.perPage||15,o=n*i,r=Math.floor(n/o),s=Math.random()/2,a=.2,l=void 0!==t.lastSet?t.currentModelIndex-t.lastSet:0,c=Math.abs(r-t.gapNoise),u=this.hasReviews(),d=this.isAdjacent(l),h=!l||l>c&&!d,p=u&&h&&s<=i;p?(this.convertToReviewTile(),t.lastSet=t.currentModelIndex,t.gapNoise=Math.ceil(o*a)):t.gapNoise=0,t.currentModelIndex++}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.Share=n.Behavior.extend({ui:{socialButton:".social_button"},events:{"click @ui.socialButton":"onShare"},onShare:function(e){var i,n=o(e.currentTarget);n.hasClass("pixlee_fshare")?i="facebook":n.hasClass("pixlee_tweet")?i="twitter":n.hasClass("pixlee_pinit")?i="pinterest":n.hasClass("pixlee_tumblr")&&(i="tumblr"),t.execute(i+":share",this.view.model),t.commands.execute("photo:shared",this.view.model.get("album_photo_id"),i);var s=r.map(this.view.model.get("products"),function(e){return{name:decodeURIComponent(e.title),sku:e.sku,imageUrl:decodeURIComponent(e.image),linkUrl:decodeURIComponent(e.link)}}),a={name:"pixlee:social:share",type:"action",source:"widget",destination:"parent",data:{socialNetwork:i,products:s}};window.parent.postMessage(JSON.stringify(a),"*")}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.ShowPdpCaption=n.Behavior.extend({initialize:function(){this.view.templateHelpers=this.view.templateHelpers||{},Cocktail.mixin(this.view.templateHelpers,this.templateHelpers)},templateHelpers:{isPdpCaption:function(){return!r.isFalsy(t.request("get:display:options").get("pdpCaption"))},getPdpCaption:function(){var e=t.request("get:display:options").get("pdpCaption");return t.request("decode:utf8",e)}}})}),Pixlee.module("Behaviors",function(e,t,i,n){e.SocialConnect=n.Behavior.extend({initialize:function(){var e=this,i=t.widget.currentView.collection;e.defaultUrl=i.url(),i.on("sync",function(){e.getLoginStatus()})},events:{"click #facebook_login":function(){var e=this;t.execute("facebook:login:photos",function(t){e.processCollection("facebook",t)})},"click #instagram_login":function(){var e=this;t.execute("instagram:login:photos",function(t){e.processCollection("instagram",t)})},"click #twitter_login":function(){var e=this;t.execute("twitter:login:photos",function(t){e.processCollection("twitter",t)})}},processCollection:function(){var e=t.widget.currentView.collection;e.reset(),e.fetch()},getLoginStatus:function(){}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.SubmitContentValidation=n.Behavior.extend({ui:{submitContent:"#submit_content_button"},onShow:function(){this.ui.submitContent.one("click",this.submitContent.bind(this))},submitContent:function(){var e=!0;this.view.ui.nameInput.find(".error").hide(),this.view.ui.emailInput.find(".error").hide(),this.view.ui.emailInput.find(".validate").hide(),this.view.ui.pixleeTosHolder.find(".error").hide(),this.view.ui.dobInput.find(".error").hide();var t=[this.checkDob(),this.checkFullName(),this.checkEmail(),this.checkPixleeAgreementTos(),this.checkClientAgreementTos(),this.checkAdditionalFields()];e=r.all(t),e?(this.ui.submitContent.addClass("disabled"),this.view.trigger("update:breadcrumb","disabled"),this[this.view.options.source+"Submit"](),this.view.triggerMethod("validation:success")):this.ui.submitContent.one("click",this.submitContent.bind(this))},checkDob:function(){var e=!0;if(this.view.ui.dobInput.is(":visible")){var t=moment(this.view.ui.dobInputText.val(),"YYYY-MM-DD"),i=moment();t.isValid()&&t.isBefore(i)&&t.isAfter("1920-01-01")?this.view.model.set("dob",t.format("MM-DD-YYYY")):(this.view.ui.dobInput.find(".error").show(),e=!1)}return e},checkFullName:function(){var e=!0;return r.isFalsy(this.view.ui.fullNameInputText.val())?(this.view.ui.nameInput.find(".error").show(),e=!1):("facebook"===this.view.options.source&&this.view.model.set("facebook_user_name",this.view.ui.fullNameInputText.val()),this.view.model.set("full_name",this.view.ui.fullNameInputText.val())),e},checkEmail:function(){var e=!0;if(r.isFalsy(this.view.ui.emailInputText.val()))this.view.ui.emailInput.find(".error").show(),e=!1;else{var t=/\S+@\S+\.\S+/;t.test(this.view.ui.emailInputText.val())?(this.view.ui.emailInput.find(".validate").hide(),this.view.model.set("email_address",this.view.ui.emailInputText.val())):(this.view.ui.emailInput.find(".validate").show(),e=!1)}return e},checkPixleeAgreementTos:function(){var e=this.view.ui.pixleeTosCheckbox.is(":checked");return this.view.ui.pixleeTosHolder.find(".error").toggle(!e),e},checkClientAgreementTos:function(){var e=!0;return this.view.ui.clientTosHolder.is(":visible")&&(e=this.view.ui.clientTosCheckbox.is(":checked"),this.view.ui.clientTosHolder.find(".error").toggle(!e)),e},checkAdditionalFields:function(){var e=!0;return o(".additional_tos_input").length>0&&o(".additional_tos_input").each(function(){var e=o(this),t=e.find("input"),i=t.is(":checked");e.find(".error").toggle(!i)}.bind(this)),this.view.ui.additionalField.each(function(){var t=o(this),i=t.hasClass("required");r.isFalsy(t.find(".additional_input").val())?i&&(e=!1,t.find(".error").show()):(t.find(".error").hide(),this.view.model.set(t.find("label").html(),t.find(".additional_input").val()))}.bind(this)),e},instagramSubmit:function(){var e=this.createPhotoCollection(this.view.collection.models),i=t.request("get:current:album"),n=this.createPhotoObj(this.view.connectedUser.toJSON(),e,"instagram",i.get("id"));this.submitPhotos(n,this)},facebookSubmit:function(){var e=t.request("get:current:album"),i=this.createPhotoCollection(this.view.collection.models),n=this.createPhotoObj(this.view.connectedUser.toJSON(),i,"facebook",e.get("id"));this.submitPhotos(n,this)},desktopSubmit:function(){for(var e=this,i=t.request("get:config").toJSON(),n=t.request("get:current:user").toJSON(),s=this.view.collection.models,a=i.distilleryUrl+"inbound/v1/create_cp?api_key="+n.single_access_token+"&time_stamp="+Date.now(),l=0;l<s.length;l++){var c=s[l],u=("#file_"+c.get("uid"),t.request("get:current:album").get("id")),d={album_id:u,title:r.isFalsy(c.get("caption"))?null:c.get("caption"),email:this.view.model.get("email_address"),username:this.view.model.get("full_name"),connected_user:this.view.connectedUser.toJSON()};c.set("album_id",u),o.ajax({type:"POST",url:a,contentType:"application/json",dataType:"json",data:JSON.stringify(d),success:e.successCallback,context:{model:c}})}},successCallback:function(e){var i,n=this.model.get("files"),s=t.request("decode:utf8",n[0].name).replace(/[\`\'\'\(\)\/\+\%]/gi,"_"),a=e.path+s;this.model.set("photoId",e.album_photo_id),n[0].fileKey=a,i=r.isFalsy(this.model.attributes.form)||r.isFalsy(this.model.attributes.form.length)?o("#drag_drop_title"):this.model.attributes.form,i.find("input[name=key]").val(a),i.find("input[name=Filename]").val(s),i.find("input[name=policy]").val(e.encoded_policy),i.find("input[name=signature]").val(e.signature),i.find("input[name=AWSAccessKeyId]").val(e.access_key||"AKIAIKHXR6UNQEPW3KTA"),i.find("input[name=Content-Type]").val(n[0].type),this.model.attributes.submit()},createPhotoCollection:function(e){for(var i=[],n=0;n<e.length;n++)i.push({id:e[n].get("id"),type:e[n].get("type"),caption:t.request("encode:utf8",e[n].get("caption")),extra_data:e[n].get("extra_data")});return i},createPhotoObj:function(e,t,i,n){var s={uploader_additional_fields:{full_name:e.full_name,email_address:e.email_address,dob:e.dob}},a=o(".additional_field");a.length&&a.each(function(){var e=o(this),t=e.find(".error"),i=e.find(".additional_input"),n=e.hasClass("required");if(r.isFalsy(i.val()))n&&t.show();else{t.hide();var a=e.find("label").html();s.uploader_additional_fields[a]=i.val()}});var l={connectedUser:JSON.stringify(e),collection:JSON.stringify(t),source:i,album_id:n,extra_fields:JSON.stringify(s)};return l},submitPhotos:function(e){var t=this;o.ajax({type:"POST",url:"/uploadSocial",contentType:"application/json",dataType:"json",data:JSON.stringify(e),success:function(){t.view.trigger("update:bread:crumb","four"),t.view.trigger("show:confirm:panel")}})}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.SubmitPhotos=n.Behavior.extend({ui:{submitContent:"#submit_content",dragDropTitle:"#drag_drop_title"},onShow:function(){this.ui.submitContent.one("click",this,this.submitValidation)},submitValidation:function(e){var t=e.data,i=t.$el.find(".required"),n=!0;o.each(i,function(e,t){var i=o(t).parent();r.isFalsy(t.value)?(n=!1,i.addClass("error")):i.removeClass("error")}),n?(t[t.view.options.source+"Submit"](),t.view.triggerMethod("submit")):t.ui.submitContent.one("click",t,t.submitValidation)},instagramSubmit:function(){var e,i,n=t.request("get:current:album"),o=this.view.collection.models;e=this.createPhotoCollection(o),i=this.createPhotoObj(this.view.connectedUser.toJSON(),e,"instagram",n.get("id")),this.submitPhotos(i,this)},facebookSubmit:function(){var e,i,n=t.request("get:current:album"),o=this.view.collection.models;e=this.createPhotoCollection(o),i=this.createPhotoObj(this.view.connectedUser.toJSON(),e,"facebook",n.get("id")),this.submitPhotos(i,this)},desktopSubmit:function(){for(var e,i=t.request("get:config").toJSON(),n=t.request("get:current:user").toJSON(),s=this.view.collection.models,a=i.distilleryUrl+"inbound/v1/create_cp?api_key="+n.single_access_token+"&time_stamp="+Date.now(),l=this,c=0;c<s.length;c++){var u=s[c],d=("#file_"+u.get("uid"),t.request("get:current:album").get("id"));u.set("album_id",d),e={album_id:d,title:r.isFalsy(u.get("caption"))?null:u.get("caption"),email:this.view.model.get("email_address"),username:this.view.model.get("full_name"),connected_user:this.view.connectedUser.toJSON()},o.ajax({type:"POST",url:a,contentType:"application/json",dataType:"json",data:JSON.stringify(e),success:l.successCallback,context:{model:u}})}},successCallback:function(e){var i=this.model.get("files"),n=t.request("decode:utf8",i[0].name).replace(/[\`\'\'\(\)\/\+\%]/gi,"_"),s=e.path+n;this.model.set("photoId",e.album_photo_id),i[0].fileKey=s;var a;a=r.isFalsy(this.model.attributes.form)||r.isFalsy(this.model.attributes.form.length)?o("#drag_drop_title"):this.model.attributes.form,window.console&&(console.log("this.model.attributes.form "+this.model.toJSON()),console.log("$(#drag_drop_title).length "+o("#drag_drop_title").length),console.log("form.length "+a.length),console.log('$("#drag_drop_title").find("input[name=key]").length '+a.find("input[name=key]").length)),a.find("input[name=key]").val(s),window.console&&(console.log("key"),console.log(s),console.log(a.find("input[name=key]").val())),a.find("input[name=Filename]").val(n),window.console&&(console.log("Filename"),console.log(n),console.log(a.find("input[name=Filename]").val())),a.find("input[name=policy]").val(e.encoded_policy),window.console&&(console.log("policy"),console.log(e.encoded_policy),console.log(a.find("input[name=policy]").val())),a.find("input[name=signature]").val(e.signature),window.console&&(console.log("signature"),console.log(e.signature),console.log(a.find("input[name=signature]").val())),a.find("input[name=AWSAccessKeyId]").val(e.access_key||"AKIAIKHXR6UNQEPW3KTA"),window.console&&(console.log("AWSAccessKeyId"),console.log(e.access_key),console.log(a.find("input[name=AWSAccessKeyId]").val())),a.find("input[name=Content-Type]").val(i[0].type),window.console&&(console.log("Content-Type"),console.log(i[0].type),console.log(a.find("input[name=Content-Type]").val())),this.model.attributes.submit()},createPhotoCollection:function(e){for(var i=[],n=0;n<e.length;n++){var o=e[n],s=r.isFalsy(o.get("caption"))?"":o.get("caption");i.push({id:o.get("id"),type:o.get("type"),caption:t.request("encode:utf8",s),extra_data:o.get("extra_data")})}return i},createPhotoObj:function(e,t,i,n){var o={connectedUser:JSON.stringify(e),collection:JSON.stringify(t),source:i,album_id:n};return o},submitPhotos:function(e){var i=this;o.ajax({type:"POST",url:"/uploadSocial",contentType:"application/json",dataType:"json",data:JSON.stringify(e),success:function(){if(147890==t.request("get:current:album").get("id")){var e;e=t.displayOptions.get("thankYouUrl_input"),r.isFalsy(e)||(e=e+i.view.connectedUser.get("full_name")+"&email="+i.view.connectedUser.get("email_address"),window.top.location=e)}else i.view.trigger("show:confirm:panel")}})}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.Tap2ShopMobile=n.Behavior.extend({ui:{customCtaAnchor:".custom_call_to_action_anchor",layerVideo:".layer_video"},events:{"click @ui.customCtaAnchor":"ctaClicked","click @ui.layerVideo":"openVideoLightboxDebounced"},initialize:function(){this.currentAlbum=t.request("get:current:album"),this.displayOptions=t.request("get:display:options"),this.openVideoLightboxDebounced=r.debounce(this.openVideoLightbox,300,!0)},onShow:function(){var e=this.generateCtaLink();if(!r.isFalsy(e)){var i=t.request("decode:utf8",this.formatLink(e,this.view.model));this.ui.customCtaAnchor.attr("href",i),"video"===this.view.model.get("content_type")&&this.ui.layerVideo.attr("href",i)}},ctaClicked:function(){var e=this.generateCtaLink();r.isFalsy(e)||(t.execute("opened:photo",this.view.model.get("album_photo_id"),1,e),t.execute("action:clicked",this.view.model.get("album_photo_id"),e))},generateCtaLink:function(){var e="",t=this.view.model;return"product"!==this.currentAlbum.get("album_type")&&t.get("action_link")?e=t.get("action_link"):t.get("products").length>0?e=t.get("products")[0].link:gon.display_options.customCallToActionLink&&(e=gon.display_options.customCallToActionLink),e},openVideoLightbox:function(e){e.preventDefault();for(var t,i={sortType:gon.sortType,widget:gon.widget},n=this.view.model.collection.clone(),o=n.length-1;o>=0;o--)t=n.models[o],"video"!==t.get("content_type")&&n.models.splice(o,1);var r={name:"pixlee:open:lightbox",type:"action",source:"widget",destination:"lightbox",data:{modelData:JSON.stringify(n.toJSONForLightbox()),indexToOpen:n.indexOf(this.view.model),variables:JSON.stringify(i),current_album:this.currentAlbum.toJSON(),display_options:this.displayOptions.toJSON()}};window.parent.postMessage(JSON.stringify(r),"*")},formatLink:function(e){var t=this.displayOptions;if(r.isFalsy(t.get("url_scheme"))&&r.isFalsy(gon.current_account.extra_fields.url_scheme))return e;try{var i,n=e,o=this.currentAlbum.title.replace(/ /g,"-").toLowerCase(),s=encodeURIComponent(encodeURIComponent(o)),a=t.get("url_scheme")?t.get("url_scheme").url_scheme_title:gon.current_account.extra_fields.url_scheme.url_scheme_title;switch(a){case"kimpton_gacid":i="&gacid="+window.PixleeTags.Kimpton.GACID;break;case"kcp_pixlee":i="&om=pixlee:"+s+":"+this.currentAlbum.id;break;case"kcp_pixlee_v2":i="&pixlee="+s+":"+this.currentAlbum.id;break;default:i=t.get("url_scheme")?t.get("url_scheme").attribution_string:gon.current_account.extra_fields.url_scheme.attribution_string}return n.indexOf(i)!==-1?n:n+i}catch(t){return e}}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.UploadContentValidation=n.Behavior.extend({ui:{nextPanel:"#next",dragDropTitle:"#drag_drop_title"},onShow:function(){this.ui.nextPanel.one("click",this.submitValidation.bind(this))},submitValidation:function(){var e=this.$el.find(".required"),t=!0;o.each(e,function(e,i){var n=o(i).parent();r.isFalsy(i.value)?(t=!1,n.addClass("error")):n.removeClass("error")}),t?this.view.triggerMethod("show:submit:content:panel"):this.ui.nextPanel.one("click",this.submitValidation.bind(this))}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.Upload=n.Behavior.extend({ui:{uploadNow:"#upload_now"},initialize:function(){gon.previewMode&&window.addEventListener("message",this.receiveDesignEditorMessages,!1)},events:{"click @ui.uploadNow":"openUploader","keydown @ui.uploadNow":"onKeydownUploader"},onShow:function(){var e=t.request("get:display:options"),i=e.get("headerOptions");r.isFalsy(t.request("get:current:album").get("public_contribution"))&&Object.keys(i).length<=1?this.ui.uploadNow.remove():"undefined"!=typeof e.get("pdpShowUploader")&&r.isFalsy(e.get("pdpShowUploader"))&&this.ui.uploadNow.remove();var n=this.ui.uploadNow.is(":hidden"),s="tile"===i.layout;s&&r.isFalsy(i.showViewGallery||i.showDescription||i.showTitle||!n)&&o("#header_tile_container").remove()},onKeydownUploader:function(e){var t=13;e.keyCode===t&&this.openUploader()},openUploader:function(){var e={name:"pixlee:show:uploader",type:"action",source:"widget",destination:"parent",data:{widgetId:window.location.href}};this.designEditorDevice&&(e.data.designEditorDevice=this.designEditorDevice),window.parent.postMessage(JSON.stringify(e),"*")},receiveDesignEditorMessages:function(){var e=this;r.throttle(function(t){try{var i=JSON.parse(t.data);"pixlee:design:editor:device"===i.name&&(e.designEditorDevice=i.data.deviceType)}catch(e){return}},1e3)}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.UploaderValidation=n.Behavior.extend({events:{"click #done":"clickDone"},clickDone:function(){var e=!0,t=this;if(this.view.ui.nameInput.find(".error").hide(),this.view.ui.emailInput.find(".error").hide(),this.view.ui.emailInput.find(".validate").hide(),this.view.ui.pixleeTosHolder.find(".error").hide(),this.view.ui.dobInput.find(".error").hide(),this.view.ui.dobInput.is(":visible")){var i=moment(this.view.ui.dobInputText.val(),"MM-DD-YYYY");i.isValid()?this.view.model.set("dob",this.view.ui.dobInputText.val()):(this.view.ui.dobInput.find(".error").show(),e=!1)}if(r.isFalsy(this.view.ui.fullNameInputText.val())?(this.view.ui.nameInput.find(".error").show(),e=!1):("facebook"===this.view.options.source&&this.view.model.set("facebook_user_name",this.view.ui.fullNameInputText.val()),this.view.model.set("full_name",this.view.ui.fullNameInputText.val())),r.isFalsy(this.view.ui.emailInputText.val()))this.view.ui.emailInput.find(".error").show(),e=!1;else{var n=/\S+@\S+\.\S+/;n.test(this.view.ui.emailInputText.val())?(this.view.ui.emailInput.find(".validate").hide(),this.view.model.set("email_address",this.view.ui.emailInputText.val())):(this.view.ui.emailInput.find(".validate").show(),e=!1)}this.view.ui.pixleeTosCheckbox.is(":checked")?this.view.ui.pixleeTosHolder.find(".error").hide():(e=!1,this.view.ui.pixleeTosHolder.find(".error").show()),this.view.ui.clientTosHolder.is(":visible")&&(this.view.ui.clientTosCheckbox.is(":checked")?this.view.ui.clientTosHolder.find(".error").hide():(e=!1,this.view.ui.clientTosHolder.find(".error").show())),o(".additional_tos_input").length>0&&o(".additional_tos_input").each(function(){var t=o(this).find("input");t.is(":checked")?o(this).find(".error").hide():(e=!1,o(this).find(".error").show())}),this.view.ui.additionalField.each(function(){var i=o(this).hasClass("required");r.isFalsy(o(this).find(".additional_input").val())?i&&(e=!1,o(this).find(".error").show()):(o(this).find(".error").hide(),t.view.model.set(o(this).find("label").html(),o(this).find(".additional_input").val()))}),e&&this.view.triggerMethod("validation:success")}})}),Pixlee.module("Behaviors",function(e,t,i,n,o,r){e.Vote=n.Behavior.extend({ui:{voteButton:".vote_button",voteCount:".vote_count"},modelEvents:{voted:"onVoted",lightboxVote:"onLightboxVote"},events:{"click @ui.voteButton":"onVoteClicked"},onVoteClicked:function(){o.ajax({url:"/social/like",type:"POST",data:{id:this.view.model.get("album_photo_id"),distinct_user_hash:gon.distinct_user_hash||analytics.getAnonymousId(),fingerprint:gon.fingerprint},dataType:"json",success:function(e){0===e.error_code?(this.view.model.set("like_count",e.like_count),this.view.model.set("userVoted",!0),this.view.model.trigger("voted")):1===e.error_code||2===e.error_code||3===e.error_code&&(this.view.model.set("userVoted",!0),this.view.model.trigger("voted"))}.bind(this)})},onVoted:function(){this.ui.voteButton.addClass("active"),this.ui.voteCount.text(this.view.model.get("like_count"))},onLightboxVote:function(){this.ui.voteButton.addClass("active"),this.ui.voteButton.click()}}),e.CollectionVote=n.Behavior.extend({collectionEvents:{sync:function(){this.firstLoad=!0,this.onSync(this)}},initialize:function(){var e=this;t.commands.setHandlers({"vote:loaded":r.bind(this.onSync,this)}),window.addEventListener("message",function(t){var i;if(t.data){try{i=JSON.parse(t.data)}catch(e){return}if(i.name&&"pixlee:lightbox:vote"==i.name){var n=JSON.parse(i.data);r.each(e.view.collection.models,function(e){e.get("album_id")+"_"+e.get("album_photo_id")==n.album_id+"_"+n.album_photo_id&&(e.trigger("lightboxVote"),e.set("userVoted",!0))})}}},!1)},onSync:function(){var e=this;gon.pixlee_votes&&gon.pixlee_votes.length>0&&e.firstLoad&&r.each(e.view.collection.models,function(e){r.indexOf(gon.pixlee_votes,e.get("album_id")+"_"+e.get("album_photo_id"))!=-1&&(e.trigger("voted"),e.set("userVoted",!0))})}})}),Pixlee.module("Concerns",function(e,t,i,n,o,r){e.SetSponserUrl={setUrl:function(){r.isFalsy(params.header_sponserImage_input)||(header_sponserImage_input=params.header_sponserImage_input,t.displayOptions.set("header_sponserImage_input",header_sponserImage_input),headerView=_this.getHeaderView({model:t.request("get:current:album")}),_this.show(headerView,{region:layout.widget_header_region}))}}}),Pixlee.module("Concerns",function(e,t,i,n,o,r){e.headerHelpers={templateHelpers:function(){var e=this.options.displayOptions.headerOptions;return{getLayoutClass:function(){return r.isFalsy(e)?"":e.layout},getButtonClass:function(){return r.isFalsy(e)?"":e.button},getHeaderTitle:function(){return r.isFalsy(e)?"":e.title},getHeaderDescription:function(){return r.isFalsy(e)?"":e.description},showTitle:function(){return r.isFalsy(e)?"":e.showTitle},showDescription:function(){return r.isFalsy(e)?"":e.showDescription},isViewGallery:function(){return!r.isFalsy(e)&&e.showViewGallery},getViewGalleryText:function(){return e.viewGalleryTitle},getViewGalleryUrl:function(){return e.viewGalleryUrl},decode_utf8:function(e){return t.request("decode:utf8",e)}}}}}),Pixlee.module("Concerns",function(e,t,i,n,o,r){e.LayoutHelpers={initialize:function(){this.displayOptions=t.request("get:display:options"),gon.previewMode&&this.listenForMessage()},listenForMessage:function(){var e=r.throttle(function(e){try{var t=JSON.parse(e.data);"pixlee:css:generated"===t.name&&o("#header_banner_image img").attr("src",t.data.displayOptions.headerOptions.bannerImage||"")}catch(e){return}},1e3);window.addEventListener("message",e,!1)},templateHelpers:function(){var e=this,t=e.displayOptions.get("headerOptions");return{getLayoutClass:function(){return r.isFalsy(t)?"":t.layout},isHeaderV2:function(){return!r.isFalsy(t)&&Object.keys(t).length>1},isTile:function(){return"tile"===t.layout}}}}}),Pixlee.module("Concerns",function(e,t,i,n,o,r){e.perfectMosaicHelpers={calculatePhotoSizes:function(e){var t=this.collectionQueue.findWhere({queueModel:!0});this.collectionQueue.remove(t);var n=2*Math.floor(e/2),o=Math.floor(n/2),s=this.collectionQueue.length/4;s=1===r.random(0,1)?Math.floor(s):Math.ceil(s);var a,l=s,c=0;for(a=0;a<this.collectionQueue.length&&(l=s+a,c=this.calculateMosaicFit(this.collectionQueue,l,n,o),!(c>=0));a++);if(c<0)for(c=0,a=1;a<=s&&(l=s-a,c=this.calculateMosaicFit(this.collectionQueue,l,n,o),!(c>=0));a++)a===s&&(c=0);var u=this.collectionQueue.length-c,d=this.randomizeLargePhotos(this.collectionQueue,l,n,o,u);for(a=0;a<u;a++){var h=this.collectionQueue.shift(),p=r.contains(d,h);p?h.set("elementSize","large"):h.set("elementSize","small"),this.collection.add(h)}u>0&&0===this.collectionQueue.length&&(t=new i.Model({
queueModel:!0}),this.collectionQueue.add(t))},calculateMosaicFit:function(e,t,i,n){var o=2*i-t%n*4,r=(e.length-t-o)%i;return r},randomizeLargePhotos:function(e,t,i,n,o){var s=o-i<t?n:i,a=o-s;a=t<e.length&&a<t?t:a;var l=r.filter(e.models,function(e,t){if(t<a)return!0}),c=r.sample(l,t);return c}}}),Pixlee.module("Concerns",function(e,t,i,n,o,r){e.ReviewHelpers={templateHelpers:{pluckReviews:function(e){var t=e.reviews_info?e.reviews_info.reviews:[],i=r.map(t,function(t){return t.productImage=e.image,t.productName=e.title,t});return i},ensureUniqueReviews:function(e){return r.contains(gon.featuredReviewIds,e.id)},selectReview:function(){var e=this.products,t={id:0,score:0,content:"No Review",activeReview:!1};if(e.length){gon.featuredReviewIds=gon.featuredReviewIds||[];var i=r.reject(r.flatten(r.map(e,this.pluckReviews)),this.ensureUniqueReviews),n=Math.floor(Math.random()*i.length);i[n]&&(t=i[n],t.featured=!0),gon.featuredReviewIds.length>60&&(gon.featuredReviewIds=[]),gon.featuredReviewIds=gon.featuredReviewIds.concat(t.id)}this.selectedReview=t},getReview:function(){return r.isFalsy(this.selectedReview)&&this.selectReview(),this.selectedReview}}}}),Pixlee.module("Concerns",function(e,t,i,n,o,r){e.StandaloneHeaderHelpers={ui:{standaloneContainer:"#standalone_header",brandLogo:"#brand_logo",brandImageLink:"#banner_image_link",instagramProfile:"#instagram_profile",twitterProfile:"#twitter_profile",pinterestProfile:"#pinterest_profile",facebookProfile:"#facebook_profile",socialIcons:".social_profile_icons"},events:{"click @ui.brandLogo":"trackAnalytics","click @ui.brandImageLink":"trackAnalytics","click @ui.socialIcons":"trackAnalytics"},initialize:function(){this.displayOptions=t.request("get:display:options"),this.listenTo(this.displayOptions,{"change:standaloneOptions.bannerImage_showHide":this.render,"change:standaloneOptions.logoImage_showHide":this.render,"change:standaloneOptions.logoImage_backgroundImage":this.render,"change:standaloneOptions.bannerImage_backgroundImage":this.render,"change:standaloneOptions.logoImage_input":this.render,"change:standaloneOptions.bannerImage_input":this.render})},onShow:function(){var e=["instagram","twitter","pinterest","facebook"];r.each(e,this.showSocialIcon.bind(this))},trackAnalytics:function(e){t.execute("standalone:click:through",o(e.currentTarget).attr("id"))},showSocialIcon:function(e){var t=e+"Profile";r.isFalsy(this.displayOptions.get(e+"_username"))||this.ui[t].css("display","inline-block")},templateHelpers:function(){var e=this;return{shouldShowBannerImage:function(){return e.displayOptions.get("standaloneOptions.bannerImage_showHide")},shouldShowLogoImage:function(){return e.displayOptions.get("standaloneOptions.logoImage_showHide")},isStandalone:function(){return"standalone"===e.displayOptions.get("channel")},getLogoImage:function(){return r.isFalsy(e.displayOptions.get("standaloneOptions.logoImage_backgroundImage"))?"":"background-image: url("+e.displayOptions.get("standaloneOptions.logoImage_backgroundImage")+")"},getLogoRedirectURL:function(){return e.displayOptions.get("standaloneOptions.logoImage_input")||""},getBannerImage:function(){return r.isFalsy(e.displayOptions.get("standaloneOptions.bannerImage_backgroundImage"))?gon.previewMode?"":"display:none;":"background-image: url("+e.displayOptions.get("standaloneOptions.bannerImage_backgroundImage")+")"},getBannerImageURL:function(){return r.isFalsy(e.displayOptions.get("standaloneOptions.bannerImage_backgroundImage"))?"":e.displayOptions.get("standaloneOptions.bannerImage_backgroundImage")},getBannerRedirectURL:function(){return e.displayOptions.get("standaloneOptions.bannerImage_input")||""},getInstagramURL:function(){var t=e.displayOptions.get("instagram_username");return r.isFalsy(t)||r.isFalsy(t.user_name)?"":"https://www.instagram.com/"+t.user_name},getTwitterURL:function(){var t=e.displayOptions.get("twitter_username");return r.isFalsy(t)||r.isFalsy(t.user_name)?"":"https://www.twitter.com/"+t.user_name},getPinterestURL:function(){var t=e.displayOptions.get("pinterest_username");return r.isFalsy(t)||r.isFalsy(t.user_name)?"":"https://www.pinterest.com/"+t.user_name},getFacebookURL:function(){var t=e.displayOptions.get("facebook_username");return r.isFalsy(t)||r.isFalsy(t.social_id)?"":"https://www.facebook.com/"+t.social_id},getLayoutClass:function(){return e.displayOptions.get("headerOptions").layout},getButtonClass:function(){return e.displayOptions.get("headerOptions").button},getHeaderTitle:function(){return e.displayOptions.get("headerOptions").showTitle?e.displayOptions.get("headerOptions").title:""},getHeaderDescription:function(){return e.displayOptions.get("headerOptions").showDescription?e.displayOptions.get("headerOptions").description:""},isTile:function(){return"tile"===e.displayOptions.get("headerOptions").layout},getWidgetType:function(){return e.displayOptions.get("type")},isHeaderV2:function(){var t=e.displayOptions.get("headerOptions");return!r.isFalsy(t)&&Object.keys(t).length>1},isViewGallery:function(){return!r.isFalsy(e.displayOptions.get("headerOptions"))&&e.displayOptions.get("headerOptions").showViewGallery},getViewGalleryText:function(){return e.displayOptions.get("headerOptions").viewGalleryTitle},getViewGalleryUrl:function(){return e.displayOptions.get("headerOptions").viewGalleryUrl},getHeaderBannerImage:function(){return e.displayOptions.get("headerOptions").bannerImage||""},decode_utf8:function(e){return t.request("decode:utf8",e)}}}}}),Pixlee.module("Concerns",function(e,t,i,n,o,r){e.tabindexHelpers={onShow:function(){this.initTabListener()},initTabListener:function(){var e=this;document.addEventListener("keydown",function(t){e.highlightTabIndex(t.which,e)}),document.addEventListener("click",function(){e.removeHighlightTabIndex(e)})},highlightTabIndex:function(e,t){var i=e;setTimeout(function(){var e=9;if(i===e){this.removeHighlightTabIndex(this);var t=o(document.activeElement),n=t.closest(".photo_block");t.addClass("tab_focus"),r.isFalsy(this.sly)||r.isFalsy(n)||this.sly.activate(n),this.lastActiveElement=document.activeElement}}.bind(t),5)},removeHighlightTabIndex:function(e){if(!r.isFalsy(e.lastActiveElement)){var t=o(e.lastActiveElement);t.removeClass("tab_focus"),t.attr("tabindex",0),e.lastActiveElement=!1}}}}),Pixlee.module("Views",function(e,t,i,n,o){e.CollectionView=n.CollectionView.extend({childViewEventPrefix:"child",showLoader:function(){!this.loaded&&this.collection.length>0&&0===o("#loader").length&&(this.loader=o('<div id="loading_container" />').append('<div id="loader" />'),this.$el.after(this.loader))},removeLoader:function(){this.loaded=!0,this.loader&&this.loader.remove()}})}),Pixlee.module("Views",function(e,t,i,n){e.CompositeView=n.CompositeView.extend({childViewEventPrefix:"child"})}),Pixlee.module("Views",function(e,t,i,n){e.ItemView=n.ItemView.extend({})}),Pixlee.module("Views",function(e,t,i,n){e.Layout=n.LayoutView.extend({})}),Pixlee.module("Views",function(e,t,i,n,o,r){var s,a,l;s=n.View.prototype.remove,a=n.View.prototype.constructor,l=n.View.prototype.destroy,r.extend(n.View.prototype,{addOpacityWrapper:function(e){return null==e&&(e=!0),this.$el.toggleWrapper({className:"opacity"},e)},setInstancePropertiesFor:function(){var e,t,i,n,o;e=1<=arguments.length?__slice.call(arguments,0):[],n=r.pick.apply(r,[this.options].concat(__slice.call(e))),o=[];for(t in n)i=n[t],o.push(this[t]=i);return o},remove:function(){var e,t,i,n=this;return e=1<=arguments.length?__slice.call(arguments,0):[],null!=(i=this.model)&&"function"==typeof i.isDestroyed&&i.isDestroyed()?(t=this.$el.toggleWrapper({className:"removing"}),setTimeout(function(){t.remove(),s.apply(n,e)},350),this.$el.css({"-webkit-transform":"scale(0)","-moz-transform":"scale(0)","-ms-transform":"scale(0)","-o-transform":"scale(0)",transform:"scale(0)",opacity:"0"}),void 0):s.apply(this,e)},destroy:function(){var e;e=1<=arguments.length?__slice.call(arguments,0):[],i.ModelBinder&&this._modelBinder.unbind(),l.apply(this,e)},_modelBinder:void 0,constructor:function(e){this.configure(e||{});var t;t=1<=arguments.length?__slice.call(arguments,0):[],i.ModelBinder&&(this._modelBinder=new i.ModelBinder),a.apply(this,t)},configure:function(e){this.options&&(e=r.extend({},r.result(this,"options"),e)),this.options=e}})}),Pixlee.module("Components.Loading",function(e,t,i,n,o,r){e.LoadingController=t.Controllers.Application.extend({initialize:function(e){var t,i=e.view,n=e.config;switch(n=r.isBoolean(n)?{}:n,r.defaults(n,{loadingType:"spinner",entities:this.getEntities(i),debug:!1}),n.loadingType){case"opacity":this.region.currentView.$el.css("opacity",.5);break;case"spinner":t=this.getLoadingView(),this.show(t);break;case"analytics_spinner":t=this.getLoadingView(),this.show(t);break;default:throw new Error("Invalid loadingType")}this.showRealView(i,t,n)},showRealView:function(e,i,n){var o=this;t.execute("when:fetched",n.entities,function(){switch(n.loadingType){case"opacity":o.region.currentView.$el.removeAttr("style");break;case"spinner":o.region.currentView!==i&&e.destroy()}n.debug||o.show(e)})},getEntities:function(e){return r.chain(e).pick("model","collection").toArray().compact().value()},getLoadingView:function(){return new e.LoadingView},getAnalyticsLoadingView:function(){return new e.AnalyticsLoadingView},getSpinJsView:function(){return new e.SpinJsView}}),t.commands.setHandler("show:loading",function(t,i){return new e.LoadingController({view:t,region:i.region,config:i.loading})})}),Pixlee.module("Components.Loading",function(e,t){e.LoadingView=t.Views.ItemView.extend({template:"base/backbone/lib/components/loading/templates/_loader",id:"loading_container"}),e.AnalyticsLoadingView=t.Views.ItemView.extend({template:!1,className:"loading_data"})}),Pixlee.module("Components.Photowall",function(e,t,i,n,o,r){e.Controller=t.Controllers.Application.extend({initialize:function(e){var t,i=this;this.collectionView=e.view,this.photowallLayout=this.getPhotowallLayout(),gon.infiniteScroll?this.loadMoreButton=this.getInfiniteLoadMore():this.loadMoreButton=this.getLoadMoreButton(),this.noMorePhotosView=this.getNoMorePhotosView(),this.loadMoreLoadingView=this.getLoadMoreLoadingView(),this.firstLoad=!1,"horizontal"!==i.collectionView.options.type||gon.isMobileDevice||(this.arrows=this.getArrows()),i.includedPhotos=[],t="undefined"!=typeof gon.widget?r.debounce(this.onRender,100):this.onRender,this.collectionView.collection.on("sync",function(e,t){gon.sortType=t.sortType}),this.collectionView.on("images:loaded",t,this),this.listenTo(this.photowallLayout,"show",this.onLayoutShow),this.listenTo(this.collectionView.collection,"sync",this.checkEmpty),this.photowallLayout.on("load:more:clicked",this.onLoadMoreCLick,this),this.photowallLayout.on("nav:arrow:left",this.navLeft,this),this.photowallLayout.on("nav:arrow:right",this.navRight,this),this.photowallLayout.on("clear:filter",this.resetCollection,this),this.collectionView.on("load:more:horizontal",this.loadCollectionNextPageHorizontal,this);var n=r.debounce(this.onFilterSortChange,800);this.collectionView.collection.sort&&this.collectionView.collection.sort.on("change",n,this),this.collectionView.collection.filter&&this.collectionView.collection.filter.on("change",n,this);var o=function(){i.noMorePhotosView.destroy(),i.loadMoreButton.destroy(),i.loadMoreLoadingView.destroy()};this.listenTo(this.photowallLayout,"destroy",function(){this.destroy(),o()},this)},collectionFetched:function(){},getPhotowallLayout:function(t){var i;return t=t||{},i=this.getDefaultConfig(r.result(this.contentView,"photowall")),r.extend(i,t),new e.Layout({config:i,model:this.collectionView.collection})},checkEmpty:function(){var t=this;if(0===this.collectionView.collection.length&&"undefined"!=typeof gon.widget){var i=new e.Empty;t.show(i,{region:t.photowallLayout.photos_region,loading:!0})}},getLoadMoreButton:function(){return new e.LoadMoreButton},getInfiniteLoadMore:function(){return new e.InfiniteLoadMore},getArrows:function(){return new e.Arrows},getDefaultConfig:function(e){return e=e||{},r.defaults(e,{loadMoreFooter:!0})},getNoMorePhotosView:function(){return new e.NoMorePhotos},getLoadMoreLoadingView:function(){return new e.LoadMoreLoadingView},onLayoutShow:function(){var e=this;e.show(e.collectionView,{region:e.photowallLayout.photos_region,loading:!0})},svgSnap:function(){if(gon.v2&&!gon.packery){var e=300,t=mina.backout;[].slice.call(document.querySelectorAll(".photo_block")).forEach(function(i){var n=Snap(i.querySelector("svg")),o=n.select("path"),r={from:o.attr("d"),to:i.getAttribute("data-path-hover")};i.addEventListener("mouseenter",function(){o.animate({path:r.to},e,t)}),i.addEventListener("mouseleave",function(){o.animate({path:r.from},e,t)})})}},onRender:function(){var e=this,i=[];if(gon.packery){this.collectionView.$el.packery(),this.collectionView.changeRandomImage();var n=new Pusher("013dd678eb9d7aed4661"),s="album_"+gon.current_album.id+"_live",a=n.subscribe(s);a.bind("add_photo",function(e){gon.fresh_images.unshift(e.photo)})}if(this.svgSnap(),e.collectionView.$el.css("opacity",1),o("#widget_header_table, #photowall_description").css("opacity","1"),"photowall"===gon.widget)e.collectionView.collection.each(function(t){t.get("album_photo_id")&&r.indexOf(e.includedPhotos,t.get("album_photo_id"))===-1&&(i.push(t.get("album_photo_id")),e.includedPhotos.push(t.get("album_photo_id")))});else if("horizontal"==gon.widget&&!gon.isMobileDevice&&this.collectionView.sly){var l=this.collectionView.sly.rel;l.firstItem,l.lastItem;e.collectionView.collection.each(function(e){e.get("album_photo_id")&&i.push(e.get("album_photo_id"))}),i=i.slice(l.firstItem,l.lastItem+1)}else"horizontal"==gon.widget&&gon.isMobileDevice&&e.collectionView.collection.each(function(e){e.get("album_photo_id")&&i.push(e.get("album_photo_id"))});e.collectionView.collection.sortType&&(gon.sortType=e.collectionView.collection.sortType),"undefined"==typeof gon.widget||this.firstLoad?"undefined"!=typeof gon.widget&&"photowall"===gon.widget&&t.commands.execute("load:more",i):(t.commands.execute("widget:loaded",Date.now(),i),this.firstLoad=!0),r.isFalsy(e.photowallLayout)||r.isFalsy(e.photowallLayout.photowall_footer_region)||gon.packery||(r.isFalsy(this.collectionView.collection._currentCriteria)||(this.collectionView.collection.length>0?gon.isMobileDevice||e.show(e.noMorePhotosView,{region:e.photowallLayout.photowall_footer_region}):this.photowallLayout.photowall_footer_region.destroy()),!e.collectionView.collection.next||e.collectionView.collection.length>1&&e.collectionView.collection.length==e.collectionView.collection.remaining_count?"photowall"==gon.widget?e.show(e.noMorePhotosView,{region:e.photowallLayout.photowall_footer_region}):r.isFalsy(gon.widget)&&this.photowallLayout.photowall_footer_region.destroy():(e.collectionView.collection.next||e.collectionView.collection.length>1&&"horizontal"!==e.collectionView.options.type&&e.collectionView.collection.length<e.collectionView.collection.remaining_count)&&(!gon.infiniteScroll||gon.isMobileDevice||gon.infiniteScrollInitialized?gon.infiniteScroll&&!gon.isMobileDevice&&gon.infiniteScrollInitialized?(t.commands.execute("init:infinite:scroll"),e.show(e.loadMoreButton,{region:e.photowallLayout.photowall_footer_region})):e.show(e.loadMoreButton,{region:e.photowallLayout.photowall_footer_region}):(gon.infiniteScrollInitialized=!0,t.commands.setHandler("scrolled:to:bottom",function(){e.collectionView.collection.next&&e.onLoadMoreCLick()}),t.commands.execute("init:infinite:scroll"),e.show(e.loadMoreButton,{region:e.photowallLayout.photowall_footer_region}))),"horizontal"===e.collectionView.options.type&&!gon.isMobileDevice&&this.collectionView.collection.length>0?(e.show(e.arrows,{region:e.photowallLayout.photowall_footer_region}),e.calcHorizontal(),this.collectionView.loaded||this.collectionView.removeLoader(),this.collectionView.loadedMore&&o("#left-nav-arrow").show(),1===this.collectionView.sly.pages.length&&(o("#left-nav-arrow").hide(),o("#right-nav-arrow").hide())):"horizontal"===e.collectionView.options.type&&gon.isMobileDevice&&o("#photos_region").css("width",gon.containerWidth),this.collectionView.collection.trigger("images:loaded"))},calcHorizontal:function(){o(".arrows").css({"margin-top":"-"+(parseInt(this.getPhotoHeight(),10)+10)+"px",height:parseInt(this.getPhotoHeight(),10)+"px"})},getPhotoHeight:function(){return gon.v2?gon.display_options&&"small_photo"===gon.display_options.photoSize?"150px":gon.display_options&&"medium_photo"===gon.display_options.photoSize?"200px":gon.display_options?"260px":void 0:"210px"},onLoadMoreCLick:function(){if(gon.packery)return!1;var e=this;e.show(e.loadMoreLoadingView,{region:e.photowallLayout.photowall_footer_region}),e.loadCollectionNextPage()},navLeft:function(){this.collectionView.trigger("nav:arrow:left")},navRight:function(){this.collectionView.trigger("nav:arrow:right")},onFilterSortChange:function(){r.isFalsy(this.photowallLayout.photowall_footer_region)||this.photowallLayout.photowall_footer_region.destroy(),this.resetCollection()},loadCollectionNextPageHorizontal:function(){this.collectionView.collection.nextPage(),this.collectionView.loadedMore=!0},loadCollectionNextPage:function(){var e=this.collectionView.collection.getSelectedElements();this.collectionView.collection.nextPage(),r.each(e,function(e){e.select()})},resetCollection:function(){var e=this;this.collectionView.collection.remaining_count=void 0,this.collectionView.collection.trigger("count:change"),this.collectionView.$el.addClass("loading_content"),this.collectionView.collection.unSelectAll(),e.collectionView.collection.goTo(1,{reset:!0,success:function(){e.collectionView.$el.removeClass("loading_content"),r.isFalsy(e.collectionView.collection._currentCriteria)||e.collectionView.collection.filterBy(e.collectionView.collection._currentCriteria,!0)}})}}),t.reqres.setHandler("photowall:wrapper",function(t,i){var n;if(i=i||{},!t.collection)throw new Error("No collection found inside of photowall's collectionView");return n=new e.Controller({view:t,config:i}),n.photowallLayout})}),Pixlee.module("Components.Photowall",function(e,t){e.Layout=t.Views.Layout.extend({template:"base/backbone/lib/components/photowall/templates/layout",id:"photos_container",regions:{photos_region:"#photos_region",photowall_footer_region:"#photowall_footer_region"},triggers:{"click #load_more":"load:more:clicked","click #left-nav-arrow":"nav:arrow:left","click #right-nav-arrow":"nav:arrow:right"}}),e.Empty=t.Views.ItemView.extend({template:"base/backbone/lib/components/photowall/templates/_empty"}),e.LoadMoreButton=t.Views.ItemView.extend({template:"base/backbone/lib/components/photowall/templates/_load_more"}),e.InfiniteLoadMore=t.Views.ItemView.extend({template:"base/backbone/lib/components/photowall/templates/_infinite_load_more"}),e.LoadMoreLoadingView=t.Views.ItemView.extend({template:"base/backbone/lib/components/photowall/templates/_load_more_loading"}),e.NoSearchResults=t.Views.ItemView.extend({template:"base/backbone/lib/components/photowall/templates/_no_search_results"}),e.NoMorePhotos=t.Views.ItemView.extend({template:"base/backbone/lib/components/photowall/templates/_no_more_photos"}),e.Arrows=t.Views.ItemView.extend({template:"base/backbone/lib/components/photowall/templates/_arrows"})}),Pixlee.module("Entities",function(e,t){var i;i={getAlbum:function(t){var i;return i=new e.Album({id:t}),i.fetch(),i},setCurrentAlbum:function(t){return new e.Album(t)}},e.Album=e.Model.extend({urlRoot:function(){return Routes.v2_albums_path()},defaults:{public_viewing:!0,campaign:!1,moderation:!0,public_contribution:!0,vote_interval:"1 day",title:"",description:"",notify_user_when_approved:!1,has_default_action_link:!1},validation:{title:{required:!0,minLength:1},user_id:{required:!0,pattern:"number"},public_viewing:{required:!0},campaign:{required:!0},moderation:{required:!0},public_contribution:{required:!0}},labels:{title:"Album name"}}),t.reqres.setHandlers({"get:album":function(e){return i.getAlbum(e)},"set:current:album":function(e){return i.setCurrentAlbum(e)}}),t.commands.setHandlers({"copy:photos:to:album":function(e,t,n){i.copyPhotosToAlbum(e,t,n)}})}),Pixlee.module("Entities",function(e,t,i,n,o,r){var s;s={getPhotoFileUrl:function(e,i){return"https://static.pixlee.com/photos/"+i.get("id")+"/"+e+"/"+t.reqres.request("encode:utf8",i.get("data_file_name"))},getPhoto:function(t){var i;return i=new e.Photo({album_photo_id:t}),i.fetch({reset:!0}),i},newPhoto:function(){return new e.Photo},getPhotoThumbnailUrl:function(e){return r.isFalsy(e.get("data_file_name"))?e.get("medium_url")?e.get("medium_url").replace("http://","https://"):e.get("thumbnail_url")?e.get("thumbnail_url").replace("http://","https://"):e.get("source_url")?e.get("source_url").replace("http://","https://"):void 0:t.request("get:photo:file:url","medium",e)},getPhotosCollectionWidgets:function(t,i){var n;return t=t||{},n=new e.PhotosWidgets([],t),i!==!1&&n.goTo(1,{reset:!0,timeout:1e4,error:this.failCallback}),n},failCallback:function(e,t){if("notmodified"!==t.statusText&&"success"!==t.statusText){var i={name:"pixlee:close:widget",type:"action",source:"widget",destination:"parent",data:{}};top.postMessage(JSON.stringify(i),"*")}}},e.Photo=e.Model.extend({url:function(){return t.reqres.request("get:photo:url",this.get("album_photo_id"))},mutators:{pixlee_cdn_photos:{get:function(){return this.attributes.pixlee_cdn_photos},"transient":!0},products:{get:function(){return this.attributes.products},"transient":!0},taggedAtFormatted:{get:function(){return moment(parseInt(this.attributes.tagged_at,10)).format("MM-DD-YYYY")},"transient":!0},captionFormatted:{get:function(){var e;r.isFalsy(this.attributes.title)&&""!==this.attributes.title?r.isFalsy(this.attributes.album_title)?r.isFalsy(this.attributes.photo_title)||(e=this.attributes.photo_title):e=this.attributes.album_title:e=this.attributes.title;var i=t.request("decode:utf8",e);return r.isFalsy(i)?"":i},"transient":!0},notesFormatted:{get:function(){var e;r.isFalsy(this.attributes.notes)&&""!==this.attributes.notes||(e=this.attributes.notes);var i=t.request("decode:utf8",e);return r.isFalsy(i)?"":i},"transient":!0},submitterFormatted:{get:function(){var e,t;return e=r.isFalsy(this.attributes.user_name)?r.isFalsy(this.attributes.email_address)?"":this.attributes.email_address:this.attributes.user_name,r.isFalsy(this.attributes.source)&&(t="desktop"),t=this.attributes.source,"instagram"!==t&&"twitter"!==t||(e="@"+e.replace("@","")),e},"transient":!0},emailFormatted:{get:function(){var e;return e=r.isFalsy(this.attributes.email_address)||r.isFalsy(this.attributes.user_name)||this.attributes.email_address!=this.attributes.user_name?r.isFalsy(this.attributes.email_address)?"":this.attributes.email_address:""},"transient":!0},submitterHref:{get:function(){if(!r.isFalsy(this.get("platform_link")))return this.get("platform_link");if(!r.isFalsy(this.get("submitter_link")))return this.get("submitter_link");switch(this.get("submitter_type")){case"instagram":return"http://instagram.com/"+this.get("submitterFormatted").replace("@","");case"twitter":return"http://twitter.com/"+this.get("submitterFormatted").replace("@","");default:return"javascript: void(0)"}},"transient":!0},src:{get:function(){var e="https://static.pixlee.com";if(null!=this.get("data_file_name"))return e+"/photos/"+this.get("id")+"/xl/"+t.reqres.request("encode:utf8",this.get("data_file_name"));if("image"!=this.get("content_type")&&this.get("content_type")){if("video"==this.get("content_type"))return this.get("thumbnail_url").replace("http://","https://")}else if(null!=this.get("source_url"))return this.get("source_url").replace("http://","https://");return""},"transient":!0},submitter_type:{get:function(){return r.isFalsy(this.attributes.source)?"desktop":this.attributes.source},"transient":!0},isVideo:{get:function(){return"video"==this.get("content_type")}},posterUrl:{get:function(){return this.get("big_url")||this.get("thumbnail_url")},"transient":!0},videoURL:{get:function(){var e=this.get("source_url")||"";return e.replace("http://","https://")},"transient":!0},likeCount:{get:function(){return this.get("like_count")||0},"transient":!0},shareCount:{get:function(){return this.get("share_count")||0},"transient":!0},actionLinkFormatted:{get:function(){return r.isFalsy(this.get("action_link"))?"":t.request("decode:utf8",this.get("action_link"))},"transient":!0},actionLinkTextFormatted:{get:function(){return r.isFalsy(this.get("action_link_text"))?"":t.request("decode:utf8",this.get("action_link_text"))},"transient":!0},actionLinkTitleFormatted:{get:function(){return r.isFalsy(this.get("action_link_title"))?"":t.request("decode:utf8",this.get("action_link_title"))},"transient":!0},actionLinkPhotoFormatted:{get:function(){return r.isFalsy(this.get("action_link_photo"))?"":t.request("decode:utf8",this.get("action_link_photo"))},"transient":!0}},parse:function(e){return r.isFalsy(t.isWidget)&&r.isObject(e.data)?e.data:e},toJSONForLightbox:function(){var e=this.toJSON();return r.each(this.mutators,r.bind(function(t,i){r.isObject(this.mutators[i])===!0&&r.isFunction(this.mutators[i].get)?e[i]=r.bind(this.mutators[i].get,this)():e[i]=r.bind(this.mutators[i],this)()},this)),e}}),e.PhotosWidgets=e.PaginatedCollection.extend({model:e.Photo,server_api:{page:function(){return this.currentPage},filter_id:function(){return t.reqres.request("get:recipe").toJSON().filter_sort_id||gon.publication_id},unique_id:function(){return t.reqres.request("get:recipe")&&t.reqres.request("get:recipe").toJSON().sort&&(t.reqres.request("get:recipe").toJSON().sort.dynamic||t.reqres.request("get:recipe").toJSON().sort.random)?(t.request("murmurhash",this.sessionId,32)+t.request("murmurhash",window.location!=window.parent.location?document.referrer:document.location.href,32))%25:0},per_page:function(){var e=6,i=9,n=9,o=18,r=24,s=30,a=parseInt(t.displayOptions.get("pageSize")),l=parseInt(t.displayOptions.get("pageSizeMobile"))||a,c=parseInt(t.displayOptions.get("pageSizeTablet"))||a,u=0===a;return t.displayOptions.get("is_interactive")&&this.paginator_core.url.indexOf("view_port")!==-1?100:t.MosaicApp?32:t.HorizontalApp||t.CoverflowApp||t.VerticalApp||t.SlideShowApp?gon.isMobile?u?e:l||e:gon.isTablet?u?i:c||i:u?n:a||n:gon.isMobile?u?o:l||o:gon.isTablet?u?r:c||r:u?s:a||s},sortType:function(){return this.sortType}},parse:function(e){return"undefined"!=typeof e.error_code&&1==e.error_code&&(window.location.href="/"),0===e.data.length&&1==this.currentPage&&(this.remaining_count=0),this.next=e.next,e.data},toJSONForLightbox:function(){var e=[];return r.each(this.models,function(t){e.push(t.toJSONForLightbox())},this),e},filterBy:function(e,t){var i;!r.isFalsy(this._currentCriteria)&&r.isFalsy(t)||(this._originalModels=this.models,this._remaining_count=this.remaining_count),e?(i=[],r.each(this._originalModels,function(t){e.indexOf(t.id)!=-1&&i.push(t)}),this._currentCriteria=e,this.remaining_count=i.length):(i=this._originalModels,this.remaining_count=this._remaining_count),this.reset(i),this.trigger("collection:filtered")},interactiveWidgetFilterBy:function(e,t){var i;!r.isFalsy(this._currentCriteria)&&r.isFalsy(t)||(r.isFalsy(this._originalModels)?this._originalModels=this.models:this._originalModels=r.union(this._originalModels,this.models),this._remaining_count=this.remaining_count),e?(i=[],r.each(this._originalModels,function(t){e.indexOf(t.id)!=-1&&i.push(t)}),this._currentCriteria=e,this.remaining_count=i.length):(i=this._originalModels,this.remaining_count=this._remaining_count),this.reset(i),this.trigger("collection:filtered")},filterPhotosWithLocation:function(e,t){var i=this.models.filter(function(e){var i=e.get("latitude"),n=e.get("longitude");if(i&&n){var o=new google.maps.LatLng(i,n);if(t.contains(o))return e}});this.interactiveWidgetFilterBy(r.pluck(i,"id"),e)},resetToOriginal:function(){r.isFalsy(this._originalModels)?this._originalModels=this.models:(this.reset(this._originalModels),this.remaining_count=this._remaining_count)}}),e.PhotosWidgetsMosaic=e.PhotosWidgets.extend({}),t.reqres.setHandlers({"get:photo":function(e){return s.getPhoto(e)},"get:new:photo":function(){return s.newPhoto()},"get:photos:widget:photowall":function(e){return s.getPhotosCollectionWidgets({url:function(){return Routes.distillery_widgets_path()}},e)},"get:photos:widget:mosaic":function(){return s.getPhotosCollectionWidgets({url:function(){return Routes.distillery_widgets_path()},per_page:40})},"get:photo:tumbnail":function(e){return s.getPhotoThumbnailUrl(e)},"get:photo:file:url":function(e,t){return s.getPhotoFileUrl(e,t)}})}),Pixlee.module("Entities",function(e,t,i,n,o,r){var s;e.SlimUser=e.Model.extend({canAccess:function(e){return this.get("features").indexOf(e)!==-1},canUserAccess:function(e){return e=e.toLowerCase(),this.get("user_features").indexOf("master")!==-1||this.get("user_features").indexOf(e)!==-1}}),e.User=e.Model.extend({defaults:{account_type:1,account_name:"Starter Plan",features:["collectPhotos"],email_invoices:!1,shownTutorials:[]},urlRoot:Routes.users_path(),canAccess:function(e){return this.get("features").indexOf(e)!=-1},canUserAccess:function(e){return this.get("user_features").indexOf(e)!==-1},getUserMaxPhotos:function(){switch(this.get("account_type")){case 2:return 25e3;case 1:return 5e3;case 3:return 1e5;case 4:return 1e6;default:return 5e4}},setDisplayBoolean:function(e){o.ajax({url:"users/mark_boolean",data:{the_field:e},type:"post"})},haveExpiredTokens:function(){return!!(this.isFacebookExpired()||this.isInstagramExpired()||this.isTwitterExpired())},isFacebookExpired:function(){return this.get("facebook_status").message.toLowerCase().indexOf("error validating")!=-1},isInstagramExpired:function(){return this.get("instagram_status").message.toLowerCase().indexOf("invalid")!=-1||this.get("instagram_status").message.toLowerCase().indexOf("expire")!=-1},isTwitterExpired:function(){return this.get("twitter_status").message.toLowerCase().indexOf("user has been suspended")!=-1||this.get("twitter_status").message.toLowerCase().indexOf("invalid or expired token")!=-1},isStarter:function(){return 11===this.get("account_type")},isSocialConnected:function(){return!!(this.get("instagram_status").is_connected&&this.get("twitter_status").is_connected&&this.get("facebook_status").is_connected)},shouldShowTutorial:function(e){return this.get("shownTutorials").indexOf(e)==-1},mutators:{shownTutorialsArray:{get:function(){this.attributes.shownTutorials=this.attributes.shownTutorials||"";var e=this.attributes.shownTutorials.split(",");return 1==e.length&&r.isFalsy(e[0])&&(e=[]),e},"transient":!0},shownTutorials:{get:function(){return this.get("shownTutorialsArray").join(",")}}}}),e.SpamUser=e.Model.extend({url:function(){return Routes.remove_marked_as_spam_users_path(this.get("id"))}}),e.SpamUsers=e.Collection.extend({url:function(){return Routes.get_marked_as_spam_users_path()},model:e.SpamUser,parse:function(e){return e.users}}),e.AccountUsers=e.Collection.extend({url:function(){return Routes.get_account_users_path()},model:e.SlimUser}),s={newUser:function(t){return t=t||{},new e.User(t)},setCurrentUser:function(t){var i=new e.User(t);return i},setDisplayBoolean:function(e,t){e.setDisplayBoolean(t),e.get("shownTutorialsArray").push(t)},getMarkedAsSpamUsers:function(t){var i=new e.SpamUsers(t);return i.fetch(),i},getAccountUsers:function(t){var i=new e.AccountUsers(t);return i.fetch(),i}},t.reqres.setHandlers({"get:new:user":function(e){return s.newUser(e)},"set:current:user":function(e){return s.setCurrentUser(e)},"get:spam:users":function(e){return s.getMarkedAsSpamUsers(e)},"get:account:users":function(e){return s.getAccountUsers(e)}}),t.commands.setHandlers({"user:set:analytics:tutorial:seen":function(e){return s.setDisplayBoolean(e,"analytics_v3_tutorial")}}),t.commands.setHandlers({"user:set:tutorial:seen":function(e,t){return s.setDisplayBoolean(e,t)},"remove:spammer":function(){}})}),Pixlee.module("Entities",function(e,t,i,n,o,r){var s;e.Config=e.Model.extend({mutators:{isAdmin:function(){return!r.isFalsy(this.get("adminSu"))}}}),s={getConfig:function(t){return t=t||{},new e.Config({distilleryUrl:gon.global.distilleryUrl,emailServerUrl:gon.global.emailServerUrl,distilleryAnalyticsUrl:gon.global.distilleryAnalyticsUrl,distilleryUrlMyAlbums:gon.global.distilleryUrlMyAlbums,distilleryUrlCountMyAlbums:gon.global.distilleryUrlCountMyAlbums,distilleryUrlAnalyticsAlbums:gon.global.distilleryUrlAnalyticsAlbums,distilleryUrlAnalyticsAccounts:gon.global.distilleryUrlAnalyticsAccounts,distilleryInboxUrl:gon.global.distilleryInboxUrl,distilleryInboxCountUrl:gon.global.distilleryInboxCountUrl,pixleePhotosServer:gon.global.pixleePhotosServer,photoAssetsUrl:gon.global.photoAssetsUrl,
distilleryPhotoUrl:gon.global.distilleryPhotoUrl,distilleryPhotoCrudUrl:gon.global.distilleryPhotoCrudUrl,s3_bucket_url:gon.global.s3BucketUrl,environment:gon.global.env,adminSu:t.adminSu,adminUnsu:t.adminUnsu,pixleeAdminPanelUrl:t.pixleeAdminPanelUrl,productSimilarityUrl:gon.global.productSimilarityUrl})},getConfigPhotosApp:function(){return new e.Config({distilleryUrl:gon.global.distilleryUrl,distilleryAnalyticsUrl:gon.global.distilleryAnalyticsUrl,distilleryQueryUrl:gon.global.distilleryQueryUrl,pixlee_backend_server:gon.global.pixleeBackendServer,environment:gon.global.env,s3_bucket_url:gon.global.s3BucketUrl,distilleryPhotoUrl:gon.global.distilleryPhotoUrl})}},t.reqres.setHandler("set:config",function(e){return s.getConfig(e)}),t.reqres.setHandler("set:config:photos:app",function(){return s.getConfigPhotosApp()})}),Pixlee.module("Entities",function(e,t){var i;i={setDisplayOptions:function(t){return new e.DisplayOptions(t)}},e.DisplayOptions=e.DeepModel.extend(),t.reqres.setHandler("set:display:options",function(e){return i.setDisplayOptions(e)})}),Pixlee.module("Entities",function(e,t){var i;i={setRecipe:function(t){return new e.Recipe(t)}},e.Recipe=e.Model.extend(),t.reqres.setHandler("set:recipe",function(e){return i.setRecipe(e)})}),Pixlee.module("PhotowallApp",function(e){e.on("start",function(t){new e.Show.Controller(t)})}),Pixlee.module("PhotowallApp.Show",function(e,t,i,n,o,r){e.Controller=t.Controllers.Application.extend({initialize:function(e){var i,n,o=t.request("get:photos:widget:photowall"),s=this.getLayout({collection:o}),a=this;if(this.listenTo(s,"show",function(){i=this.getCollectionView({collection:o,displayOptions:e.display_options}),o.on("sync",function(e,i){return!a.widgetloaded&&(a.widgetloaded=!0,gon.sortType=i.sortType,void t.commands.execute("opened:photowall",e.pluck("album_photo_id")))});r.isFalsy(e.display_options.headerOptions)?"":e.display_options.headerOptions.layout;if(n=this.getHeaderView({model:t.request("get:current:album")}),this.show(n,{region:s.widget_header_region}),this.show(i,{region:s.frame}),!r.isFalsy(e.display_options.is_interactive)){var l=this.getNavbarView(e,o);this.show(l,{region:s.interactive_region})}}),!r.isFalsy(gon.previewMode)){var l,c="30";t.commands.setHandler("stylesheet:generated",function(u,d,h){if(c=c||h.pageSize,l=l||d.header_sponserImage_input,!r.isFalsy(d.header_sponserImage_input)){l=d.header_sponserImage_input,t.displayOptions.set("header_sponserImage_input",l);r.isFalsy(e.display_options.headerOptions)?"":e.display_options.headerOptions.layout;n=a.getHeaderView({model:t.request("get:current:album")}),a.show(n,{region:s.widget_header_region})}c!=h.pageSize&&(c=h.pageSize,t.displayOptions.set("pageSize",c),o.fetch({reset:!0})),i.triggerMethod("stylesheet:generated")})}this.show(s,{loading:!0})},getLayout:function(t){return new e.Layout(t)},getCollectionView:function(t){return new e.PhotowallCollection(t)},getHeaderView:function(t){return new e.HeaderView(t)},getNavbarView:function(e,i){return t.request("get:navbar:view",e,i)}})}),Pixlee.module("PhotowallApp.Show",function(e,t,i,n,o,r){e.Layout=t.Views.Layout.extend({template:"backbone/apps/photowall/show/templates/layout",regions:{widget_header_region:"#widget_header_region",interactive_region:"#interactive_region",frame:".photowall_frame"},collectionEvents:{sync:function(){this.collection.next?this.$el.find(".load_more").show():this.$el.find(".load_more").hide()}},events:{"click .load_more":function(){if(this.collection.next){this.$el.find(".load_more").addClass("loading");var e=this;this.collection.nextPage({success:function(){e.$el.find(".load_more").removeClass("loading"),t.commands.execute("load:more",e.collection.pluck("album_photo_id")),e.collection.next||e.$el.find(".load_more").hide();var i={name:"pixlee:widget:load:more",type:"action",source:"widget",destination:"parent",data:o("#widget").height()};window.parent.postMessage(JSON.stringify(i),"*")}})}}},initialize:function(){this.displayOptions=t.request("get:display:options")},onRender:function(){r.isFalsy(t.request("get:display:options").get("infiniteLoadMore"))||(this.$el.find(".load_more").remove(),this.waitForLoadMoreRequest())},infiniteLoadMore:function(){if(this.collection.next){this.$el.find("#photowall_control").append("<div class='load_more loading'></div");var e=this;this.collection.nextPage({success:function(){e.$el.find(".load_more").remove(),e.is_loading=!1,t.commands.execute("load:more",e.collection.pluck("album_photo_id"))}})}},waitForLoadMoreRequest:function(){var e=this,t=r.throttle(function(t){try{var i=JSON.parse(t.data);"pixlee:infinite:load:more"!==i.name||e.is_loading||(e.infiniteLoadMore(),e.is_loading=!0)}catch(e){return}},1e3);window.addEventListener("message",t,!1)}}),e.Layout.include(["LayoutHelpers"]),e.PhotoView=t.Views.ItemView.extend({template:"backbone/apps/common/templates/v2/_photo_item",className:"photo_block",tagName:"li",behaviors:function(){return{Reviews:{},Share:{},Vote:{},Lightbox:{}}},modelEvents:{voted:function(){this.$el.find(".vote_button").addClass("active")}},initialize:function(){this.model.get("is_starred")&&this.$el.addClass("starred")},templateHelpers:{decodeUtf8:function(e){return t.request("decode:utf8",e)}}}),e.PhotoView.include(["PhotoViewHelpers","ReviewHelpers"]),e.PhotowallCollection=t.Views.CompositeView.extend({template:"backbone/apps/photowall/show/templates/_collection_view",childView:e.PhotoView,childViewContainer:"#item_container",behaviors:function(){var e={CollectionVote:{}};r.isFalsy(this.options.displayOptions.headerOptions)||(e.AppendUploaderTiles={},"tile"===this.options.displayOptions.headerOptions.layout&&(e.Upload={}));var i=r.isFalsy(this.options.displayOptions.headerOptions.end_tile_upload_button_background_showHide),n=!r.isFalsy(t.displayOptions.get("hideIfLessThan"))||!r.isFalsy(gon.current_account.extra_fields.hideIfLessThan);return(i||n)&&(e.HideEmptyAlbumWidget={}),e},initialize:function(){this.collection.reviewSelectionOptions={currentModelIndex:0}},onShow:function(){var e=this;o(window).resize(function(){e.resizeHeader()}),o("#widget").attr("alt",t.altText)},onStylesheetGenerated:function(){this.resizeHeader()},onRender:function(){this.collection.length>0&&this.resizeHeader()},resizeHeader:function(){var e=o(".photo_block").outerWidth(!0),t=o(".photo_block").outerWidth(),i=o(".photowall_frame").outerWidth(!0),n=Math.floor(i/e),r=e-t;o("#widget_header").width(e*n-r),o("#interactive_section").width(e*n-r)}}),e.PhotowallCollection.include(["tabindexHelpers","headerHelpers"]),e.HeaderView=t.Views.ItemView.extend({template:"backbone/apps/common/templates/v2/_header",id:"widget_header",behaviors:{Upload:{},ShowPdpCaption:{}}}),e.HeaderView.include(["StandaloneHeaderHelpers"])}),function(){window.JST=window.JST||{},window.JST["backbone/apps/common/templates/v2/_end_uploader_tile"]=_.template('[%if(obj === \'mosaic_v2\'){%]\n\t<li class="photo_block uploader_tile large fade_in" >\n[%} else {%]\n\t<li class="photo_block uploader_tile" >\n[%}%]\n\t<div id="end_uploader_tile_inside"> </div>\n</li>'),window.JST["backbone/apps/common/templates/v2/_header"]=_.template('[% if (isStandalone()) { %]\n<div id="standalone_header">\n\t<div id="header_nav">\n\t\t[% if (shouldShowLogoImage()) { %]\n\t\t\t<a href="[%= getLogoRedirectURL() %]" id="brand_logo" target="_blank" style="[%=getLogoImage()%]"></a>\n\t\t[% } %]\n\t\t<div id="social_profiles_container">\n\t\t\t<a href="[%= getInstagramURL() %]" class="social_profile_icons" id="instagram_profile" target="_blank"></a>\n\t\t\t<a href="[%= getTwitterURL() %]" class="social_profile_icons" id="twitter_profile" target="_blank"></a>\n\t\t\t<a href="[%= getPinterestURL() %]" class="social_profile_icons" id="pinterest_profile" target="_blank"></a>\n\t\t\t<a href="[%= getFacebookURL() %]" class="social_profile_icons" id="facebook_profile" target="_blank"></a>\n\t\t</div>\n\t</div>\n\t[% if (shouldShowBannerImage()) { %]\n\t\t<div id="banner_image" style="[%= getBannerImage()%]">\n\t\t\t<img src="[%= getBannerImageURL()%]">\n\t\t\t<a id="banner_image_link" href="[%= getBannerRedirectURL() %]" target="_blank"></a>\n\t\t</div>\n\t[% } %]\n</div>\n[% } %]\n\n\n[% if(isHeaderV2()) {%]\n\t<!-- button classes: uploader_button, uploader_text_w_icon, uploader_text_inline -->\n\t<!-- header classes: justified, centered, side, tile, vertical_left_aligned -->\n\t[% if (!isStandalone()) { %]\n\t<div id="header_banner_image">\n\t\t<img src="[%=  getHeaderBannerImage() %]">\n\t</div>\n\t[% } %]\n\t[%if(!isTile()){%]\n\t\t<div id="header_wrapper" class="[%=getWidgetType()%] [%=getLayoutClass()%] [%=getButtonClass()%] ">\n\t\t\t\t<ul id="hashtag_holder">\n\t\t\t\t\t[%if(!_.isFalsy(getHeaderTitle())){%]\n\t\t\t\t\t\t<li>[%=decode_utf8(getHeaderTitle())%]</li>\n\t\t\t\t\t[%}%]\n\t\t\t\t</ul>\n\t\t\t\t<div id="description_holder">[%=decode_utf8(getHeaderDescription())%]</div>\n\t\t\t\t<div id="upload_now" tabindex="0"></div>\n\t\t\t\t[%if (isViewGallery()) {%]\n\t\t\t\t<a href="[%=getViewGalleryUrl()%]" target="_blank" id="view_gallery">\n\t\t\t\t\t[%=decode_utf8(getViewGalleryText())%]\n\t\t\t\t</a>\n\t\t\t\t[%}%]\n\t\t</div>\n\t[%}%]\n[%} else { %]\n\t<div id="common_header">\n\t\t<ul id="hashtag_holder">[% _.each(gon.collect_string,function(element, index, list){ %]\n\t\t\t<li>[%= element %]</li>\n\t\t\t[% }) %]</ul>\n\t\t<div id="description_holder">[% if (typeof isPdpCaption == \'function\') { %][% if (isPdpCaption()) { %][%= getPdpCaption()%][%}%][%}%][% if (!_.isFalsy(description)) {%][%- Pixlee.request("decode:utf8",description) %][%}%]</div>\n\t\t<div id="upload_now" tabindex="0"></div>\n\t\t[%if (isViewGallery()) {%]\n\t\t<a href="[%=getViewGalleryUrl()%]" target="_blank" id="view_gallery">\n\t\t\t[%=decode_utf8(getViewGalleryText())%]\n\t\t</a>\n\t\t[%}%]\n\t</div>\n[%}%] \n'),window.JST["backbone/apps/common/templates/v2/_photo_item"]=_.template('<div class="img_holder" style="background-image:url(\'[%= thumbnail(\'medium\') %]\')" tabindex="0">\n  <img alt="[%= decodeUtf8(altText()) %]" src="[%= thumbnail(\'medium\') %]" data-prod-image="[%=getReview().productImage%]" style="position: fixed; left: -100000px;"/>\n</div>\n[% if (isVideo()) {%]\n\t<a class="layer_video lightboxed" id="[%= album_photo_id %]" rel=\'album\' href="[%= thumbnail(\'medium\') %]">\n\t    [%= decodeUtf8(altText()) %]\n\t\t<div class="play_button"></div>\n\t</a>\n[%}%]\n[% if (Pixlee.request("get:current:album").get("campaign")) {%]\n\t<div class="vote_button [% if (userVotedSet()) {%] active [%}%]"><div class="vote_count">[%= like_count %]</div></div>\n[%}%]\n\n[% if (gon.display_options.reviewOptions && gon.display_options.reviewOptions.displayReviews){%]\n<div class="text_review_holder" data-review-id="[%=getReview().id%]">\n\t<div class="text_review_content">\n\t\t<div class="star_holder star_[%= getReview().score %]"> [%= getReview().score %] Star Rating</div>\n\t\t<div class="text_review">\n\t\t\t[%= getReview().content %] \n\t\t</div>\n\t</div>\n\t<div class="reviewer_name">[%= getReview().user_name %]</div>\n</div>\n[%}%]\n\n<div class="info_holder">\n\t<svg viewBox="0 -5 240 51" preserveAspectRatio="none">\n\t\t<path d="M120,0c82.1,0,100.6,39.2,120,39.2c0,0.7,0,3.6,0,6.7c-23.6,0-194.8,0-240,0\n      c0-2.7,0-4.1,0-6.7C14,39.2,37.9,0,120,0z"/>\n\t</svg>\n\t<div class="social_holder" style="bottom: 0px;">\n\t\t<div class="pixlee_fshare social_button"></div>\n\t\t<div class="pixlee_tweet social_button"></div>\n\t\t<div class="pixlee_pinit social_button"></div>\n\t\t<div class="pixlee_tumblr social_button"></div>\n\t</div>\n\t<div class="info_content">\n\t\t<div class="users_handle">[%= submitterAnchor(true) %]</div>\n        [%= uploaderAdditionalFields()%]\n\t\t<div class="like_count">[%= native_likes %]</div>\n\t\t<div class="users_caption">[% if (getTitle() != ""){%][%-  decodeUtf8(getTitle()) %] [% }%]</div>\n\t\t<div class="users_date">[%=  getDate() %]</div>\n\t</div>\n\t<div class="user_avatar" style="background-image:url([%= avatar_url %])"></div>\n</div>\n<div class="content_source [%= submitterType() %]"></div>\n[% if (!_.isFalsy(gon.display_options.customCallToActionLink)) { %]\n<a href="[%= decodeURIComponent(gon.display_options.customCallToActionLink) %]" target="_top" class="custom_call_to_action_anchor" style="font-size:0px">call to action link</a>\n[% } %]'),window.JST["backbone/apps/common/templates/v2/_tap2shop_photo_item"]=_.template('[% if (!_.isFalsy(gon.display_options.customCallToActionLink) && gon.isMobile) { %]\n<a href="[%= decodeURIComponent(gon.display_options.customCallToActionLink) %]" target="[%=ctaTarget()%]" class="custom_call_to_action_anchor">\n[% } else { %]\n<a target="[%=ctaTarget()%]" class="custom_call_to_action_anchor">\n[% } %]\n\t<div class="img_holder" style="background-image:url([%= thumbnail(tap2shop_thumbnail_size) %])"><img alt="[%= decodeUtf8(altText()) %]" style="display:none" data-prod-image="[%=getReview().productImage%]"/></div>\n\t[% if (isVideo()) {%]\n\t\t<a class="layer_video lightboxed" id="[%= album_photo_id %]" rel=\'album\'>\n\t\t\t<div class="play_button"></div>\n\t\t</a>\n\t[%}%]\n\t[% if (gon.display_options.reviewOptions && gon.display_options.reviewOptions.displayReviews){%]\n\t<div class="text_review_holder" data-review-id="[%=getReview().id%]">\n\t\t<div class="text_review_content">\n\t\t\t<div class="star_holder star_[%= getReview().score %]"> [%= getReview().score %] Star Rating</div>\n\t\t\t<div class="text_review">\n\t\t\t\t[%= getReview().content %] \n\t\t\t</div>\n\t\t</div>\n\t\t<div class="reviewer_name">[%= getReview().user_name %]</div>\n\t</div>\n\t[%}%]\n</a>'),window.JST["backbone/apps/common/templates/v2/_uploader_tile"]=_.template('<div id="header_wrapper" >\n\t[%if(showTitle()){%]\n\t\t<div id="hashtag_holder">[%=getHeaderTitle()%]</div>\n\t[%}%]\n\t[%if(showDescription()){%]\n\t\t<div id="description_holder">[%=getHeaderDescription()%]</div>\n\t[%}%]\n\t\t<div id="upload_now" tabindex="0"></div> \n</div>'),window.JST["backbone/apps/common/templates/v2/_xl_photo_item"]=_.template('<div class="img_holder" style="background-image:url(\'[%= thumbnail(\'xl\') %]\')" tabindex="0">\n   <img alt="[%= decodeUtf8(altText()) %]" src="[%= thumbnail(\'xl\') %]" data-prod-image="[%=getReview().productImage%]" style="position: fixed; left: -100000px;"/>\n</div>\n[% if (isVideo()) {%]\n    <a class="layer_video lightboxed" id="[%= album_photo_id %]" rel=\'album\' href="[%= thumbnail(\'xl\') %]">\n        [%= decodeUtf8(altText()) %]\n        <div class="play_button"></div>\n    </a>\n[%}%]\n[% if (Pixlee.request("get:current:album").get("campaign")) {%]\n    <div class="vote_button [% if (userVotedSet()) {%] active [%}%]"><div class="vote_count">[%= like_count %]</div></div>\n[%}%]\n\n[% if (gon.display_options.reviewOptions && gon.display_options.reviewOptions.displayReviews){%]\n<div class="text_review_holder" data-review-id="[%=getReview().id%]">\n    <div class="product_name">[%= decodeUtf8(getReview().productName) %]</div>\n    <div class="text_review_content">\n        <div class="star_holder star_[%= getReview().score %]"> [%= getReview().score %] Star Rating</div>\n        <div class="text_review">\n            [%= getReview().content %] \n        </div>\n    </div>\n    <div class="reviewer_name">[%= getReview().user_name %]</div>\n</div>\n[%}%]\n\n<div class="info_holder">\n    <svg viewBox="0 -5 240 51" preserveAspectRatio="none">\n        <path d="M120,0c82.1,0,100.6,39.2,120,39.2c0,0.7,0,3.6,0,6.7c-23.6,0-194.8,0-240,0\n      c0-2.7,0-4.1,0-6.7C14,39.2,37.9,0,120,0z"/>\n    </svg>\n    <div class="social_holder" style="bottom: 0px;">\n        <div class="pixlee_fshare social_button"></div>\n        <div class="pixlee_tweet social_button"></div>\n        <div class="pixlee_pinit social_button"></div>\n        <div class="pixlee_tumblr social_button"></div>\n    </div>\n    <div class="info_content">\n        <div class="users_handle">[%= submitterAnchor(true) %]</div>\n        [%= uploaderAdditionalFields()%]\n        <div class="like_count">[%= native_likes %]</div>\n        <div class="users_caption">[% if (getTitle() != ""){%][%-  decodeUtf8(getTitle()) %] [% }%]</div>\n        <div class="users_date">[%=  getDate() %]</div>\n    </div>\n    <div class="user_avatar" style="background-image:url([%= avatar_url %])"></div>\n</div>\n<div class="content_source [%= submitterType() %]"></div>\n[% if (!_.isFalsy(gon.display_options.customCallToActionLink)) { %]\n<a href="[%= decodeURIComponent(gon.display_options.customCallToActionLink) %]" target="_top" class="custom_call_to_action_anchor" style="font-size:0px">call to action link</a>\n[% } %]\n'),window.JST["backbone/apps/photowall/show/templates/_collection_view"]=_.template('<ul id="item_container" class="clearfix">\n\t[%if(getLayoutClass() === \'tile\'){%]\n\t<li id="header_tile_container" class="photo_block" >\n\t\t<div id="header_wrapper" class="[%=getLayoutClass()%] [%=getButtonClass()%] ">\n\t\t\t[%if(showTitle()){%]\n\t\t\t<ul id="hashtag_holder"><li>[%=decode_utf8(getHeaderTitle())%]</li></ul>\n\t\t\t[%}%]\n\t\t\t[%if(showDescription()){%]\n\t\t\t<div id="description_holder">[%=decode_utf8(getHeaderDescription())%]</div>\n\t\t\t[%}%]\n\t\t\t<div id="upload_now" tabindex="0"></div>\n\t\t\t[%if (isViewGallery()) {%]\n\t\t\t<a href="[%=getViewGalleryUrl()%]" target="_blank" id="view_gallery">[%=decode_utf8(getViewGalleryText())%]</a>\n\t\t\t[%}%]\n\t\t</div>\n\t</li>\n\t[%}%]\n</ul>'),window.JST["backbone/apps/photowall/show/templates/layout"]=_.template('<div id="widget_header_region"></div>\n<div id="interactive_region"></div>\n<div id="photowall_widget" class="wrap">\n\t<div class="photowall_frame">\n\t</div>\n\t<div id="photowall_control" class="controls">\n\t\t<div class="load_more"></div>\n\t</div>\n</div>\t\n'),window.JST["base/backbone/lib/components/loading/templates/_loader"]=_.template('<div id="loader"></div>'),window.JST["base/backbone/lib/components/loading/templates/loader"]=_.template("<div id=\"loader\" style='position:relative !important;left:-25px !important;'></div>")}();